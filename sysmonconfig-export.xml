<!--
  A Sysmon configuration file
  Author: 		Jakawal Ongthongkum
  Version:		1.3
  Created:		2021-08-09
  Updated: 		2022-11-04
  Required:		Sysmon version 14.1 or higher (due to new event id and changes in syntax)
-->

<Sysmon schemaversion="4.83">
	<!-- SYSMON META CONFIG -->
	<HashAlgorithms>md5,sha256,IMPHASH</HashAlgorithms>
	<!-- Both MD5 and SHA256 are the industry-standard algorithms -->
	<CheckRevocation>False</CheckRevocation> 
	<!-- Check loaded drivers, log if their code-signing certificate has been revoked, in case malware stole one to sign a kernel driver -->
	<!-- Setting this to true might impact performance -->
	<DnsLookup>False</DnsLookup>
  	<!-- Disables lookup behavior, default is True (Boolean) -->
	<ArchiveDirectory>Sysmon</ArchiveDirectory>
	<!-- Name of directories at volume roots into which copy-on-delete files are moved. The directory is protected with a System ACL --> 
	<!-- You can use PsExec from Sysinternals to access the directory using psexec -sid cmd). Default: Sysmon -->

	<EventFiltering>

	<!--SYSMON EVENT ID 1 : PROCESS CREATION [ProcessCreate]-->
	<!--DATA: UtcTime, ProcessGuid, ProcessID, Image, FileVersion, Description, Product, Company, CommandLine, CurrentDirectory, User, LogonGuid, LogonId, TerminalSessionId, IntegrityLevel, Hashes, ParentProcessGuid, ParentProcessId, ParentImage, ParentCommandLine, RuleName-->
	<!--No Includes-->
	<RuleGroup name="ProcessCreate_Exclude_Group" groupRelation="or">
		<ProcessCreate onmatch="exclude">
			<!--Microsoft Windows-->
			<CommandLine condition="begin with"> "C:\Windows\system32\wermgr.exe" "-queuereporting_svc" </CommandLine> <!--Windows:Windows error reporting/telemetry-->
			<CommandLine condition="begin with">C:\Windows\system32\DllHost.exe /Processid</CommandLine> <!--Windows-->
			<CommandLine condition="begin with">C:\Windows\system32\wbem\wmiprvse.exe -Embedding</CommandLine> <!--Windows: WMI provider host-->
			<CommandLine condition="begin with">C:\Windows\system32\wbem\wmiprvse.exe -secured -Embedding</CommandLine> <!--Windows: WMI provider host-->
			<CommandLine condition="is">C:\Windows\system32\wermgr.exe -upload</CommandLine> <!--Windows:Windows error reporting/telemetry-->
			<CommandLine condition="is">C:\Windows\system32\SearchIndexer.exe /Embedding</CommandLine> <!--Windows: Search Indexer-->
			<CommandLine condition="is">C:\windows\system32\wermgr.exe -queuereporting</CommandLine> <!--Windows:Windows error reporting/telemetry-->
			<CommandLine condition="is">\??\C:\Windows\system32\autochk.exe *</CommandLine> <!--Microsoft:Bootup: Auto Check Utility-->
			<CommandLine condition="is">\SystemRoot\System32\smss.exe</CommandLine> <!--Microsoft:Bootup: Windows Session Manager-->
			<CommandLine condition="is">C:\Windows\System32\RuntimeBroker.exe -Embedding</CommandLine> <!--Windows:Apps permissions [ https://fossbytes.com/runtime-broker-process-windows-10/ ] -->
			<Image condition="is">C:\Program Files (x86)\Common Files\microsoft shared\ink\TabTip32.exe</Image> <!--Windows: Touch Keyboard and Handwriting Panel Helper-->
			<Image condition="is">C:\Windows\System32\TokenBrokerCookies.exe</Image> <!--Windows: SSO sign-in assistant for MicrosoftOnline.com-->
			<Image condition="is">C:\Windows\System32\plasrv.exe</Image> <!--Windows: Performance Logs and Alerts DCOM Server-->
			<Image condition="is">C:\Windows\System32\wifitask.exe</Image> <!--Windows: Wireless Background Task-->
			<Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image> <!--Windows: Customer Experience Improvement-->
			<Image condition="is">C:\Windows\system32\PrintIsolationHost.exe</Image> <!--Windows: Printing-->
			<Image condition="is">C:\Windows\system32\SppExtComObj.Exe</Image> <!--Windows: KMS activation-->
			<Image condition="is">C:\Windows\system32\audiodg.exe</Image> <!--Windows: Launched constantly-->
			<Image condition="is">C:\Windows\system32\conhost.exe</Image> <!--Windows: Command line interface host process-->
			<Image condition="is">C:\Windows\system32\mobsync.exe</Image> <!--Windows: Network file syncing-->
			<Image condition="is">C:\Windows\system32\musNotification.exe</Image> <!--Windows: Update pop-ups-->
			<Image condition="is">C:\Windows\system32\musNotificationUx.exe</Image> <!--Windows: Update pop-ups-->
			<Image condition="is">C:\Windows\system32\powercfg.exe</Image> <!--Microsoft:Power configuration management-->
			<Image condition="is">C:\Windows\system32\sndVol.exe</Image> <!--Windows: Volume control-->
			<Image condition="is">C:\Windows\System32\wermgr.exe</Image>
			<Image condition="is">C:\Windows\SysWOW64\wermgr.exe</Image>
			<Image condition="is">C:\Windows\system32\sppsvc.exe</Image> <!--Windows: Software Protection Service-->
			<Image condition="is">C:\Windows\system32\wbem\WmiApSrv.exe</Image> <!--Windows: WMI performance adapter host process-->
			<IntegrityLevel condition="is">AppContainer</IntegrityLevel> <!--Windows: Don't care about sandboxed processes right now. Will need to revisit this decision.-->
			<ParentCommandLine condition="begin with">%%SystemRoot%%\system32\csrss.exe ObjectDirectory=\Windows</ParentCommandLine> <!--Windows:CommandShell: Triggered when programs use the command shell, but doesn't provide attribution for what caused it-->
			<ParentCommandLine condition="is">C:\windows\system32\wermgr.exe -queuereporting</ParentCommandLine> <!--Windows:Windows error reporting/telemetry-->
			<CommandLine condition="is">C:\WINDOWS\system32\devicecensus.exe UserCxt</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\usocoreworker.exe -Embedding</CommandLine>
			<ParentImage condition="is">C:\Windows\system32\SearchIndexer.exe</ParentImage> <!--Windows:Search: Launches many uninteresting sub-processes-->
			<!--Windows:svchost-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -s StateRepository</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -p -s camsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel</CommandLine> <!--Windows 10-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k appmodel -p -s tiledatamodelsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k camera -s FrameServer</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s LSM</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k dcomlaunch -s PlugPlay</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k defragsvc</CommandLine> <!--Windows defragmentation-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k devicesflow -s DevicesFlowUserSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k imgsvc</CommandLine> <!--Microsoft:The Windows Image Acquisition Service-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s EventSystem</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s bthserv</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k LocalService -p -s BthAvctpSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s nsi</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localService -s w32Time</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s Dhcp</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s EventLog</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s TimeBrokerSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -s WFDSConMgrSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k LocalServiceNetworkRestricted -s BTAGService</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s NcbService</CommandLine> <!--Win10:1903:Network Connection Broker-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SensrSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -p -s SSDPSRV</CommandLine> <!--Windows:SSDP [ https://en.wikipedia.org/wiki/Simple_Service_Discovery_Protocol ] -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNoNetwork</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s WPDBusEnum</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s fhsvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s DeviceAssociationService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s NcbService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s SensorService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s TabletInputService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s UmRdpService</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WPDBusEnum</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -p -s NgcSvc</CommandLine> <!--Microsoft:Passport--> 
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceNetworkRestricted -p -s NgcCtnrSvc</CommandLine> <!--Microsoft:Passport Container--> 
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localServiceAndNoImpersonation -s SCardSvr</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted -s WdiSystemHost</CommandLine> <!--Windows: Diagnostic System Host [ http://www.blackviper.com/windows-services/diagnostic-system-host/ ] -->
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k localSystemNetworkRestricted -p -s WdiSystemHost</CommandLine> <!--Windows: Diagnostic System Host [ http://www.blackviper.com/windows-services/diagnostic-system-host/ ] -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</CommandLine> <!--Windows-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s wuauserv</CommandLine>
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k netsvcs -p -s SessionEnv</CommandLine> <!--Windows:Remote desktop configuration-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s wlidsvc</CommandLine> <!--Windows: Windows Live Sign-In Assistant [ https://www.howtogeek.com/howto/30348/what-are-wlidsvc.exe-and-wlidsvcm.exe-and-why-are-they-running/ ] -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s ncaSvc</CommandLine> <!--Windows: Network Connectivity Assistant [ http://www.blackviper.com/windows-services/network-connectivity-assistant/ ] -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BDESVC</CommandLine> <!--Windows:Network: BitLocker Drive Encryption-->
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k netsvcs -p -s BDESVC</CommandLine> <!--Microsoft:Win10:1903:Network: BitLocker Drive Encryption-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s BITS</CommandLine> <!--Windows:Network: Background Intelligent File Transfer (BITS) -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s BITS</CommandLine> <!--Windows:Network: Background Intelligent File Transfer (BITS) -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s CertPropSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s DsmSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -p -s Appinfo</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Gpsvc</CommandLine> <!--Windows:Network: Group Policy -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s ProfSvc</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SENS</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s SessionEnv</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Themes</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs -s Winmgmt</CommandLine> <!--Windows: Windows Management Instrumentation (WMI) -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -p -s DoSvc</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s Dnscache</CommandLine> <!--Windows:Network: DNS caching, other uses -->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s LanmanWorkstation</CommandLine> <!--Windows:Network: "Workstation" service, used for SMB file-sharing connections and RDP-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s NlaSvc</CommandLine> <!--Windows:Network: Network Location Awareness-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService -s TermService</CommandLine> <!--Windows:Network: Terminal Services (RDP)-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkService</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k networkServiceNetworkRestricted</CommandLine> <!--Windows: Network services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k rPCSS</CommandLine> <!--Windows Services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k secsvcs</CommandLine>
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k swprv</CommandLine> <!--Microsoft:Software Shadow Copy Provider-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k unistackSvcGroup</CommandLine> <!--Windows 10-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k utcsvc</CommandLine> <!--Windows Services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wbioSvcGroup</CommandLine> <!--Windows Services-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k werSvcGroup</CommandLine> <!--Windows: ErrorReporting-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wusvcs -p -s WaaSMedicSvc</CommandLine> <!--Windows: Update Medic Service [ https://www.thewindowsclub.com/windows-update-medic-service ] -->
			<CommandLine condition="is">C:\Windows\System32\svchost.exe -k wsappx -p -s ClipSVC</CommandLine> <!--Windows:Apps: Client License Service-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -p -s AppXSvc</CommandLine> <!--Windows:Apps: AppX Deployment Service-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx -s ClipSVC</CommandLine> <!--Windows:Apps: Client License Service-->
			<CommandLine condition="is">C:\Windows\system32\svchost.exe -k wsappx</CommandLine> <!--Windows:Apps [ https://www.howtogeek.com/320261/what-is-wsappx-and-why-is-it-running-on-my-pc/ ] -->
			<ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k netsvcs</ParentCommandLine> <!--Windows: Network services: Spawns Consent.exe-->
			<ParentCommandLine condition="is">C:\Windows\system32\svchost.exe -k localSystemNetworkRestricted</ParentCommandLine> <!--Windows-->
			<CommandLine condition="is">C:\Windows\system32\deviceenroller.exe /c /AutoEnrollMDM</CommandLine> <!--Windows: AzureAD device enrollment agent-->
			<!--Microsoft:Edge-->
			<CommandLine condition="begin with">"C:\Program Files (x86)\Microsoft\Edge Dev\Application\msedge.exe" --type=</CommandLine>
			<!--Microsoft:dotNet-->
			<CommandLine condition="begin with">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngen.exe</CommandLine> <!--Microsoft:DotNet-->
			<CommandLine condition="begin with">C:\WINDOWS\Microsoft.NET\Framework64\v4.0.30319\Ngen.exe</CommandLine> <!--Microsoft:DotNet-->
			<Image condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</Image> <!--Microsoft:DotNet-->
			<Image condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</Image> <!--Microsoft:DotNet-->
			<Image condition="is">C:\Windows\Microsoft.Net\Framework64\v3.0\WPF\PresentationFontCache.exe</Image> <!--Windows: Font cache service-->
			<ParentCommandLine condition="contains">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentCommandLine>
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscorsvw.exe</ParentImage> <!--Microsoft:DotNet-->
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ngentask.exe</ParentImage> <!--Microsoft:DotNet-->
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorsvw.exe</ParentImage> <!--Microsoft:DotNet-->
			<ParentImage condition="is">C:\Windows\Microsoft.NET\Framework\v4.0.30319\ngentask.exe</ParentImage> <!--Microsoft:DotNet: Spawns thousands of ngen.exe processes-->
			<!--Microsoft:Office-->
			<Image condition="is">C:\Program Files\Microsoft Office\Office16\MSOSYNC.EXE</Image> <!--Microsoft:Office: Background process for SharePoint/Office365 connectivity-->
			<Image condition="is">C:\Program Files (x86)\Microsoft Office\Office16\MSOSYNC.EXE</Image> <!--Microsoft:Office: Background process for SharePoint/Office365 connectivity-->
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\OfficeSoftwareProtectionPlatform\OSPPSVC.EXE</Image> <!--Microsoft:Office: Licensing service-->
			<Image condition="is">C:\Program Files\Microsoft Office\Office16\msoia.exe</Image> <!--Microsoft:Office: Telemetry collector-->
			<Image condition="is">C:\Program Files (x86)\Microsoft Office\root\Office16\officebackgroundtaskhandler.exe</Image>
			<!--Microsoft:Office:Click2Run-->
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image> <!--Microsoft:Office: Background process-->
			<ParentImage condition="end with">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</ParentImage> <!--Microsoft:Office: Background process-->
			<ParentImage condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</ParentImage> <!--Microsoft:Office: Background process-->
			<!--Windows: Media player-->
			<Image condition="is">C:\Program Files\Windows Media Player\wmpnscfg.exe</Image> <!--Windows: Windows Media Player Network Sharing Service Configuration Application-->
			<!--Google-->
			<CommandLine condition="begin with">"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --type=</CommandLine> <!--Google:Chrome: massive command-line arguments-->
			<CommandLine condition="begin with">"C:\Program Files\Google\Chrome\Application\chrome.exe" --type=</CommandLine> <!--Google:Chrome: massive command-line arguments-->
			<Image condition="begin with">C:\Program Files (x86)\Google\Update\</Image>
			<ParentImage condition="begin with">C:\Program Files (x86)\Google\Update\</ParentImage>
			<!--Mozilla:Firefox-->
			<CommandLine condition="begin with">"C:\Program Files\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
			<CommandLine condition="begin with">"C:\Program Files (x86)\Mozilla Firefox\plugin-container.exe" --channel</CommandLine>
			<!--Adobe-->
			<Rule groupRelation="and">
				<Image condition="end with">AcroRd32.exe</Image>
				<CommandLine condition="contains any">/CR;channel=</CommandLine>
			</Rule>
			<Rule groupRelation="or">
				<Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AcroCEF\AcroCEF.exe</Image>
				<ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AGSService.exe</ParentImage>
				<Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
				<Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\LogTransport2.exe</Image>
			</Rule>
			<Image condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</Image>
			<ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\ACC\Creative Cloud.exe</ParentImage>
			<ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CCXProcess\CCXProcess.exe</ParentImage>
			<ParentImage condition="end with">C:\Program Files (x86)\Adobe\Adobe Creative Cloud\CoreSync\CoreSync.exe</ParentImage>
			<Image condition="end with">C:\Windows\SysWOW64\Macromed\Flash\FlashPlayerUpdateService.exe</Image>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
			<ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\AdobeARM.exe</ParentImage>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\ARM\1.0\armsvc.exe</Image>
			<Image condition="end with">C:\Program Files (x86)\Adobe\Acrobat DC\Acrobat\AdobeCollabSync.exe</Image>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\Adobe Desktop Common\HEX\Adobe CEF Helper.exe</Image>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\AdobeGCClient\AdobeGCClient.exe</Image>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P6\adobe_licutil.exe</Image>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</Image>
			<ParentImage condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\P7\adobe_licutil.exe</ParentImage>
			<Image condition="end with">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</Image>
			<ParentImage condition="is">C:\Program Files (x86)\Common Files\Adobe\OOBE\PDApp\UWA\updaterstartuputility.exe</ParentImage>
			<!--Utilities-->
			<Image condition="begin with">C:\Program Files\NVIDIA Corporation\</Image>
			<Image condition="begin with">C:\Program Files\Realtek\</Image>
			<ParentImage condition="end with">C:\Program Files\Realtek\Audio\HDA\RtkAudioService64.exe</ParentImage>
			<!--Cloud Storage-->
			<Image condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</Image>
			<ParentImage condition="end with">C:\Program Files (x86)\Dropbox\Update\DropboxUpdate.exe</ParentImage>
			<Image condition="contains all"> C:\Users\;\AppData\Local\Microsoft\OneDrive;\FileCoAuth.exe</Image>
			<!--Splunk-->
			<Image condition="contains">:\Program Files\Splunk\bin\</Image> <!--Splunk: Very noisy if using Universal Forwarders-->
			<ParentImage condition="end with">:\Program Files\Splunk\bin\splunkd.exe</ParentImage> <!--Splunk: Very noisy if using Universal Forwarders-->
			<ParentImage condition="end with">:\Program Files\Splunk\bin\splunk.exe</ParentImage> <!--Splunk: Very noisy if using Universal Forwarders-->
			<Image condition="contains">:\Program Files\SplunkUniversalForwarder\bin\</Image> <!--Splunk: Very noisy if using Universal Forwarders-->
			<ParentImage condition="end with">:\Program Files\SplunkUniversalForwarder\bin\splunkd.exe</ParentImage> <!--Splunk: Very noisy if using Universal Forwarders-->
			<ParentImage condition="end with">:\Program Files\SplunkUniversalForwarder\bin\splunk.exe</ParentImage> <!--Splunk: Very noisy if using Universal Forwarders-->
			<!--Antivirus-->
			<Image condition="is">C:\Program Files\ESET\ESET Nod32 Antivirus\ekrn.exe</Image>
			<Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe</Image>
			<Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamservice.exe</Image>
			<Image condition="is">C:\Program Files\Malwarebytes\Anti-Malware\mbamtray.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Intelligence\swi_service.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\Web Control\swc_service.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\Sophos System Protection\ssp.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\RouterNT.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\AutoUpdate\ALsvc.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\Sophos Anti-Virus\SAVAdminService.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Sophos\Remote Management System\ManagementAgentNT.exe</Image>
			<Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\ds_monitor.exe</Image>
			<Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsa.exe</Image>
			<Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\dsuam.exe</Image>
			<Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\Notifier.exe</Image>
			<Image condition="is">C:\Program Files\Trend Micro\Deep Security Agent\lib\Patch.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Trend Micro\BM\TMBMSRV.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmopExtIns32.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmExtIns.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Trend Micro\OfficeScan Client\TmListen.exe</Image>
			<Image condition="begin with">C:\Program Files\Windows Defender\</Image>
			<Image condition="is">C:\Windows\system32\MpSigStub.exe</Image>
			<Image condition="begin with">C:\Windows\SoftwareDistribution\Download\Install\AM_</Image>
			<Image condition="is">C:\Program Files\Microsoft Security Client\MpCmdRun.exe</Image>
			<!--Others-->
			<ParentCommandLine condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe" -Embedding</ParentCommandLine> <!-- Azure OMS/MMA Agent -->
			<CommandLine condition="contains">\Machine\Scripts\Startup\ipamprovisioning.ps1</CommandLine> <!-- Windows IP Address Management (IPAM) -->
			<Rule groupRelation="and">
				<ParentImage condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</ParentImage>
				<CommandLine condition="is">C:\Windows\system32\cscript.exe" /nologo "MonitorKnowledgeDiscovery.vbs</CommandLine>
			</Rule>
			<ParentImage condition="end with">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\respesvc64.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\ResPesvc64.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files\RES Software\Workspace Manager\respesvc.exe</ParentImage>
			<ParentImage condition="is">C:\Program Files\Ivanti\Workspace Control\ResPesvc.exe</ParentImage>
			<Rule name="Exclude WerFault from WMI" groupRelation="and">
				<Image condition="image">C:\Windows\System32\WerFault.exe</Image>
				<ParentImage condition="image">C:\Windows\System32\wbem\WmiPrvSE.exe</ParentImage>
			</Rule>
		</ProcessCreate>
	</RuleGroup>
	
	<!--SYSMON EVENT ID 2 : FILE CREATION TIME RETROACTIVELY CHANGED IN THE FILESYSTEM [FileCreateTime]-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime, PreviousCreationUtcTime-->
	<RuleGroup name="FileCreateTime_Include_Group" groupRelation="or">
		<FileCreateTime onmatch="include">
			<Image name="T1099,Timestomp" condition="begin with">C:\Users</Image> <!--Look for timestomping in user area, usually nothing should be doing that here-->
			<Image name="T1099,Timestomp" condition="begin with">C:\ProgramData</Image>
			<TargetFilename name="T1099,Timestomp" condition="end with">.exe</TargetFilename> <!--Look for backdated executables anywhere-->
			<Image name="T1099,Timestomp" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image> <!--Nothing should be written here | Credit: @SBousseaden [ https://twitter.com/SBousseaden/status/1133030955407630336 ] -->
			<Image name="T1099,Timestomp" condition="contains">\Temp\</Image>
			<Image name="T1099,Timestomp" condition="contains">\tmp\</Image>
			<Image name="T1099,Timestomp" condition="contains">\drivers\</Image>
			<Image name="T1099,Timestomp" condition="contains">\Download</Image>
		</FileCreateTime>
	</RuleGroup>

	<RuleGroup name="FileCreateTime_Exclude_Group" groupRelation="or">
		<FileCreateTime onmatch="exclude">
			<Image condition="image">OneDrive.exe</Image> <!--OneDrive constantly changes file times-->
			<Image condition="image">C:\Windows\system32\backgroundTaskHost.exe</Image>
			<Image condition="contains">setup</Image> <!--Ignore setups-->
			<Image condition="contains">install</Image> <!--Ignore setups-->
			<Image condition="contains">Update\</Image> <!--Ignore setups-->
			<Image condition="end with">redist.exe</Image> <!--Ignore setups-->
			<Image condition="image">msiexec.exe</Image> <!--Ignore setups-->
			<Image condition="image">TrustedInstaller.exe</Image> <!--Ignore setups-->
			<TargetFilename condition="contains">\NVIDIA\NvBackend\ApplicationOntology\</TargetFilename> <!--NVIDIA GeForce Experience Application Ontology, 1000's of events in user profile-->
			<Image condition="end with">AppData\Local\Google\Chrome\Application\chrome.exe</Image>
        	<Image condition="end with">Root\VFS\ProgramFilesX86\Google\Chrome\Application\chrome.exe</Image>
			<Image condition="end with">\AppData\Local\Microsoft\Edge SxS\Application\msedge.exe</Image>
			<Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
			<Image condition="end with">slack.exe</Image>
			<Image condition="image">vivaldi.exe</Image>
		</FileCreateTime>
	</RuleGroup>

	<!--SYSMON EVENT ID 3 : NETWORK CONNECTION INITIATED [NetworkConnect]-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, User, Protocol, Initiated, SourceIsIpv6, SourceIp, SourceHostname, SourcePort, SourcePortName, DestinationIsIpV6, DestinationIp, DestinationHostname, DestinationPort, DestinationPortName-->
	<RuleGroup name="NetworkConnect_Include_Group" groupRelation="or">
		<NetworkConnect onmatch="include">
			<!--Suspicious sources for network-connecting binaries-->
			<Image name="T1036,Masquerading" condition="begin with">C:\Users</Image> <!--Tools downloaded by users can use other processes for networking, but this is a very valuable indicator.-->
			<Image name="T1036,Masquerading" condition="begin with">C:\Recycle</Image> <!--Nothing should operate from the RecycleBin locations.-->
			<Image name="T1036,Masquerading" condition="begin with">C:\ProgramData</Image> <!--Normally, network communications should be sourced from "Program Files" not from ProgramData, something to look at-->
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\Temp</Image> <!--Suspicious anything would communicate from the system-level temp directory-->
			<Image name="T1036,Masquerading" condition="begin with">\</Image> <!--Devices and VSC shouldn't be executing changes | Credit: @SBousseaden @ionstorm @neu5ron @PerchedSystems [ https://twitter.com/SwiftOnSecurity/status/1133167323991486464 ] -->
			<Image name="T1036,Masquerading" condition="begin with">C:\Perflogs</Image> <!-- Credit @blu3_team [ https://blu3-team.blogspot.com/2019/05/netconn-from-suspicious-directories.html ] -->
			<Image name="T1036,Masquerading" condition="begin with">C:\Intel</Image> <!-- Credit @blu3_team [ https://blu3-team.blogspot.com/2019/05/netconn-from-suspicious-directories.html ] -->
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\Fonts</Image> <!-- Credit @blu3_team [ https://blu3-team.blogspot.com/2019/05/netconn-from-suspicious-directories.html ] -->
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\system32\config</Image> <!-- Credit @blu3_team [ https://blu3-team.blogspot.com/2019/05/netconn-from-suspicious-directories.html ] -->
			<Image name="T1036,Masquerading" condition="begin with">C:\Temp</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Intel\Logs\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Users\Default\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Users\Public\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Users\NetworkService\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\Debug\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\Media\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\Help\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\addins\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\repair\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\security\</Image>
			<Image name="T1036,Masquerading" condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
			<Image name="T1036,Masquerading" condition="contains">\htdocs\</Image>
			<Image name="T1036,Masquerading" condition="contains">\wwwroot\</Image>
			<Image name="T1036,Masquerading" condition="contains">\AppData\Local\</Image>
			<Image name="T1036,Masquerading" condition="contains">\AppData\Local\Temp\</Image>
			<Image name="T1036,Masquerading" condition="contains">\AppData\Roaming\</Image>
			<Image name="T1036,Masquerading" condition="contains">\AppData\LocalLow\</Image>
			<Image name="T1036,Masquerading" condition="contains">C:\Windows\SysWOW64</Image>
			<Image name="T1036,Masquerading" condition="contains">\Windows\IME\</Image>
			<Image name="T1036,Masquerading" condition="contains">$Recycle.bin</Image>
			<Rule name="T1036,Masquerading" groupRelation="and">
				<Image condition="contains">\temp\</Image>
				<DestinationIp condition="excludes any">127.0.0.1</DestinationIp>		
			</Rule>
			<!--Suspicious Windows tools-->
			<Image name="T1053,Scheduled_Task" condition="image">at.exe</Image> <!--Windows: Remote task scheduling, removed in Win10 | Credit @ion-storm -->
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">certutil.exe</Image> <!--Windows: Certificate tool can contact outbound | Credit @ion-storm @FVT [ https://twitter.com/FVT/status/834433734602530817 ] -->
			<Image name="T1059.003,Windows_Command_Shell" condition="image">cmd.exe</Image> <!--Windows: Remote command prompt-->
			<Image condition="image">cmstp.exe</Image> <!--Windows: Connection manager profiles can launch executables from WebDAV [ https://twitter.com/NickTyrer/status/958450014111633408 ] | Credit @NickTyrer @Oddvarmoe @KyleHanslovan @subTee -->
			<Image name="T1202,Indirect_Command_Execution" condition="image">cscript.exe</Image> <!--WindowsScriptingHost: | Credit @Cyb3rOps [ https://gist.github.com/Neo23x0/a4b4af9481e01e749409 ] -->
			<Image condition="image">driverquery.exe</Image> <!--Windows: Remote recognisance of system configuration, oudated/vulnerable drivers -->
			<Image name="T1069,Permission_Groups_Discovery" condition="image">dsquery.exe</Image> <!--Microsoft: Query Active Directory -->
			<Image condition="image">hh.exe</Image> <!--Windows: HTML Help Executable, opens CHM files -->
			<Image condition="image">infDefaultInstall.exe</Image> <!--Microsoft: [ https://github.com/huntresslabs/evading-autoruns ] | Credit @KyleHanslovan -->
			<Image condition="image">java.exe</Image> <!--Java: Monitor usage of vulnerable application and init from JAR files | Credit @ion-storm -->
			<Image condition="image">javaw.exe</Image> <!--Java: Monitor usage of vulnerable application and init from JAR files -->
			<Image condition="image">javaws.exe</Image> <!--Java: Monitor usage of vulnerable application and init from JAR files -->
			<Image name="T1543.003,Windows_Service" condition="image">mmc.exe</Image> <!--Windows: -->
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">msbuild.exe</Image> <!--Windows: [ https://www.hybrid-analysis.com/sample/a314f6106633fba4b70f9d6ddbee452e8f8f44a72117749c21243dc93c7ed3ac?environmentId=100 ] -->
			<Image name="T1218.005,Mshta" condition="image">mshta.exe</Image> <!--Windows: HTML application executes scripts without IE protections | Credit @ion-storm [ https://en.wikipedia.org/wiki/HTML_Application ] -->
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">msiexec.exe</Image> <!--Windows: Can install from http:// paths | Credit @vector-sec -->
			<Image name="T1016,System_Network_Configuration_Discovery" condition="image">nbtstat.exe</Image> <!--Windows: NetBIOS statistics, attackers use to enumerate local network -->
			<Image name="T1018,Remote_System_Discovery" condition="image">net.exe</Image> <!--Windows: Note - May not detect anything, net.exe is a front-end to lower APIs | Credit @ion-storm -->
			<Image name="T1069,Permission_Groups_Discovery" condition="image">net1.exe</Image> <!--Windows: Launched by "net.exe", but it may not detect connections either -->
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">notepad.exe</Image> <!--Windows: [ https://secrary.com/ReversingMalware/CoinMiner/ ] [ https://blog.cobaltstrike.com/2013/08/08/why-is-notepad-exe-connecting-to-the-internet/ ] -->
			<Image name="T1016,System_Network_Configuration_Discovery" condition="image">nslookup.exe</Image> <!--Windows: Retrieve data over DNS -->
			<Image name="T1059.001,PowerShell" condition="image">powershell.exe</Image> <!--Windows: PowerShell interface-->
			<Image name="T1057,Process_Discovery" condition="image">qprocess.exe</Image> <!--Windows: [ https://www.first.org/resources/papers/conf2017/APT-Log-Analysis-Tracking-Attack-Tools-by-Audit-Policy-and-Sysmon.pdf ] -->
			<Image name="T1057,Process_Discovery" condition="image">qwinsta.exe</Image> <!--Windows: Remotely query login sessions on a server or workstation | Credit @ion-storm -->
			<Image name="T1112,Modify_Registry" condition="image">reg.exe</Image> <!--Windows: Remote Registry editing ability | Credit @ion-storm -->
			<Image name="T1218.009,Regsvcs/Regasm" condition="contains any">regasm.exe;regsvcs.exe</Image>
			<Image name="T1218.010,Regsvr32" condition="image">regsvr32.exe</Image> <!--Windows: [ https://subt0x10.blogspot.com/2016/04/bypass-application-whitelisting-script.html ] -->
			<Image name="T1218.011,Rundll32" condition="image">rundll32.exe</Image> <!--Windows: [ https://blog.cobaltstrike.com/2016/07/22/why-is-rundll32-exe-connecting-to-the-internet/ ] -->
			<Image name="T1057,Process_Discovery" condition="image">rwinsta.exe</Image> <!--Windows: Disconnect remote sessions | Credit @ion-storm -->
			<Image name="T1543.003,Windows_Service" condition="image">sc.exe</Image> <!--Windows: Remotely change Windows service settings | Credit @ion-storm -->
			<Image name="T1053,Scheduled_Task/Job" condition="image">schtasks.exe</Image> <!--Windows: Command-line interface to local and remote tasks -->
			<Image name="T1089,Disabling_Security_Tools" condition="image">taskkill.exe</Image> <!--Windows: Kill processes, has remote ability -->
			<Image name="T1057,Process_Discovery" condition="image">tasklist.exe</Image> <!--Windows: List processes, has remote ability -->
			<Image name="T1047,Windows_Management_Instrumentation" condition="image">wmic.exe</Image> <!--WindowsManagementInstrumentation: Credit @Cyb3rOps [ https://gist.github.com/Neo23x0/a4b4af9481e01e749409 ] -->
			<Image name="T1202,Indirect_Command_Execution" condition="image">wscript.exe</Image> <!--WindowsScriptingHost: | Credit @arekfurt -->
			<Image name="T1016,System_Network_Configuration_Discovery" condition="image">ipconfig.exe</Image>
			<Image name="T1049,System_Network_Connections_Discovery" condition="image">netstat.exe</Image>
			<Image name="T1033,System_Owner/User_Discovery" condition="image">quser.exe</Image>
			<Image name="T1057,Process_Discovery" condition="image">query.exe</Image>
			<Image name="T1134,Access_Token_Manipulation" condition="image">runas.exe</Image>
			<Image name="T1518.001,Security_Software_Discovery" condition="image">netsh.exe</Image>
			<Image condition="image">klist.exe</Image>
			<Image name="T1070,Indicator_Removal_on_Host" condition="image">wevtutil.exe</Image>
			<Image name="T1053,Scheduled_Task/Job" condition="image">taskeng.exe</Image>
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">Msdt.exe</Image>
			<Image name="T1059.001,PowerShell" condition="image">OpenConsole.exe</Image>
			<Image name="T1059.001,PowerShell" condition="image">WindowsTerminal.exe</Image>
			<Image condition="image">dllhost.exe</Image>
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">Mavinject.exe</Image>
			<!--Live of the Land Binaries and scripts (LOLBAS) -->
			<Image name="T1197,BITS_Jobs" condition="image">bitsadmin.exe</Image> <!-- Windows: Background Intelligent Transfer Service - Can download from URLs -->
			<Image name="T1096,NTFS_File_Attributes" condition="image">esentutl.exe</Image> <!-- Windows: Database utilities for the ESE - Can fetch from UNC paths -->
			<Image name="T1105,Ingress_Tool_Transfer" condition="image">expand.exe</Image> <!-- Windows: Expands one or more compressed files - Can fetch from UNC paths -->
			<Image name="T1105,Ingress_Tool_Transfer" condition="image">extrac32.exe</Image> <!--Windows: Uncompress .cab files - Can fetch from UNC paths -->
			<Image condition="image">findstr.exe</Image> <!-- Windows: Search for strings - Can fetch from UNC paths -->
			<Image condition="image">GfxDownloadWrapper.exe</Image> <!-- Intel Graphics Control Panel: Remote file download -->
			<Image name="T1105,Ingress_Tool_Transfer" condition="image">IEExec.exe</Image> <!-- Windows: Microsoft .NET Framework application - Download and execute from URLs -->
			<Image condition="image">makecab.exe</Image> <!-- Windows: Packages existing files into a .cab - Can fetch from UNC paths -->
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">replace.exe</Image> <!-- Windows: Used to replace file with another file - Can fetch from UNC paths -->
			<Image condition="image">Excel.exe</Image> <!-- Windows Office: Excel - Can download from URLs -->
			<Image condition="image">Powerpnt.exe</Image> <!-- Windows Office: PowerPoint - Can download from URLs -->
			<Image condition="image">Winword.exe</Image> <!-- Windows Office: Word - Can download from URLs -->
			<Image condition="image">squirrel.exe</Image> <!-- Windows: Update the Nuget/Squirrel packages. Part of Teams. - Can download from URLs -->
			<Image condition="image">CSC.exe</Image>
			<!--Relevant 3rd Party Tools-->
			<Image name="Netcat_Detected" condition="contains any">netcat.exe;nc.exe;nc64.exe;ncat.exe</Image>
			<Image name="Procdump_Detected" condition="contains any">procdump</Image>
			<Image name="PSExec_Network_Connection" condition="contains any">psexe</Image>
			<Image name="VNC_Network_Connection" condition="contains any">vnc;vncs;vncv</Image>
			<Image name="T1569.002,Service_Execution" condition="image">winexesvc.exe</Image>
			<Image name="T1595.002,Vulnerability_Scanning,Port_Scan_Tool_Detected" condition="contains any">rcpping;tcpping;tcping;routerscan;grabff;Port-Scan;netscan;\nmap;ipscan;nacmdline.exe;advanced_port_scanner.exe;nmap.exe;zenmap.exe;advanced_ip_scanner.exe</Image>
			<Image condition="image">psinfo.exe</Image>
			<Image name="T1021,Remote_Services" condition="image">omniinet.exe</Image>
			<Image name="T1021,Remote_Services" condition="image">hpsmhd.exe</Image>
			<Image name="T1102,Web_Service" condition="begin with">C:\Program Files\Microsoft\HybridConnectionManager</Image>
			<Image name="T1202,Indirect_Command_Execution" condition="image">bash.exe</Image>
			<Image name="T1202,Indirect_Command_Execution" condition="image">pcalua.exe</Image>
			<Image name="T1033,System_Owner/User_Discovery" condition="image">nltest.exe</Image>
			<Image name="T1202,Indirect_Command_Execution" condition="image">winrs.exe</Image>
			<Image name="T1127,Trusted_Developer_Utilities_Proxy_Execution" condition="image">dfsvc.exe</Image>
			<Image name="T1569.002,Service_Execution" condition="image">dnscmd.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer" condition="image">Print.Exe</Image>
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">RegisterCimProvider.exe</Image>
			<Image name="T1003,Credential_Dumping" condition="image">RpcPing.exe</Image>
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">ScriptRunner.exe</Image>
			<Image name="T1548.002,Bypass_User_Access_Control" condition="image">xwizard.exe</Image>
			<Image name="T1202,Indirect_Command_Execution" condition="image">desktopimgdownldr.exe</Image>
			<Image name="T1069,Permission_Groups_Discovery" condition="image">AdFind.exe</Image>
			<Image name="T1218,Signed_Binary_Proxy_Execution" condition="image">SyncAppvPublishingServer.exe</Image>
			<Image name="T1218.004,InstallUtil" condition="image">InstallUtil.exe</Image>
			<Image name="T1021,Remote_Services" condition="contains any">putty.exe;kitty.exe;kitty_portable.exe;psftp.exe;ssh.exe;tftp.exe;telnet.exe;mstsc.exe</Image>
			<Image name="T1021,Remote_Services" condition="contains any">psshutdown;PsPasswd;psservice;pskill</Image>
			<Image name="T1028,Windows_Remote_Management" condition="image">wsmprovhost.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer" condition="image">plink.exe</Image>
			<!--Ports: Suspicious-->
			<DestinationPort name="T1021,Remote_Services,SSH" condition="is">22</DestinationPort> <!--SSH protocol, monitor admin connections-->
			<DestinationPort name="T1021,Remote_Services,Telnet" condition="is">23</DestinationPort> <!--Telnet protocol, monitor admin connections, insecure-->
			<DestinationPort name="T1043,Commonly_Used_Port,SMTP" condition="is">25</DestinationPort> <!--SMTP mail protocol port, insecure, used by threats-->
			<DestinationPort name="T1043,Commonly_Used_Port,IMAP" condition="is">143</DestinationPort> <!--IMAP mail protocol port, insecure, used by threats-->
			<DestinationPort name="T1021,Remote_Services,RDP" condition="is">3389</DestinationPort> <!--Windows:RDP: Monitor admin connections-->
			<DestinationPort name="T1021,Remote_Services,VNC" condition="is">5800</DestinationPort> <!--VNC protocol: Monitor admin connections, often insecure, using hard-coded admin password-->
			<DestinationPort name="T1021,Remote_Services,VNC" condition="is">5900</DestinationPort> <!--VNC protocol: Monitor admin connections, often insecure, using hard-coded admin password-->
			<DestinationPort name="T1021.006,WinRM" condition="is">5985</DestinationPort> <!-- WinRM protocol used for remote connections to execute commands -->
			<DestinationPort name="T1021.006,WinRM_over_HTTPS" condition="is">5986</DestinationPort> <!-- WinRM over HTTPS when set up in an environment can be used for remote connections to execute commands -->
			<DestinationPort name="Alert,Metasploit" condition="is">4444</DestinationPort>
			<DestinationPort name="T1021,Remote_Services" condition="is">88</DestinationPort>
			<!--Ports: Proxy-->
			<DestinationPort name="T1043,Commonly_Used_Port,Proxy" condition="is">1080</DestinationPort> <!--Socks proxy port | Credit @ion-storm-->
			<DestinationPort name="T1043,Commonly_Used_Port,Proxy" condition="is">3128</DestinationPort> <!--Socks proxy port | Credit @ion-storm-->
			<DestinationPort name="T1043,Commonly_Used_Port,Proxy" condition="is">8080</DestinationPort> <!--Socks proxy port | Credit @ion-storm-->
			<!--Ports: Tor-->
			<DestinationPort name="T1043,Commonly_Used_Port,Tor" condition="is">1723</DestinationPort> <!--Tor protocol [ https://attack.mitre.org/wiki/Technique/T1090 ] | Credit @ion-storm-->
			<DestinationPort name="T1043,Commonly_Used_Port,Tor" condition="is">9001</DestinationPort> <!--Tor protocol [ http://www.computerworlduk.com/tutorial/security/tor-enterprise-2016-blocking-malware-darknet-use-rogue-nodes-3633907/ ] -->
			<DestinationPort name="T1043,Commonly_Used_Port,Tor" condition="is">9030</DestinationPort> <!--Tor protocol [ http://www.computerworlduk.com/tutorial/security/tor-enterprise-2016-blocking-malware-darknet-use-rogue-nodes-3633907/ ] -->
			<DestinationPort name="T1043,Commonly_Used_Port,Tor" condition="is">4500</DestinationPort>
			<!--Command and Control-->
			<Rule name="Cobalt_Strike_Team_Server_port" groupRelation="and">
				<DestinationPort condition="is">50050</DestinationPort>
				<Initiated>true</Initiated>
			</Rule>
			<Rule name="Outbound_SMTP_Email_Sending" groupRelation="and">
				<DestinationPort condition="is">25</DestinationPort>
				<Image condition="excludes any">\Bin\EdgeTransport.exe;Bin\MSExchangeFrontendTransport.exe</Image>
				<Initiated>true</Initiated>
			</Rule>
			<!--Proxy: Multi-hop Proxy-->
			<Image name="T1090.003,Multi-hop_Proxy,Tor_Connection" condition="image">tor.exe</Image>
			<DestinationHostname name="T1090.003,Multi-hop_Proxy,Tor2Web" condition="contains any">hiddenservice.net;onion.city;onion.direct;onion.direct;onion.link;onion.nu;onion.pet;onion.plus;onion.rip;onion.sh;onion.sh;onion.si;onion.to;onion.top;onion.ws;tor-gateways.de;tor2net.com;tor2web.blutmagie.de;tor2web.fi;tor2web.info;tor2web.io;tor2web.org;onion.to</DestinationHostname>
			<!--Exfiltration Over Alternative Protocol-->
			<DestinationHostname name="T1048,Exfiltration_Over_Alternative_Protocol,DNS_Over_HTTPS" condition="contains any">dns.google;cloudflare-dns.com;mozilla.cloudflare-dns.com;dns.233py.com;dns.aaflalo.me;doh.opendns.com;.quad9.net;dns.cleanbrowsing.org;dns-family.adguard.com;dns.adguard.com;.233py.com;dnscrypt;dnscrypt-cert.oszx.co;dns.oszx.co;doh.dns.sb;doh.defaultroutes.de;doh.tiarap.org;doh.tiar.app;doh.captnemo.in;.aaflalo.me;doh.appliedprivacy.net;doh.dnswarden.com;commons.host;dns.twnic.tw;ibuki.cgnat.net;doh.xfinity.com;dns.nextdns.io;dns.dnsoverhttps.net;doh.crypto.sx;doh.powerdns.org;.blahdns.com;dns.rubyfish.cn;dns.containerpi.com;.seby.io;rdns.faelix.net;doh.li;.armadillodns.net;doh.netweaver.uk;doh.42l.fr;dns.aa.net.uk;adblock.mydns.network;ibksturm.synology.me;jcdns.fun</DestinationHostname>
			<!--Transfer_Data_to_Cloud_Account-->
			<DestinationHostname name="T1048,Exfiltration_Over_Alternative_Protocol" condition="contains all">privatlab.com</DestinationHostname>
			<DestinationHostname name="T1048,Exfiltration_Over_Alternative_Protocol" condition="contains any">mega.nz;mega.co.nz</DestinationHostname>
			<DestinationHostname name="T1048,Exfiltration_Over_Alternative_Protocol" condition="contains any">.pcloud.com</DestinationHostname>
			<DestinationHostname name="T1567.002,Exfiltration_to_Cloud_Storage" condition="contains all">.box.com;upload</DestinationHostname>
			<!--Resource Hijacking-->
			<DestinationHostname name="T1496,Resource_Hijacking,Crypto_Currency_Miner_Detected" condition="contains any">0x1f4b0.com;1q2w3.life;1q2w3.website;31.187.64.216;185.193.38.148;aalbbh84.info;adfreetv.ch;adless.io;adplusplus.fr;adrenali.gq;ajcryptominer.com;ajplugins.com;allfontshere.press;altavista.ovh;amhixwqagiz.ru;analytics.blue;appelamule.com;arizona-miner.tk;aster18cdn.nl;aster18prx.nl;avero.xyz;averoconnector.com;bauersagtnein.myeffect.net;bhzejltg.info;blazepool;blockmasters;blockmasterscoins;bmnr.pw;bmst.pw;bohemianpool;carry.myeffect.net;cashbeet.com;cdn-code.host;cfceu.duckdns.org;cfcnet.gdn;cfcnet.top;cfcs1.duckdns.org;chainblock.science;cieh.mx;coin-hive.com;coin-service.com;coin-services.info;coiner.site;coinpirate.cf;coinrail.io;coinwebmining.com;cpu2cash.link;cryptaloot.pro;cryptmonero;crypto-loot.com;crypto-pool;crypto-webminer.com;cryptoloot.pro;d-ns.ga;dataservices.download;directprimal.com;dwarfpool;encoding.ovh;estream.to;eth-pocket.com;eth-pocket.de;eth-pocket.eu;ethereum-pocket.de;ethereum-pocket.eu;ethtrader.de;eu.sushipool.com;f1tbit.com;flnqmin.org;freecontent.bid;freecontent.date;freecontent.loan;freecontent.racing;freecontent.stream;freecontent.win;gnrdomimplementation.com;graftpool.ovh;greenindex.dynamic-dns.net;gustaver.ddns.net;hashrefinery;hashvault.pro;herphemiste.com;hide.ovh;hk.rs;hlpidkr.ru;hodlers.party;hodling.faith;hostingcloud.win;hrfziiddxa.ru;ihdvilappuxpgiv.ru;imhvlhaelvvbrq.ru;insdrbot.com;irrrymucwxjl.ru;istlandoll.com;ivuovhsn.ru;iwanttoearn.money;ixvenhgwukn.ru;jqassets.download;jqr-cdn.download;jqrcdn.download;jquerrycdn.download;jqwww.download;jqxrrygqnagn.ru;jscoinminer.com;jwduahujge.ru;ksimdw.ru;l33tsite.info;laferia.cr;ledhenone.com;ltstyov.ru;mepirtedic.com;mine.bz;minercircle.com;minercry.pt;minergate;minero.cc;miners.pro;minescripts.info;mininghub.club;miningpoolhubcoins;minr.pw;mixpools.org;mmc.center;mollnia.com;monerise.com;monero.lindon-pool.win;monero;moriaxmr.com;munero.me;mxcdn1.now.sh;mxcdn2.now.sh;myadstats.com;mypool.online;nablabee.com;nanopool.org;nathetsof.com;nicehash;nimiqpool.com;nimpool.io;node.philpool.com;npcdn1.now.sh;nunu-001.now.sh;ogondkskyahxa.ru;ogrid.org;oinkinns.tk;olecintri.com;omine.org;onvid.club;open-hive-server-1.pp.ua;oxwwoeukjispema.ru;pcejuyhjucmkiny.ru;pool.nimiq.watch;pool.nimiqchain.info;pool.porkypool.com;pool.xmr;poolto.be;prohash.net;prohash;proj2018.xyz;pzoifaum.info;ratchetmining.com;realnetwrk.com;reauthenticator.com;rove.cl;ruvuryua.ru;s7ven.com;scaleway.ovh;sentemanactri.com;sickrage.ca/ch;sighash.info;slushpool;soodatmish.com;sparechange.io;statdynamic.com;stati.bid;staticsfs.host;streamplay.to;supportxmr;suprnova.cc;svivqrhrh.ru;sxcdn02.now.sh;sxcdn3.now.sh;sxcdn4.now.sh;sxcdn6.now.sh;synconnector.com;teracycle.net;tercabilis.info;thelifeisbinary.ddns.net;thersprens.com;torrent.pw;ulnawoyyzbljc.ru;unrummaged.com;uoldid.ru;usxmrpool;viaxmr.com;vpzccwpyilvoyg.ru;vzzexalcirfgrf.ru;wbmwss.beetv.net;webmine.cz;webmine.pro;webminepool.tk;webminerpool.com;webwidgetz.duckdns.org;wmemsnhgldd.ru;wmtech.website;wmwmwwfmkvucbln.ru;wrxgandsfcz.ru;xmrm.pw;xmrminingproxy.com;xmrpool;yiimp;yuyyio.com;zavzlen.ru;zergpool;zergpoolcoins;ziykrgc.ru;zlx.com.br;zpool</DestinationHostname>
			<!--UEBA Rules-->
			<!-- <Rule name="Inbound_Windows_SVCHost_Network_Connection" groupRelation="and">
				<Image condition="image">C:\Windows\system32\svchost.exe</Image>
				<DestinationPort condition="is not">3389</DestinationPort>
				<DestinationPort condition="is not">22</DestinationPort>
				<DestinationPort condition="is not">21</DestinationPort>
				<DestinationPort condition="is not">5985</DestinationPort>
				<Initiated>false</Initiated>
			</Rule> -->
			<!-- <Rule name="Outbound_Windows_SVCHost_Network_Connection" groupRelation="and">
				<Image condition="image">C:\Windows\system32\svchost.exe</Image>
				<Initiated>true</Initiated>
				<SourcePort condition="is not">135</SourcePort>
				<SourcePort condition="is not">445</SourcePort>
				<DestinationPort condition="is not">5985</DestinationPort>
			</Rule> -->
			<!-- <Rule name="Outbound_Non-System_port_445_SMB_connections" groupRelation="and">
				<Image condition="is not">System</Image>
				<Image condition="excludes">svchost.exe</Image>
				<DestinationPort condition="is">445</DestinationPort>
			</Rule> -->
			<!-- <Rule name="Outbound_Non-System_port_389_LDAP_connections" groupRelation="and">
				<Image condition="is not">System</Image>
				<Image condition="excludes any">svchost.exe;lsass.exe</Image>
				<DestinationPort condition="is">389</DestinationPort>
			</Rule> -->
			<!-- <Rule name="Inbound_LDAP_Connections" groupRelation="and">
				<Image condition="image">C:\Windows\System32\lsass.exe</Image>
				<DestinationPort condition="is">389</DestinationPort>
				<DestinationIp condition="excludes any">127.0.0.1;0:0:0:0:0:0:0:1;fe80:0</DestinationIp>
				<SourceHostname condition="excludes any">EXCH</SourceHostname>
				<SourceIp condition="excludes any">127.0.0.1;0:0:0:0:0:0:0:1;fe80:0</SourceIp>
				<Initiated>false</Initiated>
			</Rule> -->
			<Rule name="Notepad_connecting_to_the_internet" groupRelation="and">
				<Image condition="image">notepad.exe</Image>
				<DestinationIp condition="excludes">127.0.0.1</DestinationIp>
			</Rule>
			<Rule name="Browsers_accessing_non-standard_ports" groupRelation="and">
				<Image condition="contains any">\iexplore.exe;\chrome.exe;\firefox.exe;\MicrosoftEdge;browser_broker.exe;\vivaldi.exe;\brave.exe;\opera.exe</Image>
				<DestinationPort condition="is not">80</DestinationPort>
				<DestinationPort condition="is not">443</DestinationPort>
				<Initiated>true</Initiated>
			</Rule>
			<!-- <DestinationHostname name="Connection_to_Github" condition="contains">github</DestinationHostname>  -->
			<DestinationHostname name="Connection_to_Github" condition="contains">githubusercontent.com</DestinationHostname>
			<Rule name="T1567.002,Exfiltration_to_Cloud_Storage,Dropbox_Cloud_Exfiltration" groupRelation="and">
				<DestinationHostname condition="end with">dropboxapi.com</DestinationHostname>
				<Image condition="excludes any">\Dropbox\Client\Dropbox.exe;\Dropbox\bin\Dropbox.exe;\Oracle\Java\</Image>
			</Rule>
			<Rule name="T1567.002,Exfiltration_to_Cloud_Storage,OneDrive_Cloud_Exfiltration" groupRelation="and">
				<DestinationHostname condition="contains">1drv</DestinationHostname>
				<Image condition="excludes any">C:\Program Files\Microsoft OneDrive\OneDrive.exe;\AppData\Local\Microsoft\OneDrive\OneDrive.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe;\Internet Explorer\iexplore.exe;C:\Windows\System32\AppHostRegistrationVerifier.exe;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;C:\Program Files (x86)\BraveSoftware\Brave-Browser\Application\brave.exe;C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe;C:\Program Files\Mozilla Firefox\firefox.exe</Image>
			</Rule>
			<!-- <DestinationHostname name="Social_Networking" condition="contains any">tiktok;parler.com;gab.com;mewe.com;4chan;8chan;facebook;fbcdn;twitter;instagram;snapchat</DestinationHostname> -->
			<DestinationHostname name="Internet_Relay_Chat" condition="contains any">efnet;undernet;freenode;ircnet;.rizon;quakenet;oftc.net;dalnet</DestinationHostname>
			<!-- <DestinationHostname name="Internet_Chat" condition="contains any">.slack.com;discord.;telegram.;rocketchat.;mattermost.;flock.com</DestinationHostname> -->
			<!-- <Image name="Apache_Webserver" condition="image">apache.exe</Image> -->
			<!-- <Image name="MS_IIS_Webserver" condition="image">w3wp.exe</Image> -->
			<!-- <Image name="PHP_Webserver" condition="contains any">\php-cgi.exe;\php.exe</Image> -->
			<!-- <Image name="Tomcat_Webserver" condition="contains">tomcat</Image> -->
			<!-- <Image name="Setup_Network_connectivity" condition="contains">setup</Image> -->
			<Image name="Uninstaller_Network_connectivity" condition="contains">unins</Image>
			<Image name="Unknown_Process_Connecting_to_network" condition="contains">unknown process</Image>
			<Image name="Windows_Explorer_Network_Connection" condition="image">explorer.exe</Image>
			<Image name="Windows_SMTP_Server" condition="image">inetinfo.exe</Image>
			<!--Other suspicious network connections-->
			<DestinationHostname name="T1311,Dynamic_DNS" condition="contains any">afraid.org;duckdns.org;changeip.com;ddns.net;hopto.org;zapto.org;servehttp.com;sytes.net;whoer.net;bravica.net;ip.webmasterhome.cn;whatsmyip.us;myip.kz;ip-addr.es;curlmyip;anysrc.net;anysrc.net;dlinkddns.com;no-ip.com;no-ip.org;no-ip.biz;no-ip.info;noip.com</DestinationHostname>
		</NetworkConnect>
	</RuleGroup>

	<RuleGroup name="NetworkConnect_Exclude_Group" groupRelation="or">
		<NetworkConnect onmatch="exclude">
			<!--Microsoft-->
			<Image condition="begin with">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image>
			<Image condition="end with">AppData\Local\Microsoft\Teams\current\Teams.exe</Image> <!--Microsoft: Teams-->
			<DestinationHostname condition="is">microsoft.com</DestinationHostname> <!--Microsoft:Update delivery-->
			<DestinationHostname condition="end with">.microsoft.com</DestinationHostname> <!--Microsoft:Update delivery-->
			<DestinationHostname condition="end with">microsoft.com.akadns.net</DestinationHostname> <!--Microsoft:Update delivery-->
			<DestinationHostname condition="end with">microsoft.com.nsatc.net</DestinationHostname> <!--Microsoft:Update delivery-->
			<DestinationHostname condition="end with">windowsupdate.com</DestinationHostname>
			<DestinationHostname condition="end with">wustat.windows.com</DestinationHostname>
			<DestinationHostname condition="end with">.bing.com</DestinationHostname>
			<DestinationHostname condition="end with">.cloudapp.net</DestinationHostname>
			<DestinationHostname condition="end with">.lync.com</DestinationHostname>
			<DestinationHostname condition="end with">.outlook.com</DestinationHostname>
			<DestinationHostname condition="end with">.wns.windows.com</DestinationHostname>
			<DestinationHostname condition="end with">aps.windows.com</DestinationHostname>
			<DestinationHostname condition="end with">msn.com.nsatc.net</DestinationHostname>
			<DestinationHostname condition="end with">msn.com</DestinationHostname>
			<DestinationHostname condition="end with">b.akamaiedge.net</DestinationHostname>
			<DestinationHostname condition="end with">bingforbusiness.com</DestinationHostname>
			<DestinationHostname condition="end with">config.edge.skype.com</DestinationHostname>
			<DestinationHostname condition="end with">csp.digicert.com</DestinationHostname>
			<DestinationHostname condition="end with">ocsp.digicert.com</DestinationHostname>
			<DestinationHostname condition="end with">g.akamaiedge.net</DestinationHostname>
			<DestinationHostname condition="end with">g.live.com</DestinationHostname>
			<DestinationHostname condition="end with">msedge.net</DestinationHostname>
			<DestinationHostname condition="end with">windows.com.akadns.net</DestinationHostname>
			<DestinationHostname condition="end with">ip5.afdorigin-prod-am02.afdogw.com</DestinationHostname>
			<DestinationHostname condition="end with">ip5.afdorigin-prod-ch02.afdogw.com</DestinationHostname>
			<DestinationHostname condition="end with">login.msa.akadns6.net</DestinationHostname>
			<DestinationHostname condition="end with">oneclient.sfx.ms</DestinationHostname>
			<DestinationHostname condition="end with">virtualearth.net</DestinationHostname>
			<DestinationHostname condition="end with">windows.net</DestinationHostname>
			<Image condition="image">EdgeTransport.exe</Image>
			<Image condition="image">MSExchangeDelivery.exe</Image>
			<Image condition="image">MSExchangeFrontendTransport.exe</Image>
			<Image condition="image">MSExchangeHMWorker.exe</Image>
			<Image condition="image">MSExchangeSubmission.exe</Image>
			<!--Antivirus-->
			<Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab</Image> 
			<Image condition="begin with">C:\Program Files\Kaspersky Lab</Image>
			<Image condition="begin with">C:\Program Files (x86)\ESET</Image>
			<Image condition="begin with">C:\Program Files\ESET</Image>
			<Image condition="begin with">C:\Program Files\Palo Alto Networks</Image>
			<Image condition="begin with">C:\Program Files (x86)\Sophos</Image>
			<Image condition="begin with">C:\Program Files\Sophos</Image>
			<Image condition="begin with">C:\Program files (x86)\Trend Micro</Image>
			<!--Cloud Storage-->
			<Image condition="image">OneDrive.exe</Image> <!--Microsoft: OneDrive-->
			<Image condition="image">OneDriveStandaloneUpdater.exe</Image> <!--Microsoft: OneDrive-->
			<Image condition="end with">\AppData\Local\Microsoft\OneDrive\OneDrive.exe</Image> <!--Microsoft: OneDrive-->
			<Image condition="end with">AppData\Roaming\Dropbox\bin\Dropbox.exe</Image>
			<Image condition="end with">ownCloud\owncloud.exe</Image>
			<Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-ui.exe</Image>
			<Image condition="end with">AppData\Local\SynologyDrive\SynologyDrive.app\bin\cloud-drive-daemon.exe</Image>
			<!--Others-->
			<Image condition="end with">winlogbeat.exe</Image>
			<Image condition="end with">packetbeat.exe</Image>
			<Image condition="end with">AppData\Roaming\Spotify\Spotify.exe</Image>
			<Rule groupRelation="and">
				<Image condition="is">C:\Windows\System32\lsass.exe</Image>
				<DestinationPort condition="is">88</DestinationPort>
			</Rule>
			<Rule groupRelation="and">
				<Protocol condition="is">udp</Protocol>
				<DestinationPort condition="is">3389</DestinationPort>
			</Rule>
			<!--OCSP known addresses-->
			<DestinationIp condition="is">23.4.43.27</DestinationIp> <!--Digicert [ https://otx.alienvault.com/indicator/ip/23.4.43.27 ] -->
			<DestinationIp condition="is">72.21.91.29</DestinationIp> <!--Digicert [ https://otx.alienvault.com/indicator/ip/72.21.91.29 ] -->
			<!--Loopback Addresses-->
			<DestinationIp condition="is">127.0.0.1</DestinationIp> <!--Credit @ITProPaul-->
			<DestinationIp condition="begin with">fe80:0:0:0</DestinationIp> <!--Credit @ITProPaul-->
		</NetworkConnect>
	</RuleGroup>

	<!--SYSMON EVENT ID 4 : RESERVED FOR SYSMON SERVICE STATUS MESSAGES-->
	<!--DATA: UtcTime, State, Version, SchemaVersion-->
	<!--Cannot be filtered.-->

	<!--SYSMON EVENT ID 5 : PROCESS ENDED [ProcessTerminate]-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image-->
	<RuleGroup name="ProcessTerminate_Include_Group" groupRelation="or">
		<ProcessTerminate onmatch="include">
			<Image condition="begin with">C:\Users</Image> <!--Process terminations by user binaries-->
			<Image condition="begin with">\</Image> <!--Devices and VSC shouldn't be executing changes | Credit: @SBousseaden @ionstorm @neu5ron @PerchedSystems [ https://twitter.com/SwiftOnSecurity/status/1133167323991486464 ] -->
			<Image condition="contains">\Temp\</Image>
			<Image condition="begin with">C:\inetpub\</Image>
			<Image condition="contains">$RECYCLE.BIN</Image>
			<Image condition="contains any">packetbeat.exe;metricbeat.exe;filebeat.exe;winlogbeat.exe;o365beat.exe;graylog-sidecar.exe;graylog-collector-sidecar.exe;splunkd.exe;splunk.exe;syslogng.exe;syslog-ng.exe;nxlog-processor.exe;snarecore.exe;fluentd;td-agent</Image>
			<Image condition="begin with">C:\Windows\system32\config\systemprofile\</Image>
			<Image condition="begin with">C:\Windows\sysWOW64\config\systemprofile\</Image>
		</ProcessTerminate>
	</RuleGroup>

	<RuleGroup name="ProcessTerminate_Exclude_Group" groupRelation="or">
		<ProcessTerminate onmatch="exclude">
		</ProcessTerminate>
	</RuleGroup>

	<!--SYSMON EVENT ID 6 : DRIVER LOADED INTO KERNEL [DriverLoad]-->
	<!--DATA: UtcTime, ImageLoaded, Hashes, Signed, Signature, SignatureStatus-->
	<RuleGroup name="DriverLoad_Exclude_Group" groupRelation="or">
		<!--Default to log all and exclude only valid signed Microsoft or Intel drivers-->
		<DriverLoad onmatch="exclude">
			<Rule groupRelation="and">
				<Signature condition="begin with">Intel </Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
			<Rule groupRelation="and">
				<Signature condition="contains">Microsoft</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
			<Rule groupRelation="and">
				<Signature condition="contains">Windows</Signature>
				<SignatureStatus condition="is">Valid</SignatureStatus>
			</Rule>
		</DriverLoad>
	</RuleGroup>

	<!--SYSMON EVENT ID 7 : DLL (IMAGE) LOADED BY PROCESS [ImageLoad]-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, ImageLoaded, Hashes, Signed, Signature, SignatureStatus-->
	<!--Caution: Can cause high system load, disabled by default.-->
	<RuleGroup name="ImageLoad_Include_Group" groupRelation="or">
		<ImageLoad onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</ImageLoad>
	</RuleGroup>

	<!--SYSMON EVENT ID 8 : REMOTE THREAD CREATED [CreateRemoteThread]-->
	<!--DATA: UtcTime, SourceProcessGuid, SourceProcessId, SourceImage, TargetProcessId, TargetImage, NewThreadId, StartAddress, StartModule, StartFunction-->
	<RuleGroup name="CreateRemoteThread_Include_Group" groupRelation="or">
		<CreateRemoteThread onmatch="include">
			<Rule name="T1003,OS_Credential_Dumping,Credential_Dumping_from_lsass" groupRelation="and">
				<StartAddress condition="is">0x001A0000</StartAddress>
				<TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
			</Rule>
			<Rule name="T1003,OS_Credential_Dumping,Rundll32_LSASS_Credential_dumping" groupRelation="and">
				<TargetImage condition="image">c:\windows\system32\lsass.exe</TargetImage>
				<SourceImage condition="image">c:\windows\system32\rundll32.exe</SourceImage>
			</Rule>
			<Rule name="T1546.012,Image_File_Execution_Options_Injection,Remote_Thread_Process_debugging_detected" groupRelation="and">
				<StartFunction condition="contains">DbgUiRemoteBreakin</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="T1546.012,Image_File_Execution_Options_Injection,Remote_Query_Debug_info" groupRelation="and">
				<StartFunction condition="contains">QueryProcessDebugInformationRemote</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="T1546.012,Image_File_Execution_Options_Injection,Remote_Query_Debug_info_2" groupRelation="and">
				<StartFunction condition="contains">isdebuggerpresent</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="T1546.012,Process_Debugging_Detected,Process_Debug_of_active_Process" groupRelation="and">
				<StartFunction condition="contains">DebugActiveProcess</StartFunction>
				<TargetImage condition="excludes">nacl64.exe</TargetImage>
			</Rule>
			<Rule name="T1115,Clipboard_Data,Clipboard_Usage_Detected" groupRelation="and">
				<SourceImage condition="image">c:\windows\system32\csrss.exe</SourceImage>
				<StartFunction condition="contains">CrtlRoutine</StartFunction>
			</Rule>
			<Rule name="Potentially_Detect_EtwEventWrite_Tampering_with_remote_threads" groupRelation="and">
				<StartModule condition="is">C:\WINDOWS\SYSTEM32\ntdll.dll</StartModule>
				<StartFunction condition="contains">EtwEventWrite</StartFunction>
			</Rule>
			<TargetImage name="Remote_Thread_Injection_Targetting_Web_Browser" condition="contains any">chrome.exe;firefox.exe;edge.exe;browser_broker.exe;iexplore.exe;opera.exe</TargetImage>
			<SourceImage name="CreateRemoteThread_with_msiexec" condition="contains any">msiexec.exe</SourceImage>
			<StartFunction name="CreateFileMapping" condition="contains any">CreateFileMapping;MapViewOfFile</StartFunction>
			<StartFunction name="LdrLoadDll_DLL_Injection" condition="contains any">LdrLoadDll</StartFunction>
			<StartFunction name="Crypt_API_Usage" condition="contains any">CryptAcquireContextA;CryptDecodeObjectEx;CryptImportPublicKeyInfo;CryptEncrypt;CryptGenKey;CryptDecrypt;CryptStringToBinary;CryptBinaryToString;CryptImportKey</StartFunction>
			<StartAddress name="T1055,Process_Injection,Cobalt_Strike_Detected" condition="end with">0B80</StartAddress>
			<StartAddress name="T1055,Process_Injection,Cobalt_Strike_Detected" condition="end with">0C7C</StartAddress>
			<StartAddress name="T1055,Process_Injection,Cobalt_Strike_Detected" condition="end with">0C88</StartAddress>
			<TargetImage name="T1055,Process_Injection,Remote_Desktop_injection" condition="image">c:\windows\system32\mstsc.exe</TargetImage>
			<SourceImage name="T1055,Process_Injection" condition="begin with">C:\</SourceImage>
			<SourceImage name="T1055,Process_Injection" condition="begin with">\\</SourceImage>
		</CreateRemoteThread>
	</RuleGroup>
	
	<RuleGroup name="CreateRemoteThread_Exclude_Group" groupRelation="or">
		<CreateRemoteThread onmatch="exclude">
			<!--COMMENT: Exclude mostly-safe sources and log anything else.-->
			<SourceImage condition="image">C:\Windows\system32\wbem\WmiPrvSE.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\SysWOW64\wbem\WmiPrvSE.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\svchost.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\wininit.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\csrss.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\services.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\winlogon.exe</SourceImage>
			<SourceImage condition="image">C:\Windows\system32\audiodg.exe</SourceImage>
			<StartModule condition="image">C:\Windows\system32\kernel32.dll</StartModule>
			<TargetImage condition="end with">Google\Chrome\Application\chrome.exe</TargetImage>
			<Rule groupRelation="and">
				<SourceImage condition="image">C:\Windows\System32\dwm.exe</SourceImage>
				<TargetImage condition="image">C:\Windows\System32\csrss.exe</TargetImage>
			</Rule>
		</CreateRemoteThread>
	</RuleGroup>

	<!--SYSMON EVENT ID 9 : RAW DISK ACCESS [RawAccessRead]-->
	<!--COMMENT:	Can cause high system load, disabled by default.-->
	<!--COMMENT:	You will likely want to set this to a full capture on domain controllers, where no process should be doing raw reads.-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, Device-->
	<RuleGroup name="RawAccessRead_Include_Group" groupRelation="or">
		<RawAccessRead onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</RawAccessRead>
	</RuleGroup>

	<!--SYSMON EVENT ID 10 : INTER-PROCESS ACCESS [ProcessAccess]-->
	<!--COMMENT:	Can cause high system load, disabled by default.-->
	<!--DATA: UtcTime, SourceProcessGuid, SourceProcessId, SourceThreadId, SourceImage, TargetProcessGuid, TargetProcessId, TargetImage, GrantedAccess, CallTrace-->
	<RuleGroup name="ProcessAccess_Include_Group" groupRelation="or">
		<ProcessAccess onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</ProcessAccess>
	</RuleGroup>

	<!--SYSMON EVENT ID 11 : FILE CREATED [FileCreate]-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime-->
	<RuleGroup name="FileCreate_Include_Group" groupRelation="or">
		<FileCreate onmatch="include">
			<!--Supply Chain Compromise-->
			<Rule name="T1195,Supply_Chain_Compromise,Solarwinds_sunburst_suspicious_file_writes" groupRelation="and">
				<Image condition="contains any">solarwinds.businesslayerhost</Image>
				<TargetFilename condition="contains any">.exe;.dll;.ps1;.mz;.jpg;.png</TargetFilename>
			</Rule>
			<Rule name="T1195,Supply_Chain_Compromise,Solarwinds_sunburst_malware_dll" groupRelation="and">
				<TargetFilename condition="is">C:\WINDOWS\SysWOW64\netsetupsvc.dll</TargetFilename>
			</Rule>
			<Rule name="T1195,Supply_Chain_Compromise,Dark_Halo_Software_location" groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\SoftwareDistribution</TargetFilename>
				<TargetFilename condition="is not">C:\Windows\SoftwareDistribution\Download\Install\AM_Delta.exe</TargetFilename>
				<TargetFilename condition="end with">.exe</TargetFilename>
			</Rule>
			<Rule name="T1195,Supply_Chain_Compromise,MSBuild_Source_Files_created" groupRelation="or">
				<TargetFilename condition="end with">proj</TargetFilename>
				<TargetFilename condition="end with">.targets</TargetFilename>
				<TargetFilename condition="end with">.build</TargetFilename>
				<TargetFilename condition="end with">.props</TargetFilename>
				<TargetFilename condition="end with">.tasks</TargetFilename>
				<TargetFilename condition="end with">.sln</TargetFilename>
				<TargetFilename condition="end with">.cs</TargetFilename>
			</Rule>
			<!--Exploitation for Client Execution-->
			<Rule name="T1203,Exploitation_for_Client_Execution,CVE-2019-1315" groupRelation="and">
				<TargetFilename condition="end with">Report.wer.tmp</TargetFilename>
				<TargetFilename condition="excludes">\WER\</TargetFilename>
				<Image condition="image">C:\Windows\system32\wermgr.exe</Image>
			</Rule>
			<Rule name="T1203,Exploitation_for_Client_Execution,Office_App_Creating_Exe_File" groupRelation="and">
				<Image condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</Image>
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="begin with">C:\Users</TargetFilename>
			</Rule>
			<Rule name="T1203,Exploitation_for_Client_Execution,Office_App_Creating_DLL_File" groupRelation="and">
				<Image condition="contains any">winword.exe;excel.exe;powerpnt.exe;outlook.exe;msaccess.exe;mspub.exe;visio.exe;notepad.exe;wordpad.exe;eqnedt32.exe;wordview.exe</Image>
				<TargetFilename condition="end with">.dll</TargetFilename>
				<TargetFilename condition="begin with">C:\Users</TargetFilename>
			</Rule>
			<!--Exploitation for Privilege Escalation-->
			<Rule name="T1068,Exploitation_for_Privilege_Escalation,Printer_Exploitation_Detected" groupRelation="and">
				<TargetFilename condition="end with">.SPL</TargetFilename>
				<Image condition="excludes any">spoolsv.exe;printfilterpipelinesvc.exe;printisolationhost.exe;splwow64.exe;msiexec.exe;poqexec.exe</Image>
			</Rule>
			<Rule name="T1068,Exploitation_for_Privilege_Escalation,Printer_Spooler_Created_exe_file" groupRelation="and">
				<Image condition="image">spoolsv.exe</Image>
				<TargetFilename condition="end with">.exe</TargetFilename>
				<TargetFilename condition="excludes">C\:\Windows\System32\spool\;C\:\Windows\Temp\;C\:\Users\</TargetFilename>
			</Rule>
			<Rule name="T1068,Exploitation_for_Privilege_Escalation,InstallerFileTakeOver_CVE-2021-41379" groupRelation="and">
				<Image condition="image">msiexec.exe</Image>
				<TargetFilename condition="contains">\Microsoft\Edge\Application</TargetFilename>
				<TargetFilename condition="end with">elevation_service.exe</TargetFilename>
			</Rule>
			<!--Exploitation of Remote Services-->
			<Rule name="T1203,Exploitation_of_Remote_Services,Exchange_Exploitation_UM_Service_File_Creation_CVE-2021-26858" groupRelation="and">
				<Image condition="contains any">UMWorkerProcess.exe;UMService.exe</Image>
				<TargetFilename condition="contains any">.</TargetFilename>
				<TargetFilename condition="excludes any">.log;.cfg;.txt;cleanup;.HealthCheck;\wp.active;.db</TargetFilename>
			</Rule>
			<!--Data Encoding-->
			<Rule name="T1132,Data_Encoding,Cyrillic_Letter_obfuscation" groupRelation="and">
				<TargetFilename condition="contains any">Г;И;К;П;д;и;к;л;л;н;н;о;ф;ե;թ;յ;ն;ն;ն;ն;տ;ւ;ք</TargetFilename>
			</Rule>
			<!-- Side Loading -->
			<Rule name="Sideload_Detection" groupRelation="or">
				<TargetFilename condition="end with">.hlp</TargetFilename>
				<TargetFilename condition="end with">ACLUI.DLL.UI</TargetFilename>
				<TargetFilename condition="end with">ACLUI.DLL</TargetFilename>
				<TargetFilename condition="end with">AFLogVw.exe</TargetFilename>
				<TargetFilename condition="end with">AShld.exe</TargetFilename>
				<TargetFilename condition="end with">AShldRes.DLL.asr</TargetFilename>
				<TargetFilename condition="end with">AShldRes.DLL</TargetFilename>
				<TargetFilename condition="end with">AhnI2.dll</TargetFilename>
				<TargetFilename condition="end with">CamMute.exe</TargetFilename>
				<TargetFilename condition="end with">CommFunc.dll</TargetFilename>
				<TargetFilename condition="end with">CommFunc.jax</TargetFilename>
				<TargetFilename condition="end with">DESqmWrapper.dll</TargetFilename>
				<TargetFilename condition="end with">DESqmWrapper.wrapper</TargetFilename>
				<TargetFilename condition="end with">FSPMAPI.dll.fsp</TargetFilename>
				<TargetFilename condition="end with">FSPMAPI.dll</TargetFilename>
				<TargetFilename condition="end with">Gadget.exe</TargetFilename>
				<TargetFilename condition="end with">LoLTWLauncher.exe</TargetFilename>
				<TargetFilename condition="end with">Mc.exe</TargetFilename>
				<TargetFilename condition="end with">McUtil.dll.ping</TargetFilename>
				<TargetFilename condition="end with">McUtil.dll.url</TargetFilename>
				<TargetFilename condition="end with">McUtil.dll</TargetFilename>
				<TargetFilename condition="end with">MpSvc.dll</TargetFilename>
				<TargetFilename condition="end with">MsMpEng.exe</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dat</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dat</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dll</TargetFilename>
				<TargetFilename condition="end with">NtUserEx.dll</TargetFilename>
				<TargetFilename condition="end with">NvSmart.exe</TargetFilename>
				<TargetFilename condition="end with">NvSmartMax.dll</TargetFilename>
				<TargetFilename condition="end with">NvSmartMax.dll</TargetFilename>
				<TargetFilename condition="end with">NvSmartMaxapp.dll</TargetFilename>
				<TargetFilename condition="end with">OInfo11.ISO</TargetFilename>
				<TargetFilename condition="end with">OInfo11.ocx</TargetFilename>
				<TargetFilename condition="end with">OInfoP11.exe</TargetFilename>
				<TargetFilename condition="end with">OleView.exe</TargetFilename>
				<TargetFilename condition="end with">OleView.exe</TargetFilename>
				<TargetFilename condition="end with">POETWLauncher.exe</TargetFilename>
				<TargetFilename condition="end with">RasTls.dll.config</TargetFilename>
				<TargetFilename condition="end with">RasTls.dll.msc</TargetFilename>
				<TargetFilename condition="end with">RasTls.dll</TargetFilename>
				<TargetFilename condition="end with">RasTls.exe</TargetFilename>
				<TargetFilename condition="end with">RunHelp.exe</TargetFilename>
				<TargetFilename condition="end with">Sidebar.dll.doc</TargetFilename>
				<TargetFilename condition="end with">Sidebar.dll</TargetFilename>
				<TargetFilename condition="end with">Ushata.dll</TargetFilename>
				<TargetFilename condition="end with">Ushata.exe</TargetFilename>
				<TargetFilename condition="end with">Ushata.fox</TargetFilename>
				<TargetFilename condition="end with">VeetlePlayer.exe</TargetFilename>
				<TargetFilename condition="end with">boot.ldr</TargetFilename>
				<TargetFilename condition="end with">chrome_frame_helper.dll.rom</TargetFilename>
				<TargetFilename condition="end with">chrome_frame_helper.dll</TargetFilename>
				<TargetFilename condition="end with">chrome_frame_helper.exe</TargetFilename>
				<TargetFilename condition="end with">dvcemumanager.exe</TargetFilename>
				<TargetFilename condition="end with">fsguidll.exe</TargetFilename>
				<TargetFilename condition="end with">fslapi.dll.gui</TargetFilename>
				<TargetFilename condition="end with">fslapi.dll</TargetFilename>
				<TargetFilename condition="end with">fsstm.exe</TargetFilename>
				<TargetFilename condition="end with">hccutils.dll.res</TargetFilename>
				<TargetFilename condition="end with">hccutils.dll</TargetFilename>
				<TargetFilename condition="end with">hha.dll.bak</TargetFilename>
				<TargetFilename condition="end with">hha.dll</TargetFilename>
				<TargetFilename condition="end with">hhc.exe</TargetFilename>
				<TargetFilename condition="end with">hkcmd.exe</TargetFilename>
				<TargetFilename condition="end with">iviewers.dll</TargetFilename>
				<TargetFilename condition="end with">jli.dll</TargetFilename>
				<TargetFilename condition="end with">libvlc.dll</TargetFilename>
				<TargetFilename condition="end with">mPclient.dll</TargetFilename>
				<TargetFilename condition="end with">mcf.ep</TargetFilename>
				<TargetFilename condition="end with">mcf.exe</TargetFilename>
				<TargetFilename condition="end with">mcupdui.exe</TargetFilename>
				<TargetFilename condition="end with">mcut.exe</TargetFilename>
				<TargetFilename condition="end with">mcutil.dll.bbc</TargetFilename>
				<TargetFilename condition="end with">mcvsmap.exe</TargetFilename>
				<TargetFilename condition="end with">msi.dll.dat</TargetFilename>
				<TargetFilename condition="end with">msi.dll</TargetFilename>
				<TargetFilename condition="end with">msseces.asm</TargetFilename>
				<TargetFilename condition="end with">msseces.exe</TargetFilename>
				<TargetFilename condition="end with">mtcReport.ktc</TargetFilename>
				<TargetFilename condition="end with">rc.dll</TargetFilename>
				<TargetFilename condition="end with">rc.exe</TargetFilename>
				<TargetFilename condition="end with">rc.hlp</TargetFilename>
				<TargetFilename condition="end with">sep_NE.exe</TargetFilename>
				<TargetFilename condition="end with">sep_NE.slf</TargetFilename>
				<TargetFilename condition="end with">tplcdclr.exe</TargetFilename>
				<TargetFilename condition="end with">winmm.dll</TargetFilename>
				<TargetFilename condition="end with">wts.chm</TargetFilename>
				<TargetFilename condition="end with">credwiz.exe</TargetFilename>
			</Rule>
			<TargetFilename name="T1574.002,Hijack_Execution_Flow,Finfisher_DLL_Sideload_Detection" condition="end with">aepic.dll</TargetFilename>
			<TargetFilename name="T1574.002,Hijack_Execution_Flow,Finfisher_DLL_Sideload_Detection" condition="end with">ftllib.dll</TargetFilename>
			<TargetFilename name="T1574.002,Hijack_Execution_Flow,Finfisher_DLL_Sideload_Detection" condition="end with">userenv.dll</TargetFilename>
			<!--User Execution: Malicious File-->
			<Rule name="T1204.002,Malicious_File,Generic_Ransomware_Detection" groupRelation="and">
				<TargetFilename condition="contains any">!!!-WARNING-!!!.html;!!!-WARNING-!!!.txt;!!! HOW TO DECRYPT FILES !!!;!!!README!!!;!!!READ_TO_UNLOCK!!!.TXT;!!!_READ_ME_;!Recovery_;!Where_are_my_files!.html;!_HOW_TO_RESTORE_;!_RECOVERY_HELP_!.txt;!recover!;# DECRYPT MY FILES #.html;# DECRYPT MY FILES #.txt;# DECRYPT MY FILES #.vbs;# SATAN CRYPTOR #;+recover+;.8lock8;.31392E30362E32303136_;.ABCDEF;.CIop;.CR1;.CRAB;.CRYPTOSHIELD;.Cl0p;.Contact_Here_To_Recover_Your_Files.txt;.CryptoTorLocker2015!;.HERMES;.HakunaMatata;.How_To_Decrypt.txt;.How_To_Get_Back.txt;.KEYZ.KEYH0LES;.L0CKED;.LOL!;.MATRIX;.OMG!;.R.i.P;.RMCM1;.RSplited;.SUPERCRYPT;.SecureCrypted;.TheTrumpLocker;.VBRANSOM;.VforVendetta;.Where_my_files.txt;.XBTL;._AiraCropEncrypted!;.airacropencrypted!;.areyoulovemyrans;.berkshire;.bitpy;.bitx;.blocatto;.bomber;.braincrypt;.breakingbad;.breeding123;.cerber;.cifgksaffsfyghd;.country82000;.crypt;.crypted;.crypton;.cryptotorlocker;.decrypt2017;.deria;.dglnl;.disposed2017;.doomed;.encrypted.locked;.encrypted;.encryptedyourfiles;.enjey;.evillock;.filegofprencrp;.fileiscryptedhard;.firecrypt;.fuckyourdata;.gangbang;.gefickt;.googl;.happydayzz;.hceem;.helpdecrypt;.helpmeencedfiles;.hnumkhotep;.hydracrypt_ID;.iaufkakfhsaraf;.info.txt;.jimm;.kharma;.killedXXX;.lambda_l0cked;.letmetrydecfiles;.locked;.locker16;.loveransisgood;.lovewindows;.magic_software_syndicate;.mention9823;.moments2900;.myrandsext2017;.newlock;.no_more_ransom;.nochance;.noproblemwedecfiles;.notfoundrans;.ohwqg;.one-we_can-help_you;.oops;.osiris;.otherinformation;.paytounlock;.powerfulldecrypt;.powned;.pr0lock;.prolock;.prosperous666;.pwnd;.ransom;.readme2unlock;.righ;.roger;.ryk;.satan;.savethequeen;.sigaint.org;.skjdthghh;.skynet;.snatch;.stubbin;.supported2017;.suppose666;.theworldisyours;.txd0t;.warn_wallet;.weapologize;.weareyourfriends;.weencedufiles;.wowreadfordecryp;.wowwhereismyfiles;.wvtr0;.yourransom;.zzzzz ;.{CRYPTENDBLACKDC};-DECRYPT.txt;000-IF-YOU-WANT-DEC-FILES;000-No-PROBLEM-WE-DEC-FILES;000-PLEASE-READ-WE-HELP;001-READ-FOR-DECRYPT-FILES;1025-7152.exe;:\windows\update_collector.exe;=READ=THIS=PLEASE=;@cock.li;@countermail.com;@firemail.cc;@india.com;@mail.ru;@ukr.net;ASSISTANCE_IN_RECOVERY;ATTENTION!!!.txt;ATTENTION.url;Aescrypt.exe;AllFilesAreLocked;BTC_DECRYPT_FILES;BUYUNLOCKCODE.txt;BUYUNLOCKCODE;BitCryptorFileList.txt;C:\ProgramData\dtb.dat;C:\Programdata\WinMgr;C:\Programdata\clean.bat;C:\Programdata\run.bat;C:\Windows\svchost.exe;CEBER3;CHECK-IT-HELP-FILES;COME_RIPRISTINARE_I_FILE.;COMO_ABRIR_ARQUIVOS.txt;COMO_RESTAURAR_ARCHIVOS;Coin.Locker.txt;Comment débloquer mes fichiers.txt;Como descriptografar seus arquivos.txt;Corona-virus-Map;Corona.bat;Corona.sfx;CryptoRansomware;Crytp0l0cker;Cyber SpLiTTer Vbs.exe;Cyborg_DECRYPT;DALE_FILES.TXT;DECRYPT-FILES;DECRYPTION INSTRUCTIONS.;DECRYPTION_HOWTO.Notepad;DECRYPT_INFORMATION;DECRYPT_INSTRUCTION.HTML;DECRYPT_INSTRUCTION.URL;DECRYPT_INSTRUCTIONS.html;DECRYPT_INSTRUCTIONS;DECRYPT_ReadMe1.TXT;DECRYPT_Readme.TXT.ReadMe;DECRYPT_YOUR_FILES;DESIFROVANI_POKYNY.html;Decrypt All Files;DecryptAllFiles;DecryptFile;Decrypt_readme.txt;DesktopOsiris;ENTSCHLUSSELN_HINWEISE.html;EdgeLocker;FILESAREGONE.txt;FILES_BACK.txt;File Decrypt Help.html;GJENOPPRETTING_AV_FILER;GetYouFiles.txt;HAPPEN-ENCED-FILES;HELLOTHERE.TXT;HELP-ME-ENCED-FILES;HELPDECRYPT_YOUR_FILES.HTML;HELP_DECRYPT.HTML;HELP_DECRYPT.PNG;HELP_DECRYPT.URL;HELP_DECRYPT.lnk;HELP_ME_PLEASE.txt;HELP_RESTORE_FILES_;HELP_TO_SAVE_FILES.bmp;HELP_TO_SAVE_FILES;HELP_YOURFILES.HTML;HELP_YOUR_FILES.PNG;HELP_YOUR_FILES.html;HELP_YOUR_FILES;HOW-TO-DECRYPT-FILES.HTML;HOW-TO-RESTORE-FILES;HOW TO BACK YOUR FILES;HOW TO DECRYPT FILES.HTML;HOW TO DECRYPT FILES.txt;HOW TO RECOVER;HOWTO_RECOVER_FILES_;HOWTO_RESTORE_FILES;HOWTO_RESTORE_FILES_;HOW_DECRYPT.HTML;HOW_DECRYPT.TXT;HOW_DECRYPT.URL;HOW_OPEN_FILES;HOW_TO_DECRYPT.HTML;HOW_TO_DECRYPT_;HOW_TO_PAY_THE_RANSOM;HOW_TO_RESTORE_FILES.html;HOW_TO_RESTORE_FILES;HOW_TO_RESTORE_YOUR_DATA;HOW_TO_UNLOCK_FILES_README_;HWID Lock.exe;Hacked_Read_me_to_decrypt_files.html;Help Decrypt.html;How decrypt files.hta;How to decrypt LeChiffre files.html;How to decrypt your data.txt;HowDecrypt.gif;HowDecrypt.txt;How_to_decrypt_your_files.jpg;How_to_restore_files.hta;HowtoRestore_File;HowtoRestore_Files;Howto_RESTORE_FILES.html;Howto_Restore_FILES.TXT;IAMREADYTOPAY.TXT;IF-YOU-WANT-DEC-FILES;IF_WANT_FILES_BACK_PLS_READ.html;IHAVEYOURSECRET.KEY;IMPORTANT READ ME.txt;IMPORTANT.README;INSTALL_TOR.URL;INSTRUCCIONES;INSTRUCCIONES_DESCIFRADO.html;INSTRUCTION RESTORE FILE;INSTRUCTIONS_DE_DECRYPTAGE.html;INSTUCCIONES_DESCRIFRADO;ISTRUZIONI_DECRITTAZIONE.html;Important!.txt;Instructionaga.txt;KryptoLocker_README.txt;LEER_INMEDIATAMENTE;LET-ME-TRY-DEC-FILES;Locked-by-Mafia;MENSAGEM.txt;MERRY_I_LOVE_YOU_BRUCE.hta;No-PROBLEM-WE-DEC-FILES;OKSOWATHAPPENDTOYOURFILES.TXT;ONTSLEUTELINGS_INSTRUCTIES.html;OSIRIS-;PAYLOADBIN;PINGY@INDIA.COM;PLEASE-READ-WE-HELP.;PLEASE-READIT-IF_YOU-WANT.html;PLEASE-READIT-IF_YOU-WANT;PLEASE-README-AFFECTED-FILES;PLS-DEC-MY-FILES;PURELOCKER;Payment_Instructions.jpg;Please Read Me!!!;READ-FOR-DECCCC-FILESSS;READ-FOR-DECRYPT-FILES;READ-READ-READ;READ IF YOU WANT YOUR FILES BACK.html;READ ME FOR DECRYPT.txt;README HOW TO DECRYPT YOUR FILES.HTML;README!!!;README_DECRYPT_HYDRA_ID_;README_DECRYPT_HYRDA_ID_;README_DECRYPT_UMBRE_ID_;README_DONT_DELETE;README_HOW_TO_UNLOCK.HTML;README_HOW_TO_UNLOCK.TXT;README_RECOVER_FILES_;README_TO_RECURE_YOUR_FILES;READTHISNOW!!!.txt;READ_IT.txt;READ_ME_!.txt;READ_ME_TO_DECRYPT_YOU_INFORMA;READ_THIS_TO_DECRYPT.html;RECOVER-FILES;RECOVERY_FILE.;RECOVERY_FILES.TXT;RECOVER_MY_FILE;RESTORE_CORUPTED_FILES;RESTORE_FILES_;RETURN FILES.txt;RETURN YOUR FILES;RETURNFILES_.txt;RETURN_FILES.txt;RETURN_FILES_.txt;Rans0m_N0te_Read_ME;Read Me (How Decrypt) !!!!.txt;ReadDecryptFilesHere;Read_this_file.txt;Receipt.exe;RecoveryManual.html;Recovery_File_;Recovery_file_;Rooster865qq;SECRET.KEY;SECRETIDHERE.KEY;SHTODELATVAM.txt;SIFRE_COZME_TALIMATI.html;SORRY-FOR-FILES;Survey Locker.exe;TRY-READ-ME-TO-DEC;Temp\satan\satan;ThxForYurTyme;UNLOCK_FILES_INSTRUCTIONS.html;UNLOCK_FILES_INSTRUCTIONS.txt;UnblockFiles.vbs;VIP72.exe;Vape Launcher.exe;WANT_FILES_BACK;WE-MUST-DEC-FILES;WHERE-YOUR-FILES;WORMKILLER@INDIA.COM.XTBL;What happen to my files.txt;Whereisyourfiles;WindowsApplication1.exe;YOUGOTHACKED.TXT;YOUR_FILES.txt;YOUR_FILES.url;YOUR_FILES_ARE_DEAD;YOUR_FILES_ARE_ENCRYPTED.HTML;YOUR_FILES_ARE_ENCRYPTED.TXT;YOUR_FILES_ARE_LOCKED.txt;Your files are locked !!!!.txt;Your files are locked !!!.txt;Your files are locked !!.txt;Your files are locked !.txt;Your files encrypted by our friends !!! txt;Your files encrypted by our friends !!!.txt;[KASISKI];_Adatok_visszaallitasahoz_utasitasok;_DECRYPT_ASSISTANCE_;_DECRYPT_INFO_;_DECRYPT_INFO_szesnl;_DEC_FILES.;_FILES_WERE_ENCRYPTED_@.TXT;_HELP_HELP_HELP_;_HELP_Recover_Files_;_HELP_instructions.bmp;_HELP_instructions.txt;_HOWDO_text.bmp;_HOWDO_text.html;_HOW_TO_Decrypt;_H_e_l_p_RECOVER_INSTRUCTIONS+;_H_e_l_p_RECOVER_INSTRUCTIONS;_Locky_recover;_Locky_recover_instructions.bmp;_Locky_recover_instructions.txt;_README.hta;_README.jpg;_READ_ME!;_RECOVER_INSTRUCTIONS;_ReCoVeRy_+;_USE_TO_FIX_;_WHAT_is.html;_help_instruct;_how_recover.txt;_how_recover;_how_recover_;_recover_;_secret_code.txt;_steaveiwalker@india.com_;aeroware;confirmation.key;contains(to_string($message.file_created), "howrecover+;crjoker.html;cryptinfo.txt;cryptolocker.;cryptopp;de_crypt_readme.;de_crypt_readme.bmp;de_crypt_readme.html;de_crypt_readme.txt;decipher_ne;decrypt-instruct;decrypt explanations.;decrypt my file;decrypt your file;decrypt_Globe;decrypt_instruct;decrypted_files.dat;decryptional;decryptmyfiles;decypt_your_files.html;default32643264.bmp;default432643264.jpg;email-salazar_slytherin10;enc_files.txt;encryptor_raas_readme_liesmich;enigma.hta;enigma_encr.txt;exit.hhr.obleep;fattura_;file0locked;files_are_encrypted.;-filesencrypted;firemail.cc;firstransomware.exe;gmx.de;hacks.at.sigaint.org;help-file-decrypt.enc;help_decrypt;help_file_;help_instructions.;help_my_files;help_recover;help_recover_instructions;help_restore;help_restore_files;help_your_file;helpmeencedfiles;how to decrypt aes files.lnk;how to decrypt;how to get data.txt;how_decrypt.gif;how_recover;how_to_decrypt;how_to_recover;howrecover+ recoveryfile_;howrecover+;howto_recover_file;howto_restore;howtodecrypt;howtodecryptaesfiles.txt;inbox.ru;info@kraken.cc_worldcza@email.cz;install_tor;iran.ir;last_chance.txt;maestro@pizzacrypts.info;maxcrypt.bmp;only-we_can-help_you;openforyou@india.com;opensourcemail.org;padcrypt;paycrypt.bmp;popcorn_time.exe;powerfulldecrypt;protonmail.ch;qbmail.biz;randomname;readme_decrypt;readme_for_decrypt;readme_liesmich_encryptor_raas;recover_file;recover_file_;recover_instruction;recoverfile;recoverfile_;recovery+;recovery_file.txt;recovery_key.txt;recoveryfile;recover}-;restore_files.txt;restorefiles;restorefiles_;ryukreadme.html;tuta.io;tutanota.com;tutanota.de;unCrypte;vault.hta;vault.key;vault.txt;want your files back.;warning-!!;wie_zum_Wiederherstellen_von_Dateien.txt;wowreadfordecryp;wowwhereismyfiles;zXz.html;zycrypt.;zzzzzzzzzzzzzzzzzyyy</TargetFilename>
				<TargetFilename condition="excludes all">C:\Users\;\Google\Chrome Beta\User Data\;\IndexedDB\</TargetFilename>
				<TargetFilename condition="excludes any">C:\Program Files\WindowsApps\Microsoft.YourPhone_;C:\Program Files\dotnet\shared\Microsoft.NETCore.App\;\Microsoft.NET\assembly\GAC_MSIL</TargetFilename>
			</Rule>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="contains">crackmapexec</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\Crypto.Cipher._AES.pyd</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\Crypto.Cipher._DES.pyd</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\Crypto.Hash._SHA256.pyd</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\Crypto.Random.OSRNG.winrandom.pyd</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\Crypto.Util.strxor.pyd</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\crackmapexec.exe.manifest</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Common_Files_of_CrackMapExec" condition="end with">\greenlet.pyd</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,KeeFarce.exe_default_injected_DLL_name" condition="end with">BootStrapDLL.dll</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,MegaCortex_Ransomware" condition="begin with">C:\windows\temp\wininit.exe</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,Mimikatz_Files" condition="contains any">lazycat;powerkatz;mimikatz;mimidrv;mimilove;mimilib;mimikittenz;mimiauth;invoke-mimi</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,RDP_Wrapper" condition="end with">rdpwrap.dll</TargetFilename>
			<TargetFilename name="T1204.002,Malicious_File,winspool.drv_dropped" condition="end with">winspool.drv</TargetFilename>
			<!--Data Encrypted for Impact-->
			<Rule name="T1486,Data_Encrypted_for_Impact,Snatch_Ransomware_Detected" groupRelation="and">
				<TargetFilename condition="contains all">RESTORE_;_FILES.txt</TargetFilename>
			</Rule>
			<Rule name="T1486,Data_Encrypted_for_Impact,Snatch_Ransomware_Detected" groupRelation="and">
				<TargetFilename condition="contains all">DECRYPT_;_FILES.txt</TargetFilename>
			</Rule>
			<Rule name="T1486,Data_Encrypted_for_Impact,Nanocore_Detected" groupRelation="and">
				<TargetFilename condition="contains any">\run.dat;\task.dat;\storage.dat</TargetFilename>
				<TargetFilename condition="contains">AppData</TargetFilename>
				<TargetFilename condition="excludes any">Symantec</TargetFilename>
				<TargetFilename condition="excludes any">BlueJeans</TargetFilename>
			</Rule>
			<Rule name="T1486,Data_Encrypted_for_Impact,RagnarLocker_Virtualbox_files" groupRelation="and">
				<TargetFilename condition="contains any">VBoxRT.dll;VboxC.dll</TargetFilename>
			</Rule>
			<!--Proxy: Multi-hop Proxy-->
			<TargetFilename name="T1090.003,Multi-hop_Proxy,Potential_Tor_Hidden_Service" condition="contains">HiddenService</TargetFilename>
			<TargetFilename name="T1090.003,Multi-hop_Proxy,Potential_Tor_File" condition="end with">torrc</TargetFilename>
			<TargetFilename name="T1090.003,Multi-hop_Proxy,Potential_Tor_File" condition="contains">\tor.exe</TargetFilename>
			<TargetFilename name="T1090.003,Multi-hop_Proxy,Potential_Tor_File" condition="contains">tor-gencert</TargetFilename>
			<!--Transfer Data to Cloud Account-->
			<TargetFilename name="T1114,Email_Collection,Possible_rclone_Exfiltration" condition="contains">rclone</TargetFilename>
			<TargetFilename name="T1114,Email_Collection,Possible_s3browser_Exfiltration" condition="contains">s3browser</TargetFilename>
			<TargetFilename name="T1114,Email_Collection,Browser_Credential_Exfiltration" condition="contains">grabff.exe</TargetFilename>
			<TargetFilename name="T1114,Email_Collection,Browser_Credential_Exfiltration" condition="contains">grabff.exe</TargetFilename>
			<!--Indirect Command Execution-->
			<TargetFilename name="WSL_Locations" condition="contains">\LocalState\rootfs\</TargetFilename>
			<!--Windows Management Instrumentation-->
			<TargetFilename name="T1047,WMI" condition="begin with">C:\Windows\System32\Wbem</TargetFilename>
			<TargetFilename name="T1047,WMI" condition="begin with">C:\Windows\SysWOW64\Wbem</TargetFilename>
			<Image name="T1047,WMI" condition="begin with">C:\WINDOWS\system32\wbem\scrcons.exe</Image>
			<!--Windows application compatibility-->
			<TargetFilename name="T1546.011,Application_Shimming" condition="contains">C:\Windows\AppPatch\Custom</TargetFilename>
			<TargetFilename name="Windows_UAC_virtualization" condition="contains">VirtualStore</TargetFilename>
			<!--Office Application Startup-->
			<TargetFilename name="T1137,Office_Application_Startup" condition="contains">\Word\STARTUP\</TargetFilename>
			<TargetFilename name="T1137,Office_Application_Startup" condition="contains">\Excel\STARTUP\</TargetFilename>
			<TargetFilename name="T1137,Office_Application_Startup" condition="contains">\Excel\XLSTART\</TargetFilename>
			<!--Boot or Logon Autostart Execution-->
			<TargetFilename name="T1547.001,Registry_Startup_Folder,Autorun_Folder_Entries" condition="contains">\Startup\</TargetFilename>
			<!--Scheduled Task/Job-->
			<TargetFilename name="T1053,Scheduled_Task_Modified" condition="begin with">C:\Windows\Tasks\</TargetFilename>
			<TargetFilename name="T1053,Scheduled_Task_Modified" condition="begin with">C:\Windows\system32\Tasks</TargetFilename>
			<TargetFilename name="T1053,Scheduled_Task_Modified" condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
			<TargetFilename name="T1053,Scheduled_Task_Modified" condition="end with">.job</TargetFilename>
			<!--Server Software Component: Web Shells-->
			<Rule name="T1505.003,Server_Software_Component,Web_Shells_Dropped" groupRelation="and">
				<Image condition="contains any">w3wp.exe;httpd;java;nginx;tomcat</Image>
				<TargetFilename condition="contains any">.aspx;.asp;.ashx;.php;.jspx;.jsp</TargetFilename>
			</Rule>
			<Rule name="T1505.003,Server_Software_Component,Web_Shells_Dropped" groupRelation="and">
				<TargetFilename condition="contains any">\wwwroot\aspnet_client\;\FrontEnd\HttpProxy\owa\auth</TargetFilename>
				<TargetFilename condition="contains any">.aspx;.asp;.ashx;.php</TargetFilename>
			</Rule>
			<Rule name="T1505.003,Server_Software_Component,Exchange_0day_from_September_2022_overwriting_legit_file" groupRelation="and">
				<TargetFilename condition="end with">RedirSuiteServiceProxy.aspx</TargetFilename>
			</Rule>
			<Rule name="T1505.003,Server_Software_Component,Webserver_Dropping_Malicious_File" groupRelation="and">
				<Image condition="contains any">w3wp.exe;httpd.exe;java.exe;nginx.exe</Image>
				<TargetFilename condition="contains any">.ps1;.bat;.exe;.dll;.vbs;.hta</TargetFilename>
			</Rule>
			<TargetFilename name="Files_dropped_in_Exchange_ECP_directory" condition="contains">\ecp\auth\</TargetFilename>
			<TargetFilename name="Files_dropped_in_Exchange_OAB_directory" condition="contains">\oab\auth\</TargetFilename>
			<TargetFilename name="Files_dropped_in_Exchange_OWA_directory" condition="contains">ClientAccess\Owa\</TargetFilename>
			<TargetFilename name="Files_dropped_in_Exchange_OWA_directory" condition="contains">\owa\auth\</TargetFilename>
			<TargetFilename name="Files_dropped_in_Exchange_RPC_directory" condition="contains">httpproxy\rpc\</TargetFilename>
			<TargetFilename name="Files_dropped_in_Exchange_ecp_directory" condition="contains">ClientAccess\ecp\</TargetFilename>
			<TargetFilename name="Files_dropped_in_wwwroot_htdocs_directory" condition="contains">\htdocs\</TargetFilename>
			<Rule name="CVE-2021-40444" groupRelation="and">
				<Image condition="end with">\WINWORD.EXE</Image>
				<TargetFilename condition="contains any">.cab;.inf</TargetFilename>
			</Rule>
			<Rule name="Default_output_of_HiveNightmare_or_SeriousSAM_tools" groupRelation="or">
				<TargetFilename condition="contains">\SAM-20</TargetFilename>
				<TargetFilename condition="contains">\SAM-haxx</TargetFilename>
				<TargetFilename condition="contains">\Sam.save</TargetFilename>
				<TargetFilename condition="contains">\hive_sam_</TargetFilename>
				<TargetFilename condition="is">C:\windows\temp\sam</TargetFilename>
			</Rule>
			<!--Execution: Command and Scripting Interpreter-->
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,Batch_File_scripting_Batch_scripts" condition="end with">.bat</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,Batch_scripting_Legacy_btm_Extension" condition="end with">.btm</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,Batch_scripting_Legacy_cmd_Extension" condition="end with">.cmd</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,Batch_scripting_Legacy_com_Extension" condition="end with">.com</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,CMDLine_File_Created" condition="end with">.cmdline</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,Batch_File_Created" condition="end with">.bas</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,BIN_file_created" condition="end with">.bin</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,WS_Scripting" condition="end with">.ws</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,WSC_Scripting" condition="end with">.wsc</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,WSF_Scripting" condition="end with">.wsf</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,WSH_Scripting" condition="end with">.wsh</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,PIF_Scripting" condition="end with">.pif</TargetFilename>
			<TargetFilename name="T1059,Command_and_Scripting_Interpreter,MSHTA_Scripting" condition="end with">.hta</TargetFilename>
			<!--Execution: Command and Scripting Interpreter: Python-->
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Python" condition="contains">IronPython</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Python" condition="end with">.py</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Python" condition="end with">.pyc</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Python" condition="end with">.pyd</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Python" condition="end with">.pyw</TargetFilename>
			<!--Execution: Command and Scripting Interpreter: Suspicious ManagedCode Host Process-->
			<Rule name="T1059,Command_and_Scripting_Interpreter,Execution_Susp_ManagedCode_Host_Process" groupRelation="or">
				<TargetFilename condition="end with">\UsageLogs\cscript.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\mshta.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\msiexec.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\regsvr32.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\rundll32.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\svchost.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\wmic.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\wscript.exe.log</TargetFilename>
				<TargetFilename condition="end with">\regsvr32.exe.log</TargetFilename>
				<TargetFilename condition="end with">\UsageLogs\wsmprovhost.exe.log</TargetFilename>
			</Rule>
			<!--Execution: Command and Scripting Interpreter: PowerShell-->
			<Rule name="T1059.006,Command_and_Scripting_Interpreter,PowerShell" groupRelation="or">
				<TargetFilename condition="end with">.cdxml</TargetFilename>
				<TargetFilename condition="end with">.ps1</TargetFilename>
				<TargetFilename condition="end with">.ps2</TargetFilename>
				<TargetFilename condition="end with">.ps1xml</TargetFilename>
				<TargetFilename condition="end with">.psc1</TargetFilename>
				<TargetFilename condition="end with">.psd1</TargetFilename>
				<TargetFilename condition="end with">.psm1</TargetFilename>
				<TargetFilename condition="end with">.pssc</TargetFilename>
			</Rule>
			<Rule name="T1059.006,Command_and_Scripting_Interpreter,PowerShell_Creating_Files" groupRelation="and">
				<Image condition="contains any">powershell.exe;powershell_ise.exe</Image>
				<TargetFilename condition="excludes">\Recent\CustomDestinations\</TargetFilename>
			</Rule>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Powershell_directory_modifications" condition="begin with">C:\Windows\SysWOW64\WindowsPowerShell</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Powershell_directory_modifications" condition="begin with">C:\Windows\System32\WindowsPowerShell</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Execution_Susp_ManagedCode_Host_Process" condition="end with">\UsageLogs\powershell.exe.log</TargetFilename>
			<TargetFilename name="T1059.006,Command_and_Scripting_Interpreter,Powershell_Console_History" condition="end with">PSReadLine\ConsoleHost_history.txt</TargetFilename>
			<!--Execution: Command and Scripting Interpreter: Javascript-->
			<TargetFilename name="T1059.007,Command_and_Scripting_Interpreter,vbs_script_created" condition="end with">.vbs</TargetFilename>
			<TargetFilename name="T1059.007,Command_and_Scripting_Interpreter,Java_JRE_Timestamp_usage_for_DFIR" condition="contains">.oracle_jre_usage\</TargetFilename>
			<TargetFilename name="T1059.007,Command_and_Scripting_Interpreter,JavaScript" condition="end with">.js</TargetFilename>
			<TargetFilename name="T1059.007,Command_and_Scripting_Interpreter,JavaScript" condition="end with">.jse</TargetFilename>
			<TargetFilename name="T1059.005,Command_and_Scripting_Interpreter,VisualBasicScripting" condition="end with">.vb</TargetFilename>
			<TargetFilename name="T1059.005,Command_and_Scripting_Interpreter,VisualBasicScripting" condition="end with">.vbe</TargetFilename>
			<TargetFilename name="T1059.005,Command_and_Scripting_Interpreter,VisualBasicScripting" condition="end with">.vbsript</TargetFilename>
			<!--Microsoft Office File Monitoring-->
			<TargetFilename name="Excel_Macro" condition="end with">.xlam</TargetFilename>
			<TargetFilename name="Excel_Macro" condition="end with">.xlsm</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xla</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xll</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xls</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xlsb</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xlsx</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xlt</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xltm</TargetFilename>
			<TargetFilename name="Excel" condition="end with">.xlw</TargetFilename>
			<TargetFilename name="Office_Template_created" condition="contains">\Microsoft\Templates\</TargetFilename>
			<TargetFilename name="Outlook_EML" condition="end with">.eml</TargetFilename>
			<TargetFilename name="Outlook_MSG" condition="end with">.msg</TargetFilename>
			<TargetFilename name="Powerpoint_Macro" condition="end with">.pptm</TargetFilename>
			<TargetFilename name="Powerpoint_Macro" condition="end with">.potm</TargetFilename>
			<TargetFilename name="Powerpoint_Macro" condition="end with">.pptm</TargetFilename>
			<TargetFilename name="Powerpoint_Macro" condition="end with">.pptm</TargetFilename>
			<TargetFilename name="Powerpoint_OpenXML_Filetype" condition="end with">.sldm</TargetFilename>
			<TargetFilename name="Recent_Office_History" condition="contains">oleObject</TargetFilename>
			<TargetFilename name="Recent_Office_Files" condition="contains">\Microsoft\Office\Recent</TargetFilename>
			<TargetFilename name="Recent_Jumplist_Custom_Destinations" condition="contains">\Recent\CustomDestinations\</TargetFilename>
			<TargetFilename name="User_Downloaded_Files" condition="contains">\Downloads\</TargetFilename>
			<TargetFilename name="User_Outlook_Attachments" condition="contains">\Content.Outlook\</TargetFilename>
			<TargetFilename name="Word_Macro" condition="end with">.docb</TargetFilename>
			<TargetFilename name="Word_Macro" condition="end with">.wbk</TargetFilename>
			<TargetFilename name="Word_Perfect" condition="end with">.ped</TargetFilename>
			<TargetFilename name="Word_Template" condition="end with">.dot</TargetFilename>
			<TargetFilename name="Word_Template" condition="end with">.dotx</TargetFilename>
			<TargetFilename name="Word_Template" condition="end with">.dotm</TargetFilename>
			<TargetFilename name="Word" condition="end with">.doc</TargetFilename>
			<TargetFilename name="Word" condition="end with">.docm</TargetFilename>
			<TargetFilename name="Word" condition="end with">.docx</TargetFilename>
			<TargetFilename name="RTF_files_often_0day_malware_vectors_when_opened_by_Office" condition="end with">.rtf</TargetFilename>
			<Rule name="Legacy_Office_files" groupRelation="or">
				<TargetFilename condition="end with">.accdb</TargetFilename>
				<TargetFilename condition="end with">.accde</TargetFilename>
				<TargetFilename condition="end with">.accdr</TargetFilename>
				<TargetFilename condition="end with">.accdt</TargetFilename>
				<TargetFilename condition="end with">.mdb</TargetFilename>
				<TargetFilename condition="end with">.mde</TargetFilename>
				<TargetFilename condition="end with">.msc</TargetFilename>
				<TargetFilename condition="end with">.mst</TargetFilename>
				<TargetFilename condition="end with">.potx</TargetFilename>
				<TargetFilename condition="end with">.ppam</TargetFilename>
				<TargetFilename condition="end with">.ppsm</TargetFilename>
				<TargetFilename condition="end with">.ppsx</TargetFilename>
				<TargetFilename condition="end with">.ppt</TargetFilename>
				<TargetFilename condition="end with">.pptm</TargetFilename>
				<TargetFilename condition="end with">.pptx</TargetFilename>
				<TargetFilename condition="end with">.pub</TargetFilename>
				<TargetFilename condition="end with">.sldm</TargetFilename>
				<TargetFilename condition="end with">.sldx</TargetFilename>
				<TargetFilename condition="end with">.xlm</TargetFilename>
				<TargetFilename condition="end with">.xls</TargetFilename>
				<TargetFilename condition="end with">.xps</TargetFilename>
			</Rule>
			<!--Archive Collected Data-->
			<TargetFilename name="T1560,Archive_Collected_Data,7zip_Archive" condition="end with">.7z</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,7zip_Archive" condition="end with">.7zip</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,7zip_Archive" condition="end with">.arj</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,7zip_Archive" condition="end with">.s7z</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,.A_Archive" condition="end with">.a</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,ACE_Archive" condition="end with">.ace</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,AR_Archive" condition="end with">.ar</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,ARC_Archive" condition="end with">.arc</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,BIN" condition="end with">.bin</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,CAB_Archive" condition="end with">.cab</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,Game_PAK_Archive" condition="end with">.pak</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,Gzip_Archive" condition="end with">.gz</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,IMG_Archive" condition="end with">.img</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,ISO_Archive" condition="end with">.iso</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,LZM_Archive" condition="end with">.lzm</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,LZMA_Archive" condition="end with">.lzma</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,RAR_Archive" condition="end with">.rar</TargetFilename>
			<TargetFilename name="RAR_Archive_Extraction" condition="contains">Temp\Rar$</TargetFilename>
			<TargetFilename name="RAR SFX_Archive_Extraction" condition="contains">RarSFX</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,SFX_Archive" condition="end with">.sfx</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,SZ_Archive" condition="end with">.sz</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,TAR_Archive" condition="end with">.tar</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,TAR.GZ_Archive" condition="end with">.tar.gz</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,TAR.GZ_Archive" condition="end with">.tgz</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,XZ_Archive" condition="end with">.xz</TargetFilename>
			<TargetFilename name="T1560,Archive_Collected_Data,ZIP_Archive" condition="end with">.zip</TargetFilename>
			<!--Email Collection-->
			<TargetFilename name="T1114,Email_Collection,Possible_Email_Collection/Exfiltration" condition="end with">.ost</TargetFilename>
			<TargetFilename name="T1114,Email_Collection,Possible_Email_Collection/Exfiltration" condition="end with">.eml</TargetFilename>
			<TargetFilename name="T1114,Email_Collection,Possible_Email_Collection/Exfiltration" condition="end with">.msg</TargetFilename>
			<TargetFilename name="T1114,Email_Collection,Possible_Email_Collection/Exfiltration" condition="end with">.pst</TargetFilename>
			<!--Drivers dropped-->
			<TargetFilename name="Driver_File_Dropped" condition="end with">.sys</TargetFilename>
			<TargetFilename name="Driver_File_Dropped" condition="end with">.drv</TargetFilename> 
			<TargetFilename name="Driver_File_Dropped" condition="end with">.inf</TargetFilename>
			<TargetFilename name="Driver_File_Dropped" condition="begin with">C:\Windows\SysWOW64\Drivers</TargetFilename>
			<TargetFilename name="Driver_File_Dropped" condition="begin with">C:\Windows\System32\Drivers</TargetFilename>
			<TargetFilename name="Driver_File_Dropped" condition="contains">\Drivers\</TargetFilename>
			<!--Ingress Tool Transfer-->
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_Teamviewer" condition="image">Teamviewer.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_rundll32" condition="image">rundll32.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_Remote_Desktop_Client" condition="image">mstsc.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_command_shell" condition="image">cmd.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_IronPython.exe" condition="image">ipy.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_WScript.exe" condition="image">WScript.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_cscript.exe" condition="image">cscript.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_mshta.exe" condition="image">mshta.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_python.exe" condition="image">python.exe</Image>
			<Image name="T1105,Ingress_Tool_Transfer,File_Created_by_wmic.exe" condition="image">wmic.exe</Image>
			<!--Certificates-->
			<Rule name="Certificate_File_Created" groupRelation="or">
				<TargetFilename condition="end with">.pem</TargetFilename>
				<TargetFilename condition="end with">.crt</TargetFilename>
				<TargetFilename condition="end with">.ca-bundle</TargetFilename>
				<TargetFilename condition="end with">.cer</TargetFilename>
				<TargetFilename condition="end with">.csr</TargetFilename>
				<TargetFilename condition="end with">.der</TargetFilename>
				<TargetFilename condition="end with">.p7b</TargetFilename>
				<TargetFilename condition="end with">.p7r</TargetFilename>
				<TargetFilename condition="end with">.p7s</TargetFilename>
				<TargetFilename condition="end with">.pfx</TargetFilename>
				<TargetFilename condition="end with">.sto</TargetFilename>
				<TargetFilename condition="end with">.p12</TargetFilename>
				<TargetFilename condition="end with">.crl</TargetFilename>
				<TargetFilename condition="end with">.sst</TargetFilename>
				<TargetFilename condition="end with">.key</TargetFilename>
			</Rule>
			<!--Masquerading-->
			<Rule name="T1036,Masquerading,Monitor_Common_Masquarading_Locations" groupRelation="or">
				<TargetFilename condition="begin with">C:\PerfLogs\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Temp\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Users\Default\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Users\Public\</TargetFilename> 
				<TargetFilename condition="begin with">C:\Windows\Temp\</TargetFilename> 
				<TargetFilename condition="contains">\AppData\Temp\</TargetFilename>
			</Rule>
			<TargetFilename name="Recycle_bin_files_created" condition="contains">$Recycle.Bin</TargetFilename>
			<Image name="Recycle_bin_files_created" condition="contains">$Recycle.Bin</Image>
			<Rule name="T1036,Masquerading,Files_Created_within_System_Profile" groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\</TargetFilename>
				<TargetFilename condition="contains">\config\systemprofile\</TargetFilename>
			</Rule>
			<Rule name="T1036,Masquerading,Files_Created_within_System_Profile" groupRelation="and">
				<Image condition="begin with">C:\Windows\</Image>
				<Image condition="contains">\config\systemprofile\</Image>
			</Rule>
			<Rule name="T1036.007,Masquerading,Double_File_Extension" groupRelation="or">
				<TargetFilename condition="end with">      .exe</TargetFilename>
				<TargetFilename condition="end with">.7z.exe</TargetFilename>
				<TargetFilename condition="end with">.doc.exe</TargetFilename>
				<TargetFilename condition="end with">.docx.exe</TargetFilename>
				<TargetFilename condition="end with">.ico.exe</TargetFilename>
				<TargetFilename condition="end with">.iso.exe</TargetFilename>
				<TargetFilename condition="end with">.lnk.exe</TargetFilename>
				<TargetFilename condition="end with">.pdf.exe</TargetFilename>
				<TargetFilename condition="end with">.ppt.exe</TargetFilename>
				<TargetFilename condition="end with">.pptx.exe</TargetFilename>
				<TargetFilename condition="end with">.rar.exe</TargetFilename>
				<TargetFilename condition="end with">.rtf.exe</TargetFilename>
				<TargetFilename condition="end with">.txt.exe</TargetFilename>
				<TargetFilename condition="end with">.xls.exe</TargetFilename>
				<TargetFilename condition="end with">.xlsx.exe</TargetFilename>
				<TargetFilename condition="end with">.zip.exe</TargetFilename>
				<TargetFilename condition="end with">______.exe</TargetFilename>
			</Rule>
			<!--Executable Files in Suspicious Location-->
			<Rule name="Executable_Files_Created" groupRelation="and">
				<TargetFilename condition="contains any">\Downloads\;\Desktop\;C:\Windows\;C:\Program\</TargetFilename>
				<TargetFilename condition="contains any">.exe;.dll</TargetFilename>
			</Rule>
			<!--Uncategorized-->
			<Image name="Virtualbox_VM_Escape" condition="image">VirtualboxVM.exe</Image>
			<Image name="File_Dropped_to_shadow_copy" condition="begin with">\Device\HarddiskVolumeShadowCopy</Image>
			<Image name="File_Created_by_TaskManager" condition="image">taskmgr.exe</Image>
			<TargetFilename name="T1003,OS_Credential_Dumping" condition="contains">\*lsass*.dmp\</TargetFilename>
			<TargetFilename name="T1003,OS_Credential_Dumping" condition="end with">\Windows\System32\mimilsa.log</TargetFilename>
			<TargetFilename name="T1003,OS_Credential_Dumping" condition="end with">\Windows\System32\kiwissp.log</TargetFilename>
			<TargetFilename name="Minidump_Crash_dump_created" condition="begin with">C:\Windows\Minidump</TargetFilename>
			<TargetFilename name="Unusual_OLE_ActiveX_execution_from_Microsoft_Office" condition="contains any">MSForms.exd</TargetFilename>
			<TargetFilename name="Windows_Defender_Application_Control_changes" condition="begin with">C:\windows\system32\CodeIntegrity\</TargetFilename>
			<TargetFilename name="Outlook_Macro_Execution" condition="end with">\Microsoft\Outlook\VbaProject.OTM</TargetFilename>
			<TargetFilename name="New_Theme_Credential_Harvesting" condition="end with">.theme</TargetFilename>
			<TargetFilename name="Microsoft_Office_Isolated_Conversion_Environment" condition="contains">\Packages\oice_</TargetFilename>
			<TargetFilename name="T1023,Shortcut_Modification,Potential_LNK_Malware_File_Downloaded">.lnk:Zone.Identifier</TargetFilename>
			<TargetFilename name="T1087,Account_Discovery,SharpDump_bin" condition="end with">\Temp\debug.bin</TargetFilename>
			<TargetFilename name="IQY_file_used_to_pull_down_dropper" condition="end with">.iqy</TargetFilename>
			<TargetFilename name="Internet_settings" condition="end with">.isp</TargetFilename>
			<TargetFilename name="Screensaver" condition="end with">.scr</TargetFilename>
			<TargetFilename name="Registry_file" condition="end with">.reg</TargetFilename>
			<TargetFilename name="SHS_Office_File_for_copy_pastes" condition="end with">.shs</TargetFilename>
			<TargetFilename name="SLK_file_used_for_command_execution" condition="end with">.slk</TargetFilename>
			<TargetFilename name="Windows_Registry_Database" condition="end with">.sdb</TargetFilename>
			<TargetFilename name="Windows_Script_File_Component_File" condition="end with">.sct</TargetFilename>
			<TargetFilename name="Windows_Shell_Scrap_Object_Handler_File" condition="end with">.shb</TargetFilename>
			<TargetFilename name="Suspicious_TSClient_share_file_creation" condition="begin with">\\tsclient</TargetFilename>
			<TargetFilename name="WebDav_Cache_Files_Created" condition="begin with">C:\Windows\ServiceProfiles\LocalService\AppData\Local\Temp\TfsStore\</TargetFilename>
			<TargetFilename name="T1484,Domain_Policy_Modification" condition="begin with">C:\Windows\system32\GroupPolicy\Machine\Scripts</TargetFilename>
			<TargetFilename name="T1484,Domain_Policy_Modification" condition="begin with">C:\Windows\system32\GroupPolicy\User\Scripts</TargetFilename>
			<TargetFilename name="OutlookAttachment" condition="contains">\Content.Outlook\</TargetFilename>
			<TargetFilename name="T1176,Browser_Extensions" condition="end with">.crx</TargetFilename>
			<TargetFilename name="T1176,Browser_Extensions" condition="contains">\Chrome\User Data\Default\Extensions\</TargetFilename>
			<TargetFilename name="T1223,Compiled_HTML_File" condition="end with">.chm</TargetFilename>
			<TargetFilename name="CIA_Vault7" condition="end with">.cpl</TargetFilename>
			<TargetFilename name="CIA_Vault7" condition="contains">.mht</TargetFilename>
			<TargetFilename name="CIA_Vault7" condition="end with">HammerDrillStatus.dll</TargetFilename>
			<TargetFilename name="Explorer_Command" condition="end with">.scf</TargetFilename>
			<TargetFilename condition="contains all">\Microsoft\;CLR_v;\UsageLogs\</TargetFilename>
			<TargetFilename condition="end with">.ace</TargetFilename>
			<TargetFilename condition="end with">.ade</TargetFilename>
			<TargetFilename condition="end with">.adp</TargetFilename>
			<TargetFilename condition="end with">.application</TargetFilename>
			<TargetFilename condition="end with">.appref-ms</TargetFilename>
			<TargetFilename condition="end with">.asc</TargetFilename>
			<TargetFilename condition="end with">.bmf</TargetFilename>
			<TargetFilename condition="end with">.dmp</TargetFilename>
			<TargetFilename condition="end with">.gpg</TargetFilename>
			<TargetFilename condition="end with">.jar</TargetFilename>
			<TargetFilename condition="end with">.jnlp</TargetFilename>
			<TargetFilename condition="end with">.json</TargetFilename>
			<TargetFilename condition="end with">.kirbi</TargetFilename>
			<TargetFilename condition="end with">.lnk</TargetFilename>
			<TargetFilename condition="end with">.mof</TargetFilename>
			<TargetFilename condition="end with">.ocx</TargetFilename>
			<TargetFilename condition="end with">.paf</TargetFilename>
			<TargetFilename condition="end with">.pgp</TargetFilename>
			<TargetFilename condition="end with">.ppk</TargetFilename>
			<TargetFilename condition="end with">.rwz</TargetFilename>
			<TargetFilename condition="end with">.set</TargetFilename>
			<TargetFilename condition="end with">.settingcontent-ms</TargetFilename>
			<TargetFilename condition="end with">.url</TargetFilename>
			<TargetFilename condition="end with">.vsto</TargetFilename>
			<TargetFilename condition="end with">.war</TargetFilename>
		</FileCreate>
	</RuleGroup>

	<RuleGroup name="FileCreate_Exclude_Group" groupRelation="or">
		<FileCreate onmatch="exclude">
			<!--Microsoft-->
			<Image condition="is">C:\Program Files (x86)\EMET 5.5\EMET_Service.exe</Image> <!--Microsoft:EMET: Writes to C:\Windows\AppPatch\-->
			<!--Microsoft:Office:Click2Run-->
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe</Image> <!-- Microsoft:Office Click2Run-->
			<!--Windows-->
			<Image condition="is">C:\Windows\system32\smss.exe</Image> <!-- Windows: Session Manager SubSystem: Creates swapfile.sys,pagefile.sys,hiberfile.sys-->
			<Image condition="is">C:\Windows\system32\CompatTelRunner.exe</Image> <!-- Windows: Windows 10 app, creates tons of cache files-->
			<Image condition="is">\\?\C:\Windows\system32\wbem\WMIADAP.EXE</Image> <!-- Windows: WMI Performance updates-->
			<Image condition="is">C:\Windows\system32\mobsync.exe</Image> <!--Windows: Network file syncing-->
			<TargetFilename condition="begin with">C:\Windows\system32\DriverStore\Temp\</TargetFilename> <!-- Windows: Temp files by DrvInst.exe-->
			<TargetFilename condition="begin with">C:\Windows\system32\wbem\Performance\</TargetFilename> <!-- Windows: Created in wbem by WMIADAP.exe-->
			<TargetFilename condition="begin with">C:\Windows\Installer\</TargetFilename> <!--Windows:Installer: Ignore MSI installer files caching-->
			<!--Windows:Updates-->
			<TargetFilename condition="begin with">C:\$WINDOWS.~BT\Sources\</TargetFilename> <!-- Windows: Feature updates containing lots of .exe and .sys-->
			<Image condition="begin with">C:\Windows\winsxs\amd64_microsoft-windows</Image> <!-- Windows: Windows update-->
			<!--Others-->
			<Image condition="is">C:\Program Files (x86)\Dell\CommandUpdate\InvColPC.exe</Image>
			<Image condition="is">C:\Windows\system32\igfxCUIService.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
			<Image condition="is">C:\Program Files (x86)\RES Software\Workspace Manager\pfwsmgr.exe</Image>
			<TargetFilename condition="end with">WRITABLE.TST</TargetFilename>
			<TargetFilename condition="contains">\AppData\Roaming\Microsoft\Windows\Recent\</TargetFilename>
			<Image condition="is">c:\Program Files\Microsoft Security Client\MsMpEng.exe</Image>
			<Rule groupRelation="and">
				<Image condition="image">Outlook.exe</Image>
				<TargetFilename condition="contains">Roaming\Microsoft\Outlook\Outlook.xml</TargetFilename>
			</Rule>
			<Image condition="is">c:\windows\system32\provtool.exe</Image>
			<Image condition="is">C:\WINDOWS\CCM\CcmExec.exe</Image>
			<TargetFilename condition="begin with">C:\Windows\CCM</TargetFilename>
			<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\PLA\FabricTraces</TargetFilename>
			<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\SoftwareProtectionPlatform\SvcRestartTask</TargetFilename>
			<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerRoleUsageCollector</TargetFilename>
			<TargetFilename condition="begin with">C:\Windows\System32\Tasks\Microsoft\Windows\Customer Experience Improvement Program\Server\ServerCeipAssistant</TargetFilename>
		</FileCreate>
	</RuleGroup>

	<!--SYSMON EVENT ID 12 & 13 & 14 : REGISTRY MODIFICATION [RegistryEvent]-->
	<!--EVENT 12: "Registry object added or deleted"-->
	<!--EVENT 13: "Registry value set"-->
	<!--EVENT 14: "Registry objected renamed"-->
	<!--DATA: EventType, UtcTime, ProcessGuid, ProcessId, Image, TargetObject, Details (can't filter on), NewName (can't filter on)-->
	<RuleGroup name="RegistryEvent_Include_Group" groupRelation="or">
		<RegistryEvent onmatch="include">
			<!--Active Scanning-->
			<Rule name="T1595,Active_Scanning,Advanced_IP_Scanner_Detected" groupRelation="and">
				<TargetObject condition="contains">Software\Famatech\advanced_ip_scanner\State</TargetObject>
				<TargetObject condition="end with">LastRangeUsed</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<!--Hardware Additions-->
			<Rule name="T1200,Hardware_Additions,Detect_Keyloggers_and_new_Keyboards" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e96b-e325-11ce-bfc1-08002be10318}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_USB_Input_Devices" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{745a17a0-74d3-11d0-b6fe-00a0c90f57da}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_New_Mice" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e96f-e325-11ce-bfc1-08002be10318}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_New_Composite_Device" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{36fc9e60-c465-11cf-8056-444553540000}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_New_Bluetooth_Device" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{e0cbf06c-cd8b-4647-bb8a-263b43f0f974</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_New_Disk_Drive" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{4d36e967-e325-11ce-bfc1-08002be10318}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_New_WPD_Devices" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{eec5ad98-8080-425f-922a-dabf3de3f69a}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Detect_New_Biometric_Devices" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Class\{53D29EF7-377C-4D14-864B-EB3A85769359}</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,Virtual_DVD-ROM_Drive_Mounted" groupRelation="and">
				<TargetObject condition="contains all">Root\InventoryDevicePnp;prod_virtual_dvd-rom</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<Rule name="T1200,Hardware_Additions,ISO_Drive_Mounted" groupRelation="and">
				<TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer\CD Burning\Drives\Volume</TargetObject>
				<TargetObject condition="end with">Drive Type</TargetObject>
				<Details condition="contains">DWORD (0x00000011)</Details>
			</Rule>
			<TargetObject name="T1200,Hardware_Additions,Mounted_Device_Detection" condition="contains">MountedDevices</TargetObject>
			<TargetObject name="T1200,Hardware_Additions,Mountpoints2_Mounted_Device_Detection" condition="contains">Mountpoints2</TargetObject>
			<TargetObject name="T1200,Hardware_Additions,Active_Setup_Installed_Components" condition="contains">Active Setup\Installed Components</TargetObject>
			<!--Valid Accounts -->
			<Rule name="Interactive_Logon_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\SessionData\</TargetObject>
				<TargetObject condition="end with">LoggedOnUser</TargetObject>
			</Rule>
			<TargetObject name="Last_Logged_on_User_modification" condition="contains">LastLoggedOnUser</TargetObject>
			<TargetObject name="Last_Logged_on_Provider_modification" condition="contains">LastLoggedOnProvider</TargetObject>
			<!--Exploitation for Client Execution-->
			<Rule name="T1203,Exploitation_for_Client_Execution,Suspicious_Set_Value_of_MSDT_Dogwalk/follina_CVE-2022-30190" groupRelation="and">
				<TargetObject condition="begin with">HKCR\ms-msdt\</TargetObject>
			</Rule>
			<Rule name="T1203,Exploitation_for_Client_Execution,Scripted_Diagnostics_Turn_Off_Check_Enabled_Dogwalk/follina_CVE-2022-30190" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\ScriptedDiagnostics\TurnOffCheck</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<!--User Execution-->
			<Rule name="T1204,User_Execution,VBA_Project_Object_Model_Macro_Settings" groupRelation="and">
				<TargetObject condition="end with">\AccessVBOM</TargetObject>
				<Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
			</Rule>
			<Rule name="T1204,User_Execution,VBA_Project_VBA_Warnings_Macro_Setting_Change" groupRelation="and">
				<TargetObject condition="end with">Security\VBAWarnings</TargetObject>
				<Image condition="excludes any">C:\Windows\system32\svchost.exe;C:\WINDOWS\system32\mmc.exe;C:\Windows\system32\userinit.exe</Image>
			</Rule>
			<Rule name="T1204,User_Execution,Potential_Office_Macro_Execution_Detected" groupRelation="and">
				<Image condition="contains any">EXCEL.exe;WINWORD.exe</Image>
				<TargetObject condition="contains any">{8BD21D32-EC42-11CE-9E0D-00AA006002F3};{5B9D8FC8-4A71-101B-97A6-00000B65C08B}</TargetObject>
			</Rule>
			<!--User Execution: Malicious File-->
			<Rule name="NJRAT_Detection" groupRelation="and">
				<TargetObject condition="is">HKCU\di</TargetObject>
			</Rule>
			<Rule name="Lokibot_Detection" groupRelation="and">
				<TargetObject condition="contains">HKCU\�</TargetObject>
			</Rule>
			<Rule name="AMSI_Tamper_Detection" groupRelation="or">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\AMSI\Providers\</TargetObject>
				<TargetObject condition="begin with">hklm\software\microsoft\windows script\settings\amsienable</TargetObject>
				<TargetObject condition="begin with">hkcu\software\microsoft\windows script\settings\amsienable</TargetObject>
			</Rule>
			<!--Create Account-->
			<Rule name="T1136,Create_Account,New_user_created" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
				<TargetObject condition="excludes">$</TargetObject>
				<EventType condition="is">CreateKey</EventType>
			</Rule>
			<Rule name="T1136,Create_Account,Hidden_New_user_created" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
				<TargetObject condition="contains">$</TargetObject>
				<EventType condition="is">CreateKey</EventType>
			</Rule>
			<!--Account Manipulation-->
			<Rule name="Forced_password_reset_detected" groupRelation="and">
				<TargetObject condition="contains">ForcePasswordReset</TargetObject>
			</Rule>
			<Rule name="Machine_Password_Change_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SECURITY\Policy\Secrets\$MACHINE.ACC\CurrVal</TargetObject>
			</Rule>
			<Rule name="User_Last_Password_Changed" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
				<TargetObject condition="end with">Last Password Change</TargetObject>
			</Rule>
			<Rule name="Account_Expiration" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
				<TargetObject condition="end with">Account Expiration</TargetObject>
			</Rule>
			<Rule name="Last_Failed_Logon" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\</TargetObject>
				<TargetObject condition="end with">Last Failed Logon</TargetObject>
			</Rule>
			<Rule name="User_Account_Added_to_Local_Admin" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\Domains\Builtin\Aliases\00000220\</TargetObject>
			</Rule>
			<Rule name="User_Account_Added_to_Remote_Desktop_User_Group" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\Domains\Builtin\Aliases\0000022B\</TargetObject>
			</Rule>
			<!--Account Access Removal-->
			<Rule name="T1531,Account_Access_Removal,User_Account_Deleted" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SAM\SAM\DOMAINS\Account\Users\Names\</TargetObject>
				<EventType condition="is">DeleteKey</EventType>
			</Rule>
			<!--Detect User Activity-->
			<TargetObject name="Detect_Bluetooth_Audio_Capture" condition="contains">\ConsentStore\bluetooth</TargetObject>
			<TargetObject name="Detect_Contacts_Accesses" condition="contains">\ConsentStore\contacts</TargetObject>
			<TargetObject name="Detect_Input_Capture_Accesses/Keyloggers" condition="contains">\ConsentStore\hunmanInterfaceDevice</TargetObject>
			<TargetObject name="Detect_Location_Accesses" condition="contains">\ConsentStore\location</TargetObject>
			<TargetObject name="Detect_Microphone_Accesses" condition="contains">\ConsentStore\microphone</TargetObject>
			<TargetObject name="Detect_USB_Accesses" condition="contains">\ConsentStore\usb\</TargetObject>
			<TargetObject name="Detect_Webcam_Accesses" condition="contains">\ConsentStore\webcam</TargetObject>
			<TargetObject name="Detect_humanInterfaceDevice_Accesses" condition="contains">\ConsentStore\humanInterfaceDevice</TargetObject>
			<TargetObject name="Regedit_Applets" condition="contains">SOFTWARE\Microsoft\Windows\CurrentVersion\Applets\RegEdit</TargetObject>
			<TargetObject name="USBStor_USB_Device_History" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Enum\USBSTOR</TargetObject>
			<TargetObject name="Undocumented_LSASS_DLL_Loading" condition="contains">\CurrentControlSet\Services\NTDS\LsaDbExtPt</TargetObject>
			<TargetObject name="Undocumented_LSASS_DLL_Loading" condition="contains">\Services\NTDS\DirectoryServiceExtPt</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,GoToMyPC_File_Transfer_History" condition="contains">GoToMyPc\FileTransfer\history</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,GoToMyPC_Guest_Invite" condition="contains">GoToMyPc\GuestInvite</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,LogMeIn_File_Transfer_Recipient" condition="contains">Filesharing</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,LogMeIn_Guest_Recipient" condition="contains">DesktopSharing</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_LogIncomingConnections_Registry_Key_modification" condition="contains">LogIncomingConnections</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_LogOutgoingConnection_Registry_Key_modification" condition="contains">LogOutgoingConnections</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_Password_Registry_Key_date" condition="contains">PermanentPasswordDate</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_adminrights_Key_modification" condition="contains">Security_Adminrights</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,VNC_Incoming_Connection_History" condition="contains">vncviewer\MRU</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_Autostart_Key_modification" condition="contains">Autostart_GUI</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_Meeting_Username_Registry_Key_modification" condition="end with">Meeting_UserName</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_Persistence_Login_Name" condition="end with">BuddyLoginName</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_Persistence_Token_ID_modification" condition="end with">BuddyLoginTokenID</TargetObject>
			<TargetObject name="T1219,Remote_Access_Tools,Teamviewer_Persistence_Key_modification" condition="contains">Always_Online</TargetObject>
			<TargetObject name="Kitty_Sessions" condition="contains">Kitty\Sessions</TargetObject>
			<TargetObject name="Putty_Sessions" condition="contains">PuTTY\Sessions</TargetObject>
			<TargetObject name="WINSCP_Sessions" condition="contains">WinSCP 2\Sessions</TargetObject>
			<!--Create or Modify System Process-->
			<Rule name="Sysmon_Manifest_change_detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Microsoft\Windows\CurrentVersion\WINEVT\Publishers\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}</TargetObject>
				<Image condition="excludes">C:\WINDOWS\sysmon64.exe</Image>
				<Image condition="excludes">C:\WINDOWS\sysmon.exe</Image>
				<Image condition="excludes">C:\Programdata\sysmon\sysmon64.exe</Image>
			</Rule>
			<!--Event Triggered Execution-->
			<Rule name="T1546.001,Event_Triggered_Execution_Change_Default_File_Association,Monitor_Endpoint_Protocol_Handlers" groupRelation="and">
				<TargetObject condition="begin with">HKCR\</TargetObject>
				<TargetObject condition="end with">(Default)</TargetObject>
				<TargetObject condition="excludes">\shell\open\command\(Default)</TargetObject>
				<Details condition="begin with">URL:</Details>
			</Rule>
			<Rule name="T1546.001,Event_Triggered_Execution_Change_Default_File_Association,Monitor_User_Protocol_Handlers" groupRelation="and">
				<TargetObject condition="begin with">HKCU\Software\Classes\</TargetObject>
				<TargetObject condition="end with">(Default)</TargetObject>
				<TargetObject condition="excludes">\shell\open\command\(Default)</TargetObject>
				<Details condition="begin with">URL:</Details>
			</Rule>
			<Rule name="T1546.001,Event_Triggered_Execution_Change_Default_File_Association,Monitor_Endpoint_File_Associations" groupRelation="and">
				<TargetObject condition="begin with">HKCR\</TargetObject>
				<TargetObject condition="end with">\shell\open\command\(Default)</TargetObject>
				<Details condition="contains">%1</Details>
			</Rule>
			<Rule name="T1546.001,Event_Triggered_Execution_Change_Default_File_Association,Monitor_User_Default_File_Associations" groupRelation="and">
				<TargetObject condition="begin with">HKCU\Software\Classes\</TargetObject>
				<TargetObject condition="end with">\shell\open\command\(Default)</TargetObject>
				<Details condition="contains">%1</Details>
			</Rule>
			<Rule name="T1546.001,Event_Triggered_Execution_Change_Default_File_Association,Monitor_COM_Hijacking" groupRelation="and">
				<TargetObject condition="end with">\shell\open\command\DelegateExecute</TargetObject>
			</Rule>
			<Rule name="T1546.015,Event_Triggered_Execution,Suspicious_Com_Object_Hijacking_Locations" groupRelation="and">
				<TargetObject condition="contains any">\InprocServer32\(Default);\LocalServer32\(Default);\ScriptletURL\(Default)</TargetObject>
				<Details condition="contains any">C:\Users\Public\;$Recyclebin;\temp\;\Desktop\;\Downloads\;\Content.Outlook\;\Microsoft\Office\</Details>
				<Details condition="excludes">C:\WINDOWS\SYSTEM32\UpdateDeploy.dll</Details>
			</Rule>
			<Rule name="T1546.015,Event_Triggered_Execution,Com_Object_Hijacking_Locations" groupRelation="and">
				<TargetObject condition="contains any">\InprocServer32\(Default);\LocalServer32\(Default);\ScriptletURL\(Default)</TargetObject>
				<Details condition="excludes">C:\WINDOWS\SYSTEM32\UpdateDeploy.dll</Details>
			</Rule>
			<Rule name="T1546.015,Event_Triggered_Execution,TreatAs/ProgID_Friendly_Name_Com_Hijacking_Evasion" groupRelation="and">
				<TargetObject condition="contains any">\ProgID\(Default);\TreatAs\(Default)</TargetObject>
			</Rule>
			<!--Event Triggered Execution: Accessibility Features-->
			<Rule name="T1015,Accessibility_Features,Utilman_Priv_Escalation" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\utilman.exe</TargetObject>
			</Rule>
			<Rule name="T1015,Accessibility_Features,sethc.exe_Priv_Escalation" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sethc.exe</TargetObject>
			</Rule>
			<!--Event Triggered Execution: Image File Execution Options Injection-->
			<Rule name="T1183,Image_File_Execution_Options_Injection" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject>
				<TargetObject condition="contains any">Debugger;ReportingMode;MonitorProcess</TargetObject>
			</Rule>
			<Rule name="T1183,Image_File_Execution_Options_Injection,SilentProcessExit_Globalflag_Set" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject>
				<TargetObject condition="contains">GlobalFlag</TargetObject>
				<Details condition="contains">DWORD (0x00000200)</Details> <!--SilentProcessExit Dword Value-->
			</Rule>
			<Rule name="T1183,Image_File_Execution_Options_Injection,SilentProcessExit_Process_Execution_entry" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
				<TargetObject condition="contains">MonitorProcess</TargetObject> <!--SilentProcessExit Monitor Process from werfault-->
			</Rule>
			<Rule name="T1183,Image_File_Execution_Options_Injection,SilentProcessExit_Reporting_Mode_Enabled" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\</TargetObject>
				<TargetObject condition="contains">ReportingMode</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details> <!--SilentProcessExit Reporting Mode Enabled-->
			</Rule>
			<Rule name="T1183,Image_File_Execution_Options_Injection,SilentProcessExit_Process_Added" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows NT\CurrentVersion\SilentProcessExit</TargetObject>
				<EventType condition="is">CreateKey</EventType>
			</Rule>
			<Rule name="T1546,Event_Triggered_Execution,Monitor_Runtime_Exception_Handler_execution_on_crash" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\Windows\Windows Error Reporting\RuntimeExceptionHelperModules\</TargetObject>
				<Image condition="excludes all">C:\Program Files (x86)\Microsoft\EdgeUpdate\Install\{;}\EDGEMITMP_;.tmp\setup.exe</Image>
				<Image condition="excludes">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
				<Image condition="excludes">C:\Program Files\Microsoft Office\root\integration\integrator.exe</Image>
				<Image condition="excludes all">C:\Program Files\Google\Chrome Beta\Application\;\Installer\setup.exe</Image>
				<Image condition="excludes all">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\Updates\;\OfficeClickToRun.exe</Image>
			</Rule>
			<TargetObject name="T1183,Image_File_Execution_Options_Injection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</TargetObject> <!--Windows: Malware likes changing IFEO, like adding Debugger to disable antivirus EXE-->
			<TargetObject name="T1183,Image_File_Execution_Options_Injection" condition="begin with">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
			<!--Hijack Execution Flow-->
			<TargetObject name="KnownDLLs" condition="contains">Session Manager\KnownDlls</TargetObject>
			<!--Abuse Elevation Control Mechanism-->
			<TargetObject name="T1548,Abuse_Elevation_Control_Mechanism,CMSTPLUA_UAC_Bypass" condition="contains any">cmmgr32.exe</TargetObject>
			<!--Hide Artifacts-->
			<TargetObject name="Hidden_File_Explorer_Setting_modification" condition="end with">\Hidden</TargetObject>
			<TargetObject name="Hidden_File_Explorer_Setting_modification" condition="end with">\ShowSuperHidden</TargetObject>
			<TargetObject name="Hidden_File_Explorer_Setting_modification" condition="end with">\HideFileExt</TargetObject>
			<Rule name="T1564.002,Hide_Artifacts,User_Account_Hidden_From_Logon_Screen" groupRelation="and">
				<TargetObject condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist\</TargetObject>
				<TargetObject condition="end with">$</TargetObject>
 				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<!--Indicator Removal on Host-->
			<Rule name="T1070,Indicator_Removal_on_Host,ETWEnabled_Env_Tampering" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\.NETFramework\ETWEnabled</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="T1070,Indicator_Removal_on_Host,Usagelog_Tampering" groupRelation="and">
				<TargetObject condition="contains">\Microsoft\.NETFramework\NGenAssemblyUsageLog</TargetObject>
			</Rule>
			<Rule name="T1070,Indicator_Removal_on_Host,Usagelog_Env_Tampering" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\Environment\NGenAssemblyUsageLog</TargetObject>
			</Rule>
			<Rule name="T1070,Indicator_Removal_on_Host,COMPlus_ETWEnabled_Env_Tampering" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\Environment\COMPlus_ETWEnabled</TargetObject>
			</Rule>
			<!--Modify Registry-->
			<Rule name="Suspicious_Location_Registry_Change_Detected" groupRelation="and">
				<TargetObject condition="contains">\Software\Microsoft\Windows\CurrentVersion\Explorer</TargetObject>
				<Image condition="contains any">\AppData\;\ProgramData\;\Temp\;C:\users</Image>
			</Rule>
			<TargetObject name="Regedit_history_Detection" condition="end with">\LastKey</TargetObject>
			<TargetObject name="Symbolic_Registry_Link_Created" condition="contains">SymbolicLinkValue</TargetObject>
			<TargetObject name="Right_to_Left_hidden_Registry_key" condition="contains">&#x202e;</TargetObject>
			<TargetObject name="Monitor_Remote_Registry_Setting_Keys" condition="begin with">HKLM\System\CurrentControlSet\Control\SecurePipeServers\winreg</TargetObject>
			<!--Modify System Certificate-->
			<Rule name="Detect_System_Certificate_Modifications" groupRelation="and">
				<TargetObject condition="contains any">\Software\Policies\Microsoft\SystemCertificates\;\SOFTWARE\Microsoft\EnterpriseCertificates\;HKLM\SOFTWARE\Microsoft\SystemCertificates\;HKLM\Software\Microsoft\Cryptography\Services\ServiceName\SystemCertificates\</TargetObject>
				<EventType condition="is not">CreateKey</EventType>
				<Image condition="excludes">C:\WINDOWS\Sysmon64.exe</Image>
				<Image condition="excludes">C:\WINDOWS\Sysmon.exe</Image>
				<Image condition="excludes">C:\WINDOWS\system32\certsrv.exe</Image>
				<Image condition="excludes">C:\WINDOWS\system32\CompatTelRunner.exe</Image>
				<Image condition="excludes">C:\WINDOWS\system32\svchost.exe</Image>
				<Image condition="excludes">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
				<Image condition="excludes">C:\Windows\system32\SearchProtocolHost.exe</Image>
				<Image condition="excludes">C:\Windows\system32\taskhost.exe</Image>
				<Image condition="excludes">C:\windows\SysWOW64\svchost.exe</Image>
				<Image condition="excludes">C:\WINDOWS\System32\DriverStore\FileRepository\asus</Image>
				<Image condition="excludes">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image>
				<Image condition="excludes">C:\Program Files\ASUS\ARMOURY CRATE Service\ArmouryCrate.Service.exe</Image>
				<Image condition="excludes">C:\Program Files\NVIDIA Corporation\NvContainer\nvcontainer.exe</Image>
			</Rule>
			<!--Obfuscated Files or Information-->
			<Rule name="Unicode_Replacement_Character_in_Registry_key" groupRelation="and">
				<TargetObject condition="contains">&#xfffd;</TargetObject>
			</Rule>
			<Rule name="Cryillic_Character_in_Registry_key" groupRelation="and">
				<TargetObject condition="contains any">Й;ќ;Л;я;К</TargetObject>
			</Rule>
			<!--Rootkit-->
			<TargetObject name="T1109,Component_Firmware,Detect_ACPI_Rootkits" condition="begin with">HKLM\HARDWARE\ACPI\DSDT</TargetObject>
			<!--Unsecured Credentials: Credentials in Registry-->
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Account Name</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Display Name</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\Email</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP User</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP User</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\MAPI Provider</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 User</TargetObject>
			<TargetObject condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP User</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultPassword</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\HTTP Password</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\IMAP Password</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\POP3 Password</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="contains all">SOFTWARE\Microsoft\Office\;\Outlook\Profiles\;\9375CFF0413111d3B88A00104B2A6676\;\SMTP Password</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultDomainName</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\DefaultUserName</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry,Teamviewer_Password_Exposed_in_Plain_Text" condition="contains">SecurityPasswordAES</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry,Teamviewer_Password_Exposed_in_Plain_Text" condition="contains">OptionsPasswordAES</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry,Teamviewer_Password_Exposed_in_Plain_Text" condition="contains">SecurityPasswordExported</TargetObject>
			<TargetObject name="T1214,Credentials_in_Registry,Teamviewer_Password_Exposed_in_Plain_Text" condition="contains">PermanentPassword</TargetObject>
			<!--Ingress Tool Transfer-->
			<Rule name="Git_For_Windows_Detection" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\GitForWindows</TargetObject>
			</Rule>
			<!--Data Destruction-->
			<Rule name="T1485,Data_Destruction,Bitlocker_Drive_Encryption_Enabled_on_System_Drive" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BitlockerStatus\BootStatus</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="T1485,Data_Destruction,Bitlocker_Drive_Encryption_Disabled_on_System_Drive" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BitlockerStatus\BootStatus</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<!--Inhibit System Recovery-->
			<TargetObject name="T1485,Inhibit_System_Recovery,VSS_Disablement_Detection" condition="contains">\Services\VSS\Diag\(Default)</TargetObject>
			<!--CLSID launch commands and file association changes-->
			<TargetObject name="File_Extension_Mapping" condition="contains">\Explorer\FileExts\</TargetObject>
			<TargetObject name="Command_Shell_install_Key" condition="contains">\shell\install\command\</TargetObject>
			<TargetObject name="User_SID_History_for_Forensics" condition="end with">\ProfileImagePath</TargetObject>
			<!--AppPaths hijacking-->
			<TargetObject name="Detect_AppPaths_Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\</TargetObject>
			<TargetObject name="Detect_AppPaths_Hijacking" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\AppCertDlls\</TargetObject>
			<TargetObject name="Detect_AppPaths_Hijacking" condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\S0InitialCommand</TargetObject>
			<!--Group Policy integrity and scripts-->
			<TargetObject name="Group_Policy_interity_Detection" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\</TargetObject>
			<TargetObject name="Detect_Group_Policy_Logoff_Scripts" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Logoff</TargetObject>
			<TargetObject name="Detect_Group_Policy_Logoff_Scripts" condition="contains">\Software\Policies\Microsoft\Windows\System\Scripts\Logoff</TargetObject>
			<TargetObject name="Detect_Group_Policy_Logon_Scripts" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Logon</TargetObject>
			<TargetObject name="Detect_Group_Policy_Logon_Scripts" condition="contains">\Software\Policies\Microsoft\Windows\System\Scripts\Logon</TargetObject>
			<TargetObject name="Detect_Group_Policy_Shutdown_Scripts" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\State\Machine\Scripts\Shutdown</TargetObject>
			<TargetObject name="Detect_Group_Policy_Shutdown_Scripts" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\System\Scripts\Shutdown</TargetObject>
			<TargetObject name="Detect_Group_Policy_Startup_Scripts" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\State\Machine\Scripts\Startup</TargetObject>
			<TargetObject name="Detect_Group_Policy_Startup_Scripts" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\System\Scripts\Startup</TargetObject>
			<!--Autorun or Startups-->
			<TargetObject name="T1562.002" condition="end with">\MiniNT</TargetObject> <!--Windows: Disable eventlog by acting like WinPE-->
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains">CurrentVersion\Run</TargetObject> <!--Windows: Wildcard for Run keys, including RunOnce, RunOnceEx, RunServices, RunServicesOnce [Also covers terminal server]-->
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains">Policies\Explorer\Run</TargetObject> <!--Windows: Alternate runs keys | Credit @ion-storm-->
			<TargetObject name="T1547,Registry_Run_Keys,Logon_Logoff_Shutdown_Scripts" condition="contains">\Microsoft\System\Scripts</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys,Logon_Logoff_Shutdown_Scripts" condition="contains">\Windows\System\Scripts</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains">CurrentVersion\Windows\Load</TargetObject> <!--Windows: [ https://msdn.microsoft.com/en-us/library/jj874148.aspx ] -->
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains">CurrentVersion\Windows\Run</TargetObject> <!--Windows: [ https://msdn.microsoft.com/en-us/library/jj874148.aspx ] -->
			<TargetObject name="T1547,Registry_Run_Keys,Service_Command_Line_parameters" condition="begin with">HKLM\SYSTEM\Setup\CmdLine</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">hkcu\software\microsoft\windows\currentversion\explorer\shell folders\common startup</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">hkcu\software\microsoft\windows\currentversion\explorer\shell folders\startup</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">hklu\software\microsoft\command processor\autorun</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">hklm\software\microsoft\command processor\autorun</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\Software\Wow6432Node\Microsoft\Command Processor\AutoRun</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains all">hkcu\software\microsoft\windows nt\currentversion\accessibility\ATs\\*(1)\StartExe</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains">Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Startup</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\SetupExecute</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\System\CurrentControlSet\Control\Session Manager\Execute</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\SafeDllSearchMode</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AeDebug</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\VmApplet</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit\</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\AppSetup</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\System</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys" condition="contains">UserInitMprLogonScript</TargetObject>
			<TargetObject name="T1547,Registry_Run_Keys,BootVerificationProgram_Autorun" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\BootVerificationProgram\ImagePath</TargetObject>
			<!--Other Common Malware Persistence locations-->
			<TargetObject name="Terminal_Server_AutoRun" condition="contains">Terminal Server\Wds\rdpwd\StartupPrograms</TargetObject>
			<TargetObject name="Alternate_Shell_AvailableShells_Hijack" condition="contains">Winlogon\AlternateShells\AvailableShells</TargetObject>
			<TargetObject name="Alternative_Shell_Policy" condition="contains">Policies\System\Shell</TargetObject>
			<TargetObject name="AutoStart_on_Connect" condition="contains">Windows CE Services\AutoStartOnConnect</TargetObject>
			<TargetObject name="AutoStart_on_Disconnect" condition="contains">Windows CE Services\AutoStartOnDisconnect</TargetObject>
			<TargetObject name="Chrome_Extensions" condition="contains">PreferenceMACs\Default\extensions.settings</TargetObject>
			<TargetObject name="CurrentVersion_URL_Key" condition="contains">CurrentVersion\URL</TargetObject>
			<TargetObject name="Font_Drivers" condition="end with">\CurrentVersion\Font Drivers</TargetObject>
			<TargetObject name="Group_Policy_Shutdown_scripts" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown</TargetObject>
			<TargetObject name="Icon_Service_Lib" condition="contains">CurrentVersion\Windows\IconServiceLib</TargetObject>
			<TargetObject name="Lateral_Movement_New_Named_Pipe_added_to_NullSession" condition="contains">NullSessionShares</TargetObject>
			<TargetObject name="Lateral_Movement_New_Named_Pipe_added_to_NullSession" condition="end with">NullSessionPipes</TargetObject>
			<TargetObject name="Password_Expiry_Info" condition="contains">PasswordExpiryNotification</TargetObject>
			<TargetObject name="Safeboot_Alternative_Shell_hijack" condition="contains">SafeBoot\AlternateShell</TargetObject>
			<TargetObject name="Screen_Save_on_Desktop" condition="contains">Desktop\Scrnsave.exe</TargetObject>
			<TargetObject name="Software_Installed_or_DisplayVersion_modified" condition="end with">\DisplayVersion</TargetObject>
			<TargetObject name="Software_Installed_or_Modify_String_modified" condition="end with">\ModifyPath</TargetObject>
			<TargetObject name="Software_Installed_or_Uninstall_String_modified" condition="contains">\Microsoft\Windows\CurrentVersion\Uninstall\</TargetObject>
			<TargetObject name="Software_Installed_or_Uninstall_String_modified" condition="end with">\UninstallString</TargetObject>
			<TargetObject name="Terminal_Services_Initial_Program_Key" condition="contains">Terminal Server\WinStations\RDP-Tcp\InitialProgram</TargetObject>
			<TargetObject name="Winlogon_Taskman_Key" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman</TargetObject>
			<!--Scheduled Task/Job-->
			<Rule name="T1053,Scheduled_Task,New_Scheduled_Task_Created" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
				<TargetObject condition="end with">SD</TargetObject>
				<TargetObject condition="is not">Microsoft\Windows\UpdateOrchestrator</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\Setup\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\OneDrive Per-Machine Standalone Update Task\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Feature Updates\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Feature Updates Logon\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Performance Monitor\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Windows\Setup\SnapshotCleanupTask\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office ClickToRun Service Monitor\SD</TargetObject>
				<TargetObject condition="is not">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\Microsoft\Office\Office Automatic Updates 2.0\SD</TargetObject>
				<TargetObject condition="excludes">Microsoft\Windows\UpdateOrchestrator</TargetObject>
			</Rule>
			<Rule name="T1053,Scheduled_Task,Creation_ID_Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree</TargetObject>
				<TargetObject condition="end with">ID</TargetObject>
			</Rule>
			<Rule name="T1053,Scheduled_Task,Creation_Author_Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				<TargetObject condition="end with">Author</TargetObject>
			</Rule>
			<Rule name="T1053,Scheduled_Task,Creation_Path_Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				<TargetObject condition="end with">Path</TargetObject>
			</Rule>
			<Rule name="T1053,Scheduled_Task,Creation_Date_Key" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
				<TargetObject condition="end with">Date</TargetObject>
			</Rule>
			<Rule name="T1053,Scheduled_Task,Added_to_Logon" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Logon</TargetObject>
			</Rule>
			<Rule name="T1053,Scheduled_Task,Added_to_Boot_Time" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Boot</TargetObject>
			</Rule>
			<!--RDP-->
			<TargetObject name="RDP_port_change" condition="end with">Control\Terminal Server\WinStations\RDP-Tcp\PortNumber</TargetObject> <!--Windows: RDP port change under Control [ https://blog.menasec.net/2019/02/of-rdp-hijacking-part1-remote-desktop.html ]-->
			<TargetObject name="RDP_port_change" condition="end with">Control\Terminal Server\fSingleSessionPerUser</TargetObject> <!--Windows: Allow same user to have mutliple RDP sessions, to hide from admin being impersonated-->
			<TargetObject name="Modify_Remote_Desktop_State" condition="end with">fDenyTSConnections</TargetObject> <!--Windows: Attacker turning on RDP-->
			<TargetObject name="T1090,Proxy,NetSH_PortProxy_Detected" condition="end with">Services\PortProxy\v4tov4</TargetObject> <!--Windows: Changing RDP port to evade IDS-->
			<TargetObject condition="contains">\Microsoft\Terminal Server Client\Default\MRU</TargetObject> <!-- MSTSC Connection History -->
			<TargetObject name="RDP_History" condition="contains">\Microsoft\Terminal Server Client\Servers\</TargetObject> <!-- MSTSC Connection History -->
			<TargetObject name="T1021.001,RDP" condition="is">HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services</TargetObject>
			<!--Windows shell hijack-->
			<TargetObject name="AllFileSystemObjects_Classes" condition="contains">\Classes\AllFilesystemObjects\</TargetObject>
			<TargetObject name="Asterisk_Classes" condition="contains">\Classes\*\</TargetObject>
			<TargetObject name="CFT_LangBarAddin" condition="contains">\Software\Microsoft\Ctf\LangBarAddin</TargetObject>
			<TargetObject name="ContextMenuHandlers" condition="contains">\ContextMenuHandlers\</TargetObject>
			<TargetObject name="CurrentVersion_Shell_Keys" condition="contains">\CurrentVersion\Shell</TargetObject>
			<TargetObject name="Detect_ShellExecuteHooks" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\explorer\ShellIconOverlayIdentifiers</TargetObject>
			<TargetObject name="Directory_Classes" condition="contains">\Classes\Directory\</TargetObject>
			<TargetObject name="Drive_Classes" condition="contains">\Classes\Drive\</TargetObject>
			<TargetObject name="Explorer_Shell_Execute_Hooks" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\explorer\ShellExecuteHooks</TargetObject>
			<TargetObject name="Folder_Classes" condition="contains">\Classes\Folder\</TargetObject>
			<TargetObject name="Hidden_File_Explorer_Setting_modification" condition="end with">\Hidden</TargetObject>
			<TargetObject name="Hidden_File_Extensions_Explorer_Setting_modification" condition="end with">\HideFileExt</TargetObject>
			<TargetObject name="Internet_Explorer_Desktop_Components" condition="contains">\SOFTWARE\Microsoft\Internet Explorer\Desktop\Components</TargetObject>
			<TargetObject name="Protocol_Filter_Classes" condition="contains">\SOFTWARE\Classes\Protocols\Filter</TargetObject>
			<TargetObject name="Protocol_Handler_Classes" condition="contains">\SOFTWARE\Classes\Protocols\Handler</TargetObject>
			<TargetObject name="SharedTaskScheduler" condition="contains">\SharedTaskScheduler</TargetObject>
			<TargetObject name="Super_Hidden_File_Explorer_Setting_modification" condition="end with">\ShowSuperHidden</TargetObject>
			<TargetObject name="Windows_Shell_Hijack_ColumnHandlers" condition="contains">\ColumnHandlers</TargetObject>
			<TargetObject name="Windows_Shell_Hijack_CopyHookHandlers" condition="contains">\CopyHookHandlers</TargetObject>
			<TargetObject name="Windows_Shell_Hijack_ExtShellFolderView" condition="contains">\ExtShellFolderViews</TargetObject>
			<TargetObject name="Windows_Shell_Hijack_PropertySheetHandlers" condition="contains">\PropertySheetHandlers</TargetObject>
			<TargetObject name="Windows_Shell_Hijack_ShellServiceObjectDelayLoad" condition="contains">\ShellServiceObjectDelayLoad</TargetObject>
			<TargetObject name="Windows_Shell_Hijack_ShellServiceObjects" condition="contains">\ShellServiceObjects</TargetObject>
			<!--Winsock and Winsock2-->
			<TargetObject name="Detect_IE_Popup_Blocker_Changes" condition="end with">\3\1809</TargetObject> 
			<TargetObject name="Detect_IE_Protected_Mode_Changes" condition="end with">\3\2500</TargetObject>
			<TargetObject name="Detect_IE_Scripting_Mode_in_Internet_Zone_Changes" condition="end with">\3\1206</TargetObject>
			<TargetObject name="Detect_IE_Security_Setting_Check_Warning_Changes" condition="end with">\DisableSecuritySettingsCheck</TargetObject>
			<TargetObject name="Detect_Winsock_Catalog_Changes" condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\NameSpace_Catalog5\Catalog_Entries64</TargetObject>
			<TargetObject name="Detect_Winsock_Catalog_Changes" condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries64</TargetObject>
			<TargetObject name="Detect_Winsock_Catalog_Changes" condition="begin with">HKLM\System\CurrentControlSet\Services\WinSock2\Parameters\Protocol_Catalog9\Catalog_Entries</TargetObject>
			<TargetObject name="Detect_Winsock_Changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinSock\</TargetObject>
			<TargetObject name="Detect_Winsock_Proxy_Server_Changes" condition="end with">\ProxyServer</TargetObject>
			<TargetObject name="Detected_IE_Legacy_setting_modifications" condition="end with">SavedLegacySettings</TargetObject>
			<TargetObject name="Detected_IE_Proxy_setting_modifications" condition="contains">Software\Microsoft\Windows\CurrentVersion\Internet Settings\Proxy</TargetObject>
			<TargetObject name="Detected_Modifications_of_Console_Tracing" condition="end with">EnableConsoleTracing</TargetObject>
			<TargetObject name="Detected_Modifications_of_File_Tracing" condition="end with">EnableFileTracing</TargetObject>
			<TargetObject name="Proxy_Autoconfig_URL" condition="contains">\Software\Microsoft\Windows\CurrentVersion\Internet Settings\AutoConfigURL</TargetObject>
			<!--Credential providers-->
			<TargetObject name="T1177,LSASS_Driver,Detection_of_Modification_of_LSASS_Protection" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL</TargetObject>
			<TargetObject name="Detect_Authentication_PLAP_Provider_Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\PLAP Providers</TargetObject>
			<TargetObject name="Detect_Authentication_Provider_Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Provider</TargetObject>
			<TargetObject name="Detect_LSA_Credential_Provider_Changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\</TargetObject>
			<TargetObject name="Detect_NETSH_Helper_DLL_Changes" condition="begin with">HKLM\SOFTWARE\Microsoft\Netsh</TargetObject>
			<TargetObject name="Detect_Security_Provider_Changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SecurityProviders\</TargetObject>
			<TargetObject name="T1003,Credential_Dumping" condition="contains">\Control\SecurityProviders\WDigest</TargetObject>
			<TargetObject condition="contains">Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyEnable</TargetObject> <!--Windows: Malware often disables a web proxy for 2nd stage downloads -->
			<!--DLLs that get injected into every process at launch-->
			<TargetObject name="AppInitDLL_Moninitoring_DLLs_that_get_injected_into_every_process_launch" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject> <!--Windows: Feature disabled by default [ https://attack.mitre.org/wiki/Technique/T1103 ] -->
			<TargetObject name="AppInitDLL_Moninitoring_DLLs_that_get_injected_into_every_process_launch" condition="begin with">HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Windows\Appinit_Dlls\</TargetObject> <!--Windows: Feature disabled by default [ https://attack.mitre.org/wiki/Technique/T1103 ] -->
			<TargetObject name="DNS_Server_DLL_Injection" condition="is">REGISTRY\MACHINE\SYSTEM\ControlSet001\Services\DNS\Parameters\ServerLevelPluginDll</TargetObject>
			<!--Office-->
			<TargetObject name="Office_Test_Autorun_Location_Monitoring" condition="contains">Office Test\</TargetObject> <!-- Microsoft:Office: Persistence method [ http://www.hexacorn.com/blog/2014/04/16/beyond-good-ol-run-key-part-10/ ] | Credit @Hexacorn -->
			<TargetObject name="Suspicious,ChangedURLOutlook" condition="contains all">\Software\Microsoft\Office\;\Outlook\WebView\;URL</TargetObject> <!-- The URL shouldn't be changed all that often and could enable persistance for hackers | @humpelpum [ https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70 ]-->
			<TargetObject name="Context,ProtectedModeExitOrMacrosUsed" condition="contains">Security\Trusted Documents\TrustRecords</TargetObject> <!--Microsoft:Office: Monitor when "Enable editing" or "Enable macros" is used | Credit @OutflankNL | [ https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/ ] -->
			<TargetObject name="Context,ContactedDomain" condition="end with">\EnableBHO</TargetObject> <!--Microsoft:Office: Contacted domains stored here 'HKEY_CURRENT_USER\<SID>\SOFTWARE\Microsoft\Office\16.0\Common\Internet\Server Cache\<domain>\EnableBHO' -->
			<TargetObject name="T1137,Office_Application_Startup,Microsoft_Outlook_Addins" condition="contains">Outlook\Addins</TargetObject>
			<TargetObject name="T1137,Office_Application_Startup,Microsoft_Word_Addins" condition="contains">Word\Addins</TargetObject>
			<TargetObject name="T1137,Office_Application_Startup,Microsoft_Excel_Addins" condition="contains">Excel\Addins</TargetObject>
			<TargetObject name="T1137,Office_Application_Startup,Microsoft_Powerpoint_Addins" condition="contains">Powerpoint\Addins</TargetObject>
			<TargetObject name="T1137,Office_Application_Startup,Microsoft_VSTO_Inclusions" condition="contains">Software\Microsoft\VSTO\Security\Inclusion\</TargetObject>
			<TargetObject name="T1137,Office_Application_Startup,Microsoft_VSTO_Solution_Metadata" condition="contains">Software\Microsoft\VSTO\SolutionMetadata\</TargetObject>
			<TargetObject name="User_added_Macro_document_to_Trusted_Records" condition="contains">\Trusted Documents\TrustRecords</TargetObject>
			<TargetObject name="User_added_Macro_document_to_Trusted_Records" condition="contains">Software\Microsoft\VBA\7.1\Common</TargetObject>
			<TargetObject name="User_added_Macro_trusted_certificate" condition="contains">Software\Microsoft\VBA\7.1\Trusted</TargetObject>
			<!--Detect Malware & Unauthorized Changes to Outlook, Excel, Powerpoint, and Access Security to enable execution of scripts/Macros -->
			<Rule name="T1203,Exploitation_for_Client_Execution,All_Office_Macros_Enabled" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="T1203,Exploitation_for_Client_Execution,Notifications_for_all_macros" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000002)</Details>
			</Rule>
			<Rule name="T1203,Exploitation_for_Client_Execution,Notifications_for_digitally_signed_macros" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000003)</Details>
			</Rule>
			<Rule name="T1203,Exploitation_for_Client_Execution,All_Office_Macros_Disabled_without_notification" groupRelation="and">
				<TargetObject condition="contains">\Security\Level</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<!--Internet Explorer-->
			<TargetObject name="T1176,Browser_Extensions,Detect_Changes_to_IE_Toolbars" condition="contains">Internet Explorer\Toolbar\</TargetObject> <!--Microsoft:InternetExplorer: Machine and user [ Example: https://www.exterminate-it.com/malpedia/remove-mywebsearch ] -->
			<TargetObject name="T1176,Browser_Extensions,Detect_Changes_to_IE_Toolbars" condition="contains">Internet Explorer\Extensions\</TargetObject> <!--Microsoft:InternetExplorer: Machine and user [ Example: https://www.exterminate-it.com/malpedia/remove-mywebsearch ] -->
			<TargetObject name="Detect_Browser_Helper_Object_Modifications" condition="contains">Browser Helper Objects\</TargetObject> <!--Microsoft:InternetExplorer: Machine and user [ https://msdn.microsoft.com/en-us/library/bb250436(v=vs.85).aspx ] -->
			<TargetObject condition="end with">\DisableSecuritySettingsCheck</TargetObject>
			<TargetObject condition="end with">\3\1206</TargetObject> <!--Microsoft:InternetExplorer: Malware sometimes assures scripting is on in Internet Zone [ https://support.microsoft.com/en-us/help/182569/internet-explorer-security-zones-registry-entries-for-advanced-users ] -->
			<TargetObject condition="end with">\3\2500</TargetObject> <!--Microsoft:InternetExplorer: Malware sometimes disables Protected Mode in Internet Zone [ https://blog.avast.com/2013/08/12/your-documents-are-corrupted-from-image-to-an-information-stealing-trojan/ ] -->
			<TargetObject condition="end with">\3\1809</TargetObject> <!--Microsoft:InternetExplorer: Malware sometimes disables Pop-up Blocker in Internet Zone [ https://support.microsoft.com/en-us/help/182569/internet-explorer-security-zones-registry-entries-for-advanced-users ] -->
			<!--Magic registry keys-->
			<TargetObject name="Detect_Changes_to_Thumbnail_cache_autostart" condition="contains">{AB8902B4-09CA-4BB6-B78D-A8F59079A8D5}\</TargetObject> <!--Windows: Thumbnail cache autostart-->
			<TargetObject name="Detect_Changes_to_ActiveMovie_Filter" condition="contains">{083863F1-70DE-11d0-BD40-00A0C911CE86}\</TargetObject> <!--Windows: DirectX instances-->
			<!--Install/Run artifacts-->
			<TargetObject name="ClickOnce_URL_Update_Artifact" condition="end with">\UrlUpdateInfo</TargetObject>
			<TargetObject name="Installer_Source_Artifact" condition="end with">\InstallSource</TargetObject>
			<TargetObject name="Alert,Sysinternals_Tool_Used" condition="end with">\EulaAccepted</TargetObject> <!--Sysinternals tool launched. Lots of useful abilities for attackers -->
			<!--Windows Defender tampering-->
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\DisableAntiSpyware</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\DisableAntiVirus</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\SpynetReporting</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\DisableRealtimeMonitoring</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\DisableBehaviorMonitoring</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\DisableOnAccessProtection</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Tamper-Defender" condition="end with">\SubmitSamplesConsent</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Detect_Windows_Defender_Exclusion" condition="begin with">HKLM\Software\Microsoft\Windows Defender\Exclusions</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Detect_Windows_Defender_Policy_Changes" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows Defender</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools,Detect_Windows_Defender_Tamper_Protection_Modifications" condition="contains">TamperProtection</TargetObject>
			<!--Windows UAC tampering or bypass-->
			<Rule name="T1548.002,Bypass_User_Access_Control,UAC_Disablement_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="T1548.002,Bypass_User_Access_Control,ConsentPromptBehaviorAdmin_Disablement_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\ConsentPromptBehaviorAdmin</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="T1548.002,Bypass_User_Access_Control,PromptOnSecureDesktop_Disablement_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\PromptOnSecureDesktop</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<TargetObject name="T1548.002,Bypass_User_Access_Control,Detect_UAC_Tampering" condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy</TargetObject>
			<TargetObject name="T1548.002,Bypass_User_Access_Control" condition="end with">exefile\shell\runas\command\isolatedCommand</TargetObject>
			<TargetObject name="T1548.002,Bypass_User_Access_Control" condition="contains">\mscfile\shell\open\command</TargetObject>
			<TargetObject name="T1548.002,Bypass_User_Access_Control" condition="contains">ms-settings\shell\open\command</TargetObject>
			<TargetObject name="T1548.002,Bypass_User_Access_Control" condition="begin with">HKCU\Software\Classes\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\Shell\open\command</TargetObject>
			<!--Windows application compatibility-->
			<TargetObject name="T1138,AppCompatShim" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Custom</TargetObject> <!--Windows: AppCompat [ https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html ] -->
			<TargetObject name="T1138,AppCompatShim" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\InstalledSDB</TargetObject> <!--Windows: AppCompat [ https://attack.mitre.org/wiki/Technique/T1138 ] -->
			<TargetObject condition="contains">VirtualStore</TargetObject> <!--Windows: Registry virtualization, something's wrong if it's in use [ https://msdn.microsoft.com/en-us/library/windows/desktop/aa965884(v=vs.85).aspx ] -->
			<!--Windows inventory events-->
			<TargetObject name="InvDB-Path" condition="end with">\LowerCaseLongPath</TargetObject> <!-- [ https://binaryforay.blogspot.com/2017/10/amcache-still-rules-everything-around.html ] -->
			<TargetObject name="InvDB-Pub" condition="end with">\Publisher</TargetObject> <!-- [ https://binaryforay.blogspot.com/2017/10/amcache-still-rules-everything-around.html ] -->
			<TargetObject name="InvDB-Ver" condition="end with">\BinProductVersion</TargetObject> <!-- [ https://docs.microsoft.com/en-us/windows/privacy/basic-level-windows-diagnostic-events-and-fields-1709 ] -->
			<TargetObject name="InvDB-DriverVer" condition="end with">\DriverVersion</TargetObject> <!-- [ https://df-stream.com/2015/02/leveraging-devicecontainers-key/ ] -->
			<TargetObject name="InvDB-DriverVer" condition="end with">\DriverVerVersion</TargetObject> <!-- [ https://df-stream.com/2015/02/leveraging-devicecontainers-key/ ] -->
			<TargetObject name="InvDB-CompileTimeClaim" condition="end with">\LinkDate</TargetObject> <!-- Compile time of EXE, may not be reliable [ https://en.wikipedia.org/wiki/Link_time ] -->
			<TargetObject name="InvDB" condition="contains">Compatibility Assistant\Store\</TargetObject> <!-- Inventory -->
			<TargetObject name="Suspicious_Keyboard_Layout_Load" condition="contains">\Keyboard Layout\Preload</TargetObject> <!--Microsoft:Windows: Keyboard layout loaded into user session [ https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index ] -->
			<TargetObject name="Suspicious_Keyboard_Layout_Load" condition="contains">\Keyboard Layout\Substitutes</TargetObject> <!--Microsoft:Windows: Keyboard layout loaded into user session [ https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index ] -->
			<!--Impair Defenses: Disable Windows Event Logging-->
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Disabling_of_Windows_Event_Log_Source" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
				<TargetObject condition="end with">\Enabled</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Enabling_of_Windows_Event_Log_Source" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
				<TargetObject condition="end with">\Enabled</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Detect_Event_log_system_integrity_and_ACL_Modifications" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\</TargetObject>
				<TargetObject condition="excludes">\Enabled</TargetObject>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Change Winevt Event Access Permission Via Registry,Author=frack113" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WINEVT\Channels\</TargetObject>
				<TargetObject condition="end with">\ChannelAccess</TargetObject>
				<Details condition="contains any">(A;;0x1;;;SY);(A;;0x5;;;BA);(A;;0x1;;;LA)</Details>
				<Image condition="excludes any">C:\Windows\servicing\TrustedInstaller.exe;\TiWorker.exe</Image>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Disabling_of_Powershell_Event_Logging" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging</TargetObject>
				<TargetObject condition="end with">\EnableScriptBlockLogging</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Disabling_of_Powershell_Event_Logging" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\Powershell\ScriptBlockLogging</TargetObject>
				<TargetObject condition="end with">\EnableScriptBlockLogging</TargetObject>
				<EventType condition="is any">DeleteKey;DeleteValue</EventType>
			</Rule>
			<TargetObject name="T1562.002,Disable_Windows_Event_Logging" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ModuleLogging</TargetObject>
			<TargetObject name="T1562.002,Disable_Windows_Event_Logging" condition="begin with">HKLM\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription</TargetObject>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Disabling_of_cmdline_Event_Logging" groupRelation="and">
				<TargetObject condition="begin with">hklm\software\microsoft\windows\currentversion\policies\system\audit</TargetObject>
				<TargetObject condition="end with">\ProcessCreationIncludeCmdLine_Enabled</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Disabling_of_cmdline_Event_Logging" groupRelation="and">
				<TargetObject condition="begin with">hklm\software\microsoft\windows\currentversion\policies\system\audit</TargetObject>
				<TargetObject condition="end with">\ProcessCreationIncludeCmdLine_Enabled</TargetObject>
				<EventType condition="is any">DeleteKey;DeleteValue</EventType>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Eventlog_Security_Descriptor_Modification" groupRelation="and">
				<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
				<TargetObject condition="end with">\CustomSD</TargetObject>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Eventlog_Size_Modification" groupRelation="and">
				<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
				<TargetObject condition="end with">\MaxSize</TargetObject>
			</Rule>
			<Rule name="T1562.002,Disable_Windows_Event_Logging,Eventlog_Retention_Modification" groupRelation="and">
				<TargetObject condition="begin with">HKLM\System\CurrentControlSet\Services\Eventlog</TargetObject>
				<TargetObject condition="end with">\Retention</TargetObject>
			</Rule>
			<!--Other Impair Defenses or Disable Something-->
			<Rule name="T1562,Impair_Defenses,Stealth_Sysmon_Change_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SysmonDrv\Parameters</TargetObject>
				<Image condition="excludes">C:\WINDOWS\sysmon64.exe</Image>
				<Image condition="excludes">C:\WINDOWS\sysmon.exe</Image>
				<Image condition="excludes">C:\Programdata\sysmon\sysmon64.exe</Image>
			</Rule>
			<Rule name="T1562,Impair_Defenses,Modification_to_System_Exploit_Protection" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\kernel</TargetObject>
				<TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
			</Rule>
			<Rule name="T1562,Impair_Defenses,Modification_to_Per-Process_Exploit_Protection" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
				<TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
				<TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\vmcompute.exe\0\MitigationOptions</TargetObject>
				<TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\vmwp.exe\0\MitigationOptions</TargetObject>
				<Image condition="excludes">msiexec.exe</Image>
				<Image condition="excludes">TiWorker.exe</Image>
			</Rule>
			<Rule name="T1562,Impair_Defenses,Modification_to_WOW64_Per-Process_Exploit_Protection_Mitigation_Options" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</TargetObject>
				<TargetObject condition="contains any">MitigationOptions;MitigationAuditOptions</TargetObject>
				<Image condition="excludes">C:\Program Files\Microsoft Office 15\root\integration\integrator.exe</Image>
				<TargetObject condition="excludes">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Acro</TargetObject>
			</Rule>
			<Rule name="T1562,Impair_Defenses,Task_Manager_Disablement_Detection" groupRelation="and">
				<TargetObject condition="end with">DisableTaskMgr</TargetObject>
				<Image condition="excludes">C:\WINDOWS\system32\svchost.exe</Image>
				<Image condition="excludes">C:\windows\SysWOW64\svchost.exe</Image>
			</Rule>
			<Rule name="T1562,Impair_Defenses,Driver_Altitude_Change_Detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\</TargetObject>
				<TargetObject condition="contains all">\Instances\;Altitude</TargetObject>
				<TargetObject condition="is not">HKLM\System\CurrentControlSet\Services\CldFlt\Instances\CldFlt\Altitude</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<TargetObject name="T1562,Disabling_Security_Tools" condition="contains">SYSTEM\CurrentControlSet\services\SysmonDrv</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools" condition="contains">SYSTEM\CurrentControlSet\services\Sysmon</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools" condition="end with">\EnableFirewall</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools" condition="end with">\DoNotAllowExceptions</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile\AuthorizedApplications\List</TargetObject>
			<TargetObject name="T1562,Disabling_Security_Tools" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\DomainProfile\AuthorizedApplications\List</TargetObject>
			<TargetObject name="Word_Security_Changes" condition="contains">\Word\Security</TargetObject>
			<TargetObject name="Excel_Security_Changes" condition="contains">\Excel\Security</TargetObject>
			<TargetObject name="Detected_Unauthorized_changes_to_Office_Security" condition="contains">\Security\Level1Remove</TargetObject>
			<TargetObject name="Security_Center_HideSCAHealth" condition="end with">\HideSCAHealth</TargetObject>
			<TargetObject name="Security_Center_AV_Disabled_Notifications" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AntiVirusDisableNotify</TargetObject>
			<TargetObject name="Security_Center_Disable_UAC_Notify" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UacDisableNotify</TargetObject>
			<TargetObject name="Security_Center_Disabled_Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\DisableMonitoring</TargetObject>
			<TargetObject name="Security_Center_Disabled_Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallDisableNotify</TargetObject>
			<TargetObject name="Security_Center_Disabled_Update_notifications" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\UpdatesDisableNotify</TargetObject>
			<TargetObject name="Security_Center_Firewall_Override_Monitoring" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\FirewallOverride</TargetObject>
			<TargetObject name="Security_Center_All_Alerts_Disabled" condition="begin with">HKLM\SOFTWARE\Microsoft\Security Center\AllAlertsDisabled</TargetObject>
			<TargetObject name="Detected_disablement_of_System_Restore" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\RPSessionInterval</TargetObject>
			<TargetObject name="Detected_disablement_of_System_Restore" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore\SystemRestorePointCreationFrequency</TargetObject>
			<TargetObject name="Detected_disablement_of_machine_password" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\DisablePasswordChange</TargetObject>
			<TargetObject name="Monitor_Secure_Channel_Protection_changes" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\FullSecureChannelProtection</TargetObject>
			<TargetObject name="Refuse_PW_Change_for_workstations" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters\RefusePasswordChange</TargetObject>
			<TargetObject name="Globally_Opened_Firewall_port_exceptions" condition="contains">globallyopenports</TargetObject>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Sense</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WinDefend</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\MsMpSvc</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\NisSrv</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdBoot</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisDrv</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\WdNisSvc</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wscsvc</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\SecurityHealthService</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\wuauserv</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Disabled" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<!--Services-->
			<Rule name="T1543.003,Create_Windows_Service,New_SVCHost_service" groupRelation="and">
				<TargetObject condition="contains">SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost</TargetObject>
				<TargetObject condition="excludes">\print\</TargetObject>
				<TargetObject condition="excludes">\AzureAttestService\CoInitializeSecurityParam</TargetObject>
				<Image condition="excludes">C:\$WINDOWS.~BT\</Image>
			</Rule>
			<Rule name="Service_Start_Mode_Changed_to_Boot" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000000)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Changed_to_System" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000001)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Changed_to_Automatic" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000002)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Changed_to_Manual" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000003)</Details>
			</Rule>
			<Rule name="Service_Start_Mode_Changed_to_Disabled" groupRelation="and">
				<TargetObject condition="end with">\Start</TargetObject>
				<Details condition="contains">DWORD (0x00000004)</Details>
			</Rule>
			<TargetObject name="T1031,T1050" condition="end with">\ServiceDll</TargetObject> <!--Windows: Points to a service's DLL-->
			<TargetObject name="T1031,T1050" condition="end with">\ServiceManifest</TargetObject> <!--Windows: Manifest pointing to service's DLL-->
			<TargetObject name="T1031,T1050" condition="end with">\ImagePath</TargetObject> <!--Windows: Points to a service's EXE-->
			<TargetObject name="T1543,Service_Creation" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services</TargetObject>
			<!--Windows trust architecture monitoring-->
			<TargetObject name="T1553.003,SIP_and_Trust_Provider_Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\OID</TargetObject> <!-- Important trust registry values to monitor -->
			<TargetObject name="T1553.003,SIP_and_Trust_Provider_Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\OID</TargetObject> <!-- Important trust registry values to monitor -->
			<TargetObject name="T1553.003,SIP_and_Trust_Provider_Hijacking" condition="begin with">HKLM\SOFTWARE\Microsoft\Cryptography\Providers\Trust</TargetObject> <!-- Important trust registry values to monitor -->
			<TargetObject name="T1553.003,SIP_and_Trust_Provider_Hijacking" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Cryptography\Providers\Trust</TargetObject> <!-- Important trust registry values to monitor -->
			<!--Windows internals integrity monitoring-->
			<TargetObject name="Tamper-Safemode" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Safeboot\</TargetObject> <!--Windows: Services approved to load in safe mode. Almost nothing should ever modify this.-->
			<TargetObject name="Tamper-Winlogon" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Winlogon\</TargetObject> <!--Windows: Providers notified by WinLogon-->
			<TargetObject name="New_Device_Connected" condition="end with">\FriendlyName</TargetObject> <!--Windows: New devices connected and remembered-->
			<TargetObject name="Windows_Installer_Engaged" condition="is">HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\InProgress\(Default)</TargetObject> <!--Windows: See when WindowsInstaller is engaged, useful for timeline matching with other events-->
			<TargetObject name="Tamper-Tracing" condition="begin with">HKLM\Software\Microsoft\Tracing\RASAPI32</TargetObject> <!--Windows: Malware sometimes disables tracing to obfuscate tracks-->
			<TargetObject condition="contains">\Keyboard Layout\Preload</TargetObject> <!--Microsoft:Windows: Keyboard layout loaded into user session [ https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index ] | Credit @cyb3rops -->
			<TargetObject condition="contains">\Keyboard Layout\Substitutes</TargetObject> <!--Microsoft:Windows: Keyboard layout loaded into user session [ https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index ] | Credit @cyb3rops -->
			<TargetObject name="Detect_Legacy_Drivers_Loaded" condition="begin with">HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows NT\CurrentVersion\Drivers32</TargetObject>
			<TargetObject name="Detect_System_Policy_Changes" condition="contains">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\</TargetObject>
			<!--Detect Network History-->
			<TargetObject name="Detect_AD_Domain_Change" condition="end with">Domain</TargetObject>
			<TargetObject name="Detect_DHCP_Default_Gateway" condition="end with">DHCPDefaultGateway</TargetObject>
			<TargetObject name="Detect_DHCP_IP_Address" condition="end with">DhcpIPAddress</TargetObject>
			<TargetObject name="Detect_DHCP_Name_Server_Changes" condition="end with">DhcpNameserver</TargetObject>
			<TargetObject name="Detect_DHCP_Server_Change" condition="end with">Dhcpserver</TargetObject>
			<TargetObject name="Detect_DHCP_Subnet_mask_Change" condition="end with">DhcpSubnetMask</TargetObject>
			<TargetObject name="Detect_DNS_Server_Changes" condition="end with">Nameserver</TargetObject>
			<TargetObject name="Detect_Default_Gateway" condition="end with">\DefaultGateway</TargetObject>
			<TargetObject name="Detect_Network_Persistent_Route_Change" condition="end with">PersistentRoutes</TargetObject>
			<TargetObject name="Detect_Network_Type_Change" condition="end with">}\Category</TargetObject>
			<TargetObject name="Detect_Subnet_Mask_Change" condition="end with">SubnetMask</TargetObject>
			<TargetObject name="Monitor_Network_Interface_Priority_ordering" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order\</TargetObject>
			<TargetObject name="Monitor_Network_History" condition="begin with">HKLM\Software\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles</TargetObject>
			<!--Uncategorized Detections-->
			<TargetObject name="T1003.002,Security_Account_Manager" condition="contains">System\CurrentControlSet\Services\VSS</TargetObject>
			<TargetObject name="T1547.010,Port_Monitors" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors</TargetObject>
			<TargetObject name="T1547.010,Port_Monitors,CVE-2020-1048" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Ports</TargetObject>
			<TargetObject name="Outlook_Server_Identity_Keys" condition="contains">Identities</TargetObject>
			<TargetObject condition="contains">\Software\Microsoft\Office\16.0\Outlook\Security</TargetObject>
			<TargetObject name="T1547.003,Time_Providers" condition="contains">HKLM\System\CurrentControlSet\Services\W32Time\TimeProviders</TargetObject>
			<TargetObject condition="is">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Setup\ServiceStartup</TargetObject>
			<TargetObject name="T1218,Signed_Binary_Proxy_Execution" condition="begin with">HKLM\Software\Microsoft\WAB\DLLPath</TargetObject>
			<TargetObject name="T1047,Windows_Management_Instrumentation" condition="contains">SYSTEM\CurrentControlSet\Control\CrashControl</TargetObject>
			<Rule name="Chrome_Extension_auditing" groupRelation="and">
				<TargetObject condition="contains">Google\Chrome\Extensions</TargetObject>
				<TargetObject condition="end with">update_url</TargetObject>
				<EventType condition="is">SetValue</EventType>
			</Rule>
			<TargetObject name="T1055,Process_Injection,Injecting_a_64-bit_DLL_into_a_32-bit_process" condition="contains">SOFTWARE\Microsoft\Wow64\x86\</TargetObject>
			<Rule name="Environment_Value_Modification" groupRelation="and">
				<EventType condition="is">SetValue</EventType>
				<TargetObject condition="contains">\Environment\</TargetObject>
			</Rule>
			<TargetObject name="Office_Security_Settings_Monitor_changes_of_security_prompts" condition="contains">\Security\DontTrustInstalledFiles</TargetObject>
			<TargetObject name="Office_Trusted_Location_Changes" condition="contains">\Security\Trusted Locations</TargetObject>
			<TargetObject name="Office_Keys_Monitor_Disabling_of_Internet_files_in_Protected_View" condition="end with">Security\ProtectedView\DisableInternetFilesInPV</TargetObject>
			<TargetObject name="Office_Keys_Monitor_Disabling_of_attackments_in_Protected_View" condition="end with">Security\ProtectedView\DisableAttachmentsInPV</TargetObject>
			<TargetObject name="Office_Keys_Monitor_Disabling_of_Unsafe_Locations_in_Protected_View" condition="end with">Security\ProtectedView\DisableUnsafeLocationsInPV</TargetObject>
			<Rule name="T1112,Modify_Registry,Possible_Ursniff_Malware_Detected" groupRelation="and">
				<TargetObject condition="contains">\Software\AppDataLow\Software\Microsoft\</TargetObject>
				<Details condition="contains any">.exe;.dll;powershell;wmic</Details>
			</Rule>
			<Rule name="T1562.010,Downgrade_Attack,NetNTLM_downgrade_attack" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\lmcompatibilitylevel</TargetObject>
				<Details condition="excludes">DWORD (0x00000005)</Details> <!-- You should have this set to 5 -->
			</Rule>
			<Rule name="IPv6_Changes_detected" groupRelation="and">
				<TargetObject condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Linkage\Bind</TargetObject>
				<Details condition="excludes">Binary Data</Details>
			</Rule>
			<Rule name="Adobe_Recent_File_List_History" groupRelation="and">
				<TargetObject condition="contains">cRecentFiles\c1\</TargetObject>
				<TargetObject condition="end with">tDIText</TargetObject>
			</Rule>
			<TargetObject name="Lanmanserver_Parameters_Registry_Change_Detected" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters</TargetObject>
			<TargetObject name="Lanmanworkstation_Parameters_Registry_Change_Detected" condition="begin with">HKLM\SYSTEM\CurrentControlSet\Services\Lanmanworkstation\Parameters</TargetObject>
			<TargetObject name="TS_Farm_Disable_RDP_Detection" condition="end with">\WinStationsDisabled</TargetObject>
			<TargetObject name="TS_Farm_Drain_Mode_Modification_Detection" condition="end with">\TSServerDrainMode</TargetObject>
			<TargetObject name="IE_history_Detection" condition="end with">\TypedURLs</TargetObject>
			<TargetObject name="IPv6_Changes_detected_Disabled_Components" condition="begin with">HKLM\SYSTEM\CurrentControlSet\services\TCPIP6\Parameters\disabledcomponents</TargetObject>
			<TargetObject name="Network_Card_Changes_detected" condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkCards</TargetObject>
			<TargetObject name="Service_Listening_Ports_with_URL_ACL_INFO" condition="contains">services\http\parameters\urlaclinf</TargetObject>
			<TargetObject name="Sysmon_Config_Hash_Modification_Monitoring" condition="begin with">HKLM\System\CurrentControlSet\Services\SysmonDrv\Parameters\ConfigHash</TargetObject>
			<TargetObject name="T1486,Data_Encrypted_for_Impact,Potential_Ransomware_Indicator_EnableLinkedConnections_Registry_key" condition="begin with">HKLM\SOFTWARE\Microsoft\CurrentVersion\Policies\System\EnableLinkedConnections</TargetObject>
			<TargetObject name="T1486,Data_Encrypted_for_Impact,Potential_Ransomware_Indicator_REvil_Sodinokibi_Ransomware" condition="contains">Software\recfg</TargetObject>
		</RegistryEvent>
	</RuleGroup>

	<RuleGroup name="RegistryEvent_Exclude_Group" groupRelation="or">
		<RegistryEvent onmatch="exclude">
			<!--NOTE:	A lot of noise can be removed by excluding CreateKey events, which are largely innocuous-->
			<EventType condition="is">CreateKey</EventType>
			<TargetObject condition="contains">\{CAFEEFAC-</TargetObject>
			<TargetObject condition="begin with">HKLM\COMPONENTS</TargetObject>
			<!--Inventory noise-->
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\AppModel\StateRepository\Cache</TargetObject>
			<!--Misc-->
			<TargetObject condition="end with">Toolbar\WebBrowser</TargetObject> <!--Microsoft:IE: Extraneous activity-->
			<TargetObject condition="end with">Toolbar\WebBrowser\ITBar7Height</TargetObject>
			<TargetObject condition="end with">Toolbar\ShellBrowser\ITBar7Layout</TargetObject>
			<TargetObject condition="end with">Browser\ITBar7Height</TargetObject> <!--Microsoft:IE: Extraneous activity, covers ShellBrowser and WebBrowser-->
			<TargetObject condition="end with">Browser\ITBar7Layout</TargetObject> <!--Microsoft:IE: Extraneous activity-->
			<TargetObject condition="end with">Internet Explorer\Toolbar\Locked</TargetObject> <!--Windows:Explorer: Extraneous activity-->
			<TargetObject condition="end with">Toolbar\WebBrowser\{47833539-D0C5-4125-9FA8-0819E2EAAC93}</TargetObject> <!--Windows:Explorer: Extraneous activity-->
			<TargetObject condition="end with">}\PreviousPolicyAreas</TargetObject> <!--Windows: Remove noise from \Winlogon\GPExtensions by svchost.exe-->
			<TargetObject condition="contains">\Control\WMI\Autologger\</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Services\UsoSvc\Start</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<TargetObject condition="end with">\Lsa\OfflineJoin\CurrentValue</TargetObject> <!--Windows: Sensitive value during domain join-->
			<TargetObject condition="begin with">HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\</TargetObject> <!--Windows: Remove noise monitoring installations run as system-->
			<TargetObject condition="contains">_Classes\AppX</TargetObject> <!--Windows: Remove noise monitoring "Shell\open\command"--> <!--Win8+-->
			<TargetObject condition="end with">ShellBrowser</TargetObject>
			<TargetObject condition="end with">\CurrentVersion\Shell Extensions\Cached</TargetObject>
			<TargetObject condition="end with">\CurrentVersion\Shell Extensions\Approved</TargetObject>
			<TargetObject condition="end with">\Components\TrustedInstaller\Events</TargetObject>
			<TargetObject condition="end with">\Components\TrustedInstaller</TargetObject>
			<TargetObject condition="end with">\Components\Wlansvc</TargetObject>
			<TargetObject condition="end with">\Components\Wlansvc\Events</TargetObject>
			<!--Bootup Control noise-->
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\LsaPid</TargetObject> <!--Windows:lsass.exe: Boot noise-->
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\SspiCache</TargetObject> <!--Windows:lsass.exe: Boot noise--> <!--Win8+-->
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Kerberos\Domains</TargetObject> <!--Windows:lsass.exe: Boot noise--> <!--Win8+-->
			<!--Services startup settings noise, some low-risk services routinely change it and this can be ignored-->
			<TargetObject condition="end with">\Services\BITS\Start</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<TargetObject condition="end with">\services\clr_optimization_v2.0.50727_32\Start</TargetObject> <!--Microsoft:dotNet: Windows 7-->
			<TargetObject condition="end with">\services\clr_optimization_v2.0.50727_64\Start</TargetObject> <!--Microsoft:dotNet: Windows 7-->
			<TargetObject condition="end with">\services\clr_optimization_v4.0.30319_32\Start</TargetObject> <!--Microsoft:dotNet: Windows 10-->
			<TargetObject condition="end with">\services\clr_optimization_v4.0.30319_64\Start</TargetObject> <!--Microsoft:dotNet: Windows 10-->
			<TargetObject condition="end with">\services\deviceAssociationService\Start</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<TargetObject condition="end with">\services\fhsvc\Start</TargetObject> <!--Windows: File History Service-->
			<TargetObject condition="end with">\services\nal\Start</TargetObject> <!--Intel: Network adapter diagnostic driver-->
			<TargetObject condition="end with">\services\trustedInstaller\Start</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<TargetObject condition="end with">\services\tunnel\Start</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<TargetObject condition="end with">\services\usoSvc\Start</TargetObject> <!--Windows: Remove noise from monitoring "\Start"-->
			<!--FileExts noise filtering-->
			<TargetObject condition="end with">\UserChoice\ProgId</TargetObject> <!--Windows: Remove noise from monitoring "FileExts"--> <!--Win8+-->
			<TargetObject condition="end with">\UserChoice\Hash</TargetObject> <!--Windows: Remove noise from monitoring "FileExts"--> <!--Win8+-->
			<TargetObject condition="end with">\OpenWithList\MRUList</TargetObject> <!--Windows: Remove noise from monitoring "FileExts"-->
			<TargetObject condition="contains">Shell Extentions\Cached</TargetObject> <!--Windows: Remove noise generated by explorer.exe on monitored ShellCached binary keys--> <!--Win8+-->
			<TargetObject condition="contains">\OpenWithProgids</TargetObject>
			<TargetObject condition="end with">\OpenWithList</TargetObject>
			<TargetObject condition="end with">\UserChoice</TargetObject>
			<TargetObject condition="end with">\OpenWithList\MRUList</TargetObject>
			<!--Group Policy noise-->
			<TargetObject condition="end with">HKLM\System\CurrentControlSet\Control\Lsa\Audit\SpecialGroups</TargetObject> <!--Windows: Routinely set through Group Policy, not especially important to log-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\PSScriptOrder</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\SOM-ID</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\GPO-ID</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\0\IsPowershell</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup\0\0\ExecTime</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\PSScriptOrder</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\SOM-ID</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\GPO-ID</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\0\IsPowershell</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="end with">SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Shutdown\0\0\ExecTime</TargetObject> <!--Windows:Group Policy: Noise below the actual key while building-->
			<TargetObject condition="contains">\safer\codeidentifiers\0\HASHES\{</TargetObject> <!--Windows: Software Restriction Policies. Can be used to disable security tools, but very noisy to monitor if you use it-->
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit</TargetObject>
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\AuditPolicy</TargetObject>
			<TargetObject condition="end with">HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Audit\PerUserAuditing\System</TargetObject>
			<TargetObject condition="end with">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit</TargetObject>
			<!--Office C2R-->
			<TargetObject condition="contains">VirtualStore\MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\</TargetObject> <!--Microsoft: SearchProtocolHost writes to OfficeC2R registry for Outlook, seemingly regarding mail indexing-->
			<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Office\ClickToRun\</TargetObject> <!--Microsoft: Virtual registry for Office-->
			<!--3rd party-->
			<Image condition="is">C:\Program Files\WIDCOMM\Bluetooth Software\btwdins.exe</Image> <!--Constantly writes to HKLM-->
			<TargetObject condition="begin with">HKCR\VLC.</TargetObject> <!--VLC update noise-->
			<TargetObject condition="begin with">HKCR\iTunes.</TargetObject> <!--Apple: iTunes update noise-->
			<Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\aciseposture.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Cisco\Cisco AnyConnect Secure Mobility Client\vpnagent.exe</Image>
			<Image condition="is">C:\Program Files\Cylance\Optics\CyOptics.exe</Image>
			<Image condition="is">C:\Program Files\Cylance\Desktop\CylanceSvc.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Ivanti\Workspace Control\pfwsmgr.exe</Image>
			<Image condition="is">C:\Program Files\RES Software\Workspace Manager\pfwsmgr.exe</Image>
			<!--Antivirus-->
			<Image condition="begin with">C:\Program Files (x86)\Kaspersky Lab\Kaspersky Internet Security </Image>
			<Image condition="begin with">C:\Program Files\Kaspersky Lab\Kaspersky Internet Security </Image>
			<Image condition="is">C:\Program Files\McAfee\Endpoint Encryption Agent\MfeEpeHost.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Endpoint Security\Adaptive Threat Protection\mfeatp.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Endpoint Security\Endpoint Security Platform\mfeesp.exe</Image>
			<Image condition="is">C:\Program Files\Common Files\McAfee\Engine\AMCoreUpdater\amupdate.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Agent\masvc.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Agent\x86\mfemactl.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Agent\x86\McScript_InUse.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Agent\x86\macompatsvc.exe</Image>
			<Image condition="is">C:\Program Files\McAfee\Endpoint Security\Threat Prevention\mfeensppl.exe</Image>
			<Image condition="begin with">C:\Program Files\Common Files\McAfee\Engine\scanners</Image>
			<Image condition="is">C:\Program Files\Common Files\McAfee\AVSolution\mcshield.exe</Image>
			<!--Cloud Storage-->
			<Image condition="is">C:\Program Files\ownCloud\owncloud.exe</Image>
			<Image condition="is">C:\Program Files (x86)\ownCloud\owncloud.exe</Image>
			<!--Others-->
			<Image condition="begin with">C:\Program Files\SentinelOne\Sentinel Agent</Image>
			<Image condition="is">System</Image>
			<Rule groupRelation="and">
				<Image condition="image">svchost.exe</Image>
				<TargetObject condition="begin with">HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks</TargetObject>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="is">C:\Program Files\VMware\VMware Tools\vmtoolsd.exe</Image>
				<TargetObject condition="is">HKLM\System\CurrentControlSet\Services\Tcpip\Parameters</TargetObject>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="is">C:\Windows\system32\lsass.exe</Image>
				<TargetObject condition="contains">HKLM\System\CurrentControlSet\Services</TargetObject>
			</Rule>
			<Image condition="is">C:\Program Files (x86)\Webroot\WRSA.exe</Image>
			<TargetObject condition="end with">} 0xFFFF</TargetObject>
			<Image condition="end with">Office\root\integration\integrator.exe</Image>
			<Image condition="is">C:\WINDOWS\system32\backgroundTaskHost.exe</Image>
			<Image condition="is">C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeClickToRun.exe</Image>
			<Image condition="is">C:\Program Files\Windows Defender\MsMpEng.exe</Image>
			<Image condition="is">C:\Windows\SystemApps\Microsoft.Windows.Cortana_cw5n1h2txyewy\SearchUI.exe</Image>
			<Image condition="is">C:\Program Files\Microsoft Application Virtualization\Client\AppVClient.exe</Image>
			<TargetObject condition="end with">\Directory\shellex</TargetObject>
			<TargetObject condition="end with">\Directory\shellex\DragDropHandlers</TargetObject>
			<TargetObject condition="end with">\Drive\shellex</TargetObject>
			<TargetObject condition="end with">\Drive\shellex\DragDropHandlers</TargetObject>
			<TargetObject condition="is">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\Certificates</TargetObject>
			<Image condition="begin with">C:\$WINDOWS.~BT\</Image>
		</RegistryEvent>
	</RuleGroup>

	<!--SYSMON EVENT ID 15 : ALTERNATE DATA STREAM CREATED [FileCreateStreamHash]-->
	<!--COMMENT: Any files created with an NTFS Alternate Data Stream which match these rules will be hashed and logged. ADS's are used by browsers and email clients to mark files as originating from the Internet or other foreign sources. -->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime, Hash-->
	<RuleGroup name="ADS_Include_Group" groupRelation="or">
		<FileCreateStreamHash onmatch="include">
			<Rule name="Alternate_Data_Streams" groupRelation="or">
				<TargetFilename name="Monitor_Path" condition="contains any">Content.Outlook;Downloads;Recycle;\Users\;\ProgramData\;\Windows\;Temp\7z;Temp\;\AppData\Startup;</TargetFilename>
				<TargetFilename name="Executable_Files" condition="contains any">.exe;.dll;.bat;.cmd;.cmdline;.bin;.reg;.hta;.scr</TargetFilename>
				<TargetFilename name="Script_Files" condition="contains any">.vbe;.vbs;.vb;.ps1;.ps2;.sct;.wsc;.wsf;.jse;.js</TargetFilename>
				<TargetFilename name="Macro_Files" condition="contains any">.pptm;.docm;.xlsm;.xlam;.pptm;.potm;.pptm;.sldm</TargetFilename>
				<TargetFilename name="Certificate_Files" condition="contains any">.pem;.crt;.ca-bundle;.cer;.csr;.der;.p7b;.p7r;.p7s;.pfx;.sto;.p12;.crl;.sst;.key</TargetFilename>
				<TargetFilename name="Other_Files" condition="contains any">.application;.appref-ms;.lnk;.appref-ms;.sys;.rdp;.eml;.scf;.mht;.manifest;.cpl;.inf</TargetFilename>
			</Rule>
			<Rule name="HTML_Smuggling" groupRelation="and"> <!-- Track Zone.Identifiers regardless of their download location -->
				<TargetFilename condition="end with">:Zone.Identifier</TargetFilename>
				<Contents condition="contains any">blob:;about:internet</Contents>
			</Rule>
			<TargetFilename condition="end with">:newads</TargetFilename> <!-- CobaltStrike BOF https://github.com/EspressoCake/Self_Deletion_BOF/blob/main/src/main.c -->
			<Hash name="T1562.002,Disable_Windows_Event_Logging,SysmonEnte_Detection" condition="contains">IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE</Hash>
			<Hash name="T1562.002,Disable_Windows_Event_Logging,SysmonQuiet_Detection" condition="contains">IMPHASH=19584675D94829987952432E018D5056</Hash>
			<Hash name="T1562.002,Disable_Windows_Event_Logging,SharpEvtMute_Detection" condition="contains">IMPHASH=330768a4f172e10acb6287b87289d83b</Hash>
		</FileCreateStreamHash>
	</RuleGroup>

	<RuleGroup name="ADS_Exclude_Group" groupRelation="or">
		<FileCreateStreamHash onmatch="exclude">
			<Hash condition="contains">IMPHASH=00000000000000000000000000000000</Hash>
			<TargetFilename condition="contains">AppData\Local\Microsoft\Windows\AppCache\</TargetFilename>
			<TargetFilename condition="contains">\Microsoft\Windows\INetCache\</TargetFilename>
			<TargetFilename condition="contains">\Microsoft\Windows\Temporary Internet Files\Content.IE5</TargetFilename> 
			<TargetFilename condition="contains">\Mozilla\Firefox\Profiles\</TargetFilename>
			<TargetFilename condition="end with">.default\prefs-1.js</TargetFilename>
			<TargetFilename condition="end with">Microsoft\Windows\Start Menu\Programs\Startup</TargetFilename>
		</FileCreateStreamHash>
	</RuleGroup>

	<!--SYSMON EVENT ID 16 : SYSMON CONFIGURATION CHANGE-->
	<!--DATA: UtcTime, Configuration, ConfigurationFileHash-->
	<!--Cannot be filtered.-->

	<!--SYSMON EVENT ID 17 & 18 : PIPE CREATED / PIPE CONNECTED [PipeEvent]-->
	<!--EVENT 17: "Pipe Created"-->
	<!--EVENT 18: "Pipe Connected"-->
	<!--DATA: UtcTime, ProcessGuid, ProcessId, PipeName, Image-->
	<RuleGroup name="PipeEvent_Include_Group" groupRelation="or">
		<PipeEvent onmatch="include">
			<PipeName name="T1055,Process_Injection,Cobalt_Strike_Named_Pipe_Detected" condition="contains any">msagent_;\MSSE-;postex;\status_;\atsvc;\gruntsvc;\svcctl;\msf-pipe</PipeName>
			<PipeName name="T1055,Process_Injection,Cobalt_Strike_Named_Pipe_Detected" condition="contains any">\DserNamedPipe;\mypipe-;\windows.update.manager;\ntsvcs_;scerpc_;\demoagent;\PGMessagePipe;\MsFTeWds;\f4c3;\fullduplex_;\msrpc_;\f53f;\rpc_;\spoolss_;\win_svc;\SearchTextHarvester</PipeName>
			<Rule name="T1055,Process_Injection,Cobalt_Strike_Named_Pipe_Detected" groupRelation="and">
				<PipeName condition="begin with">\Winsock2\CatalogChangeListener-</PipeName>
				<PipeName condition="end with">-0,</PipeName>
			</Rule>
			<Rule name="T1055,Process_Injection,Turla_APT_Named_Pipe_Detection" groupRelation="and">
				<PipeName condition="contains any">\atctl;\userpipe;\iehelper;\sdlrpc;\comnap</PipeName>
			</Rule>
			<Rule name="T1021.002,Windows_Admin_Shares,Lateral_Movement_PSExec_Named_Pipe_Detected" groupRelation="or">
				<PipeName condition="contains">\PSEXESVC</PipeName>
				<PipeName condition="end with">-stdin</PipeName>
				<PipeName condition="end with">-stdout</PipeName>
			</Rule>
			<Rule name="T1021.002,Windows_Admin_Shares,Impacket_PSExec.py_Named_Pipe_Detected" groupRelation="and">
				<PipeName condition="contains">RemCom_</PipeName>
				<PipeName condition="contains any">stdin;stdout;stderr;communication</PipeName>
			</Rule>
			<PipeName name="T1021,Remote_Services,MS-SCMR_Execution" condition="contains">\svcctl</PipeName>
			<PipeName name="T1003,OS_Credential_Dumping,Credential_Dumping_Command_Mimikatz" condition="contains any">\lsadump;\cachedump;\wceservicepipe</PipeName>
			<PipeName name="T1055,Process_Injection,Kekeo_Named_Pipe_Detection" condition="contains">tssmp_endpoint</PipeName>
			<PipeName name="T1055,Process_Injection,cachedump_detected" condition="contains">\cachedumppipe</PipeName>
			<PipeName name="T1055,Process_Injection,csexec_Named_Pipe_Detection" condition="contains">\csexec</PipeName>
			<PipeName name="T1055,Process_Injection,paexec_Named_Pipe_Detection" condition="contains">\paexec</PipeName>
			<PipeName name="T1055,Process_Injection,Turla_HyperStack_Named_Pipe_Detection" condition="begin with">\adschemerpc</PipeName>
			<PipeName name="T1055,Process_Injection,Hidden_Cobra_Hoplight_Named_Pipe_Detection" condition="begin with">\AnonymousPipe</PipeName>
			<PipeName name="T1055,Process_Injection,Pacifier_Named_Pipe_Detection" condition="begin with">\bc367</PipeName>
			<PipeName name="T1055,Process_Injection,Pacifier_Named_Pipe_Detection" condition="begin with">\bc31a7</PipeName>
			<PipeName name="T1055,Process_Injection,Emissary_Panda_Hyerbri Named_Pipe_Detection" condition="begin with">\testPipe</PipeName>
			<PipeName name="T1055,Process_Injection,Malicious_Named_Pipe_Detection" condition="contains any">\isapi_http;\isapi_dg;\isapi_dg2;\sdlrpc;\ahexec;\winsession;\lsassw;\46a676ab7f179e511e30dd2dc41bd388;\9f81f59bc58452127884ce513865ed20;\e710f28d59aa529d6792ca6ff0ca1b34;\rpchlp_3;\NamePipe_MoreWindows;\pcheap_reuse;\gruntsvc;\583da945-62af-10e8-4902-a8f205c72b2e;\bizkaz;\Posh;\jaccdpqnvbrrxlaf</PipeName>
			<PipeName name="T1055,Process_Injection,Malicious_Named_Pipe_Detection" condition="contains any">\atctl;\userpipe;\iehelper;\comnap</PipeName>
			<Rule name="Detect_suspicious_named_pipe_connections_to_an_AD_FS_WID" groupRelation="and"> 
				<EventType condition="is">ConnectPipe</EventType>
				<PipeName condition="is">\MICROSOFT##WID\tsql\query</PipeName>
			</Rule>
			<Rule name="T1055,Process_Injection,EFSPotato_Named_Pipe_Detection" groupRelation="and">
				<PipeName condition="contains any">\pipe\</PipeName>
				<PipeName condition="excludes">CtxSharefilepipe0</PipeName>
			</Rule>
			<PipeName name="Remote_Registry_access_and_enumeration" condition="begin with">\winreg</PipeName>
			<!-- Malleable C2 profiles -->
			<PipeName condition="begin with">\mojo.5688.8052.183894939787088877</PipeName>
			<PipeName condition="begin with">\mojo.5688.8052.35780273329370473</PipeName>
			<PipeName condition="begin with">\demoagent_</PipeName>
			<PipeName condition="begin with">\PGMessagePipe</PipeName>
			<PipeName condition="begin with">\MsFteWds</PipeName>
			<PipeName condition="begin with">\f4c3</PipeName>
			<PipeName condition="begin with">\fullduplex_</PipeName>
			<PipeName condition="begin with">\msrpc_</PipeName>
			<PipeName condition="begin with">\win\msrpc_</PipeName>
			<PipeName condition="begin with">\f53f</PipeName>
			<PipeName condition="begin with">\rpc_</PipeName>
			<PipeName condition="begin with">\spoolss_</PipeName>
			<PipeName condition="begin with">\win_svc</PipeName>
			<PipeName condition="begin with">\SearchTextHarvester</PipeName>
			<!-- Others -->
			<Rule groupRelation="and">
				<PipeName condition="begin with">\</PipeName>
				<EventType>CreatePipe</EventType>
			</Rule>
			<Rule groupRelation="and">
				<PipeName name="T1059.001,PowerShell" condition="begin with">\PSHost</PipeName>
				<Image condition="is not">powershell.exe</Image>
			</Rule>
			<Rule groupRelation="and">
				<PipeName name="T1059.001,PowerShell" condition="begin with">\PSHost</PipeName>
				<Image condition="is not">powershell_ise.exe</Image>
			</Rule>
			<PipeName condition="contains">6e7645c4-32c5-4fe3-aabf-e94c2f4370e7</PipeName> <!-- LiquidSnake hacktool https://github.com/RiccardoAncarani/LiquidSnake -->
			<Image condition="end with">\scrcons.exe</Image> <!-- Susupicious WMI Event Consumer creating a named pipe -->
		</PipeEvent>
	</RuleGroup>

	<RuleGroup name="PipeEvent_Exclude_Group" groupRelation="or">
		<PipeEvent onmatch="exclude">
			<!-- Exclude ConnectPipe for noise reduction -->
			<EventType condition="is">ConnectPipe</EventType>
			<!-- The standard named pipes used by Windows services (we want only the ones that begin with these names) -->
			<PipeName condition="is">\scerpc</PipeName>
			<PipeName condition="is">\wkssvc</PipeName>
			<PipeName condition="is">\spoolss</PipeName>
			<PipeName condition="is">\ntsvcs</PipeName>
			<PipeName condition="contains">lsass</PipeName>
			<!-- Citrix -->
			<Image condition="contains all">C:\Program Files;\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
			<Image condition="contains all">C:\Program Files;\Citrix\ICA Client\Receiver\Receiver.exe</Image>
			<Image condition="contains all">C:\Program Files;\Citrix\ICA Client\wfcrun32.exe</Image>
			<Image condition="contains all">C:\Program Files;\Citrix\ICA Client\concentr.exe</Image>
			<Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\receiver\Receiver.exe</Image>
			<Image condition="contains all">C:\Users\;\AppData\Local\Citrix\ICA Client\SelfServicePlugin\SelfService.exe</Image>
			<!-- Adobe -->
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Common Files\Adobe\ARM\1.0\AdobeARM.exe</Image>
				<PipeName condition="begin with">\32B6B37A-4A7D-4e00-95F2-</PipeName>
				<PipeName condition="end with">thsnYaVieBoda</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Adobe\Acrobat Reader DC\Reader\AcroCEF\RdrCEF.exe</Image>
				<PipeName condition="begin with">\com.adobe.reader.rna.;\mojo</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Common Files\Adobe\AdobeGCClient\AGMService.exe</Image>
				<PipeName condition="begin with">\gc_pipe_</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Common Files\Adobe\Creative Cloud Libraries\libs\node.exe</Image>
				<PipeName condition="begin with">\uv\</PipeName>
			</Rule>
			<!-- Google -->
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Google\Update\Install\;setup.exe</Image>
				<PipeName condition="begin with">\crashpad_</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Google\Chrome\Application\chrome.exe</Image>
				<PipeName condition="begin with">\mojo.</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Google\Chrome\Application\;\Installer\chrmstp.exe</Image>
				<PipeName condition="begin with">\crashpad_</PipeName>
			</Rule>
			<!-- Microsoft -->
			<Image condition="image">C:\Windows\system32\wbem\wmiprvse.exe</Image>
			<Image condition="image">C:\Windows\System32\LxRun.exe</Image>
			<Image condition="image">C:\Windows\System32\SearchIndexer.exe</Image>
			<Image condition="image">C:\Windows\System32\smss.exe</Image>
			<Image condition="image">C:\Windows\System32\spoolsv.exe</Image>
			<Image condition="image">C:\Windows\System32\wininit.exe</Image>
			<Image condition="image">C:\Windows\system32\DFSRs.exe</Image>
			<Image condition="begin with">C:\Windows\SystemApps\Microsoft.Windows</Image>
			<Image condition="is">c:\windows\system32\inetsrv\w3wp.exe</Image>
			<Image condition="image">C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15\BIN\OWSTIMER.EXE</Image>
			<Image condition="image">C:\Windows\syswow64\snmp.exe</Image>
			<Image condition="image">C:\Windows\system32\SearchProtocolHost.exe</Image>
			<Image condition="image">\System</Image>
			<Image condition="contains">Exchange Server</Image>
			<Image condition="image">C:\Windows\system32\dns.exe</Image>
			<PipeName condition="begin with">\M.E.C.Core.WinRMDataCommunicator.NamedPipe.</PipeName>
			<PipeName condition="is">\sql\query</PipeName>
			<Image condition="image">C:\Program Files\Microsoft SQL Server\90\Shared\sqlwriter.exe</Image>
			<PipeName condition="contains">\TDLN-</PipeName>
			<PipeName condition="is">\InitShutdown</PipeName>
			<PipeName condition="is">\W32TIME_ALT</PipeName>
			<PipeName condition="is">\WiFiNetworkManagerTask</PipeName>
			<PipeName condition="is">\Winsock2CatelogChangeListener</PipeName>
			<PipeName condition="is">\browser</PipeName>
			<PipeName condition="is">\epmapper</PipeName>
			<PipeName condition="is">\eventlog</PipeName>
			<PipeName condition="is">\ntapvsrq</PipeName>
			<Rule groupRelation="and">
				<Image condition="begin with">C:\Windows\Microsoft.NET\Framework</Image>
				<Image condition="image">ngen.exe</Image>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="begin with">C:\Windows\SystemApps\ShellExperienceHost_</Image>
				<Image condition="image">ShellExperienceHost.exe</Image>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
				<PipeName condition="begin with">\LOCAL\mojo.</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
				<PipeName condition="begin with">\LOCAL\chrome.sync.</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Microsoft\Edge\Application\msedge.exe</Image>
				<PipeName condition="begin with">\LOCAL\crashpad_</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Microsoft Office\root\Office16\OUTLOOK.EXE</Image>
				<PipeName condition="is">\MsFteWds</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
				<PipeName condition="begin with">\mojo.</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Users\;\AppData\Local\Microsoft\Teams\current\Teams.exe</Image>
				<PipeName condition="begin with">\chrome.sync.</PipeName>
			</Rule>
			<!-- Mozilla -->
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
				<PipeName condition="begin with">\cubeb-pipe-</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
				<PipeName condition="begin with">\chrome.</PipeName>
			</Rule>
			<Rule groupRelation="and">
				<Image condition="contains all">C:\Program Files;\Mozilla Firefox\firefox.exe</Image>
				<PipeName condition="begin with">\gecko-crash-server-pipe.</PipeName>
			</Rule>
			<!-- Trend Micro -->
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\CMAgent\OfcCMAgent.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\ofcservice.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\Web\Service\DbServer.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\verconn.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiOnClose.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WEB_OSCE\WEB\CGI\cgiRqHotFix.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\LWCS\LWCSService.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\WSS\iCRCService.exe</Image>
			<Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc.exe</Image>
			<Image condition="end with">Program Files\Trend\SPROTECT\x64\tsc64.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\osceintegrationservice.exe</Image>
			<Image condition="end with">Program Files (x86)\Trend Micro\OfficeScan\PCCSRV\web\service\OfcLogReceiverSvc.exe</Image>
			<PipeName condition="is">\Trend Micro OSCE Command Handler Manager</PipeName>
			<PipeName condition="is">\Trend Micro OSCE Command Handler2 Manager</PipeName>
			<PipeName condition="is">\Trend Micro Endpoint Encryption ToolBox Command Handler Manager</PipeName>
			<!-- Others -->
			<Image condition="is">"C:\Program Files\Microsoft Monitoring Agent\Agent\MonitoringHost.exe"</Image>
			<Rule groupRelation="and">
				<Image condition="contains all"> C:\Users\;\AppData\Local\Programs\Call Manager\Call Manager.exe</Image>
				<PipeName condition="begin with">\crashpad_;\mojo.;\uv\</PipeName>
			</Rule>
			<Image condition="contains all">C:\Program Files;\FireEye\xagt\xagt.exe</Image>
			<PipeName condition="begin with">\Vivisimo Velocity</PipeName>
			<PipeName condition="is">\SQLLocal\MSSQLSERVER</PipeName>
			<PipeName condition="is">\SQLLocal\INSTANCE01</PipeName>
			<PipeName condition="is">\SQLLocal\SQLEXPRESS</PipeName>
			<PipeName condition="is">\SQLLocal\COMMVAULT</PipeName>
			<PipeName condition="is">\SQLLocal\RTCLOCAL</PipeName>
			<PipeName condition="is">\SQLLocal\RTC</PipeName>
			<PipeName condition="is">\SQLLocal\TMSM</PipeName>
			<Image condition="is">Program Files (x86)\Microsoft SQL Server\110\DTS\binn\dtexec.exe</Image>
			<Image condition="end with">PostgreSQL\9.6\bin\postgres.exe</Image>
			<PipeName condition="contains">\pgsignal_</PipeName>
			<Image condition="is">Program Files\Qlik\Sense\Engine\Engine.exe</Image>
			<Image condition="contains all">C:\Program Files;\Qualys\QualysAgent\QualysAgent.exe</Image>
			<Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunkd.exe</Image>
			<Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk.exe</Image>
			<Image condition="end with">Program Files\SplunkUniversalForwarder\bin\splunk-MonitorNoHandle.exe</Image>
			<PipeName condition="is">\OfcServerNamePipe</PipeName>
			<PipeName condition="contains">ProtectedPrefix\LocalService\FTHPIPE</PipeName>
			<PipeName condition="contains">vmware-</PipeName>
			<PipeName condition="contains">Anonymous Pipe</PipeName>
		</PipeEvent>
	</RuleGroup>

	<!--SYSMON EVENT ID 19 & 20 & 21 : WMI EVENT MONITORING [WmiEvent]-->
	<!--EVENT 19: "WmiEventFilter activity detected"-->
	<!--EVENT 20: "WmiEventConsumer activity detected"-->
	<!--EVENT 21: "WmiEventConsumerToFilter activity detected"-->
	<!--DATA: EventType, UtcTime, Operation, User, Name, Type, Destination, Consumer, Filter-->
	<RuleGroup name="WmiEvent_Include_Group" groupRelation="or">
		<WmiEvent onmatch="include">
		  	<Operation name="T1047,Windows_Management_Instrumentation" condition="is">Created</Operation>
		</WmiEvent>
	</RuleGroup>

	<!--SYSMON EVENT ID 22 : DNS QUERY [DnsQuery]-->
	<!--NOTE: Due to the volume of events that DNS queries generate, some orgs may want to remove this section from their configuration to reduce Sysmon log turnover. -->
	<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, QueryName, QueryType, QueryStatus, QueryResults (can't filter on)-->
	<RuleGroup name="DnsQuery_Include_Group" groupRelation="or">
		<DnsQuery onmatch="include">
			<Rule name="T1048,Exfiltration_Over_Alternative_Protocol,Powershell_TXT_Record_exfiltration" groupRelation="and">
				<QueryResults condition="contains any">type: 16;type:  16</QueryResults>
				<Image condition="image">powershell.exe</Image>
			</Rule>
			<Rule name="T1059,Powershell,Powershell_Connection_to_github" groupRelation="and">
				<QueryName condition="contains">github</QueryName>
				<Image condition="image">powershell.exe</Image>
			</Rule>
			<Rule name="Suspicious_DNS_Requests" groupRelation="and">
				<Image condition="contains any">powershell;cscript.exe;wscript.exe;mshta.exe;bitsadmin.exe;\cmd.exe</Image>
				<QueryName condition="contains">.</QueryName>
			</Rule>
			<Rule name="T1567.002,Exfiltration_to_Cloud_Storage,Dropbox_Cloud_Exfiltration" groupRelation="and">
				<QueryName condition="end with">dropboxapi.com</QueryName>
				<Image condition="excludes any">\Dropbox\Client\Dropbox.exe;\Dropbox\bin\Dropbox.exe;\Oracle\Java\</Image>
			</Rule>
			<Rule name="T1567.002,Exfiltration_to_Cloud_Storage,OneDrive_Cloud_Exfiltration" groupRelation="and">
				<QueryName condition="contains">1drv</QueryName>
				<Image condition="excludes any">\AppData\Local\Microsoft\OneDrive\OneDrive.exe;C:\Program Files (x86)\Google\Chrome\Application\chrome.exe;\Internet Explorer\iexplore.exe;C:\Windows\System32\AppHostRegistrationVerifier.exe;C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe;C:\Program Files (x86)\BraveSoftware\Brave-Browser\Application\brave.exe;C:\Program Files (x86)\Microsoft OneDrive\OneDrive.exe;C:\Program Files\Mozilla Firefox\firefox.exe</Image>
			</Rule>
			<QueryName name="T1567.002,Exfiltration_to_Cloud_Storage,Box.com_Cloud_Exfiltration" condition="contains all">.box.com;upload</QueryName>
			<QueryName name="T1567.002,Exfiltration_to_Cloud_Storage,Mega.co.nz_Cloud_Exfiltration" condition="contains any">mega.nz;mega.co.nz</QueryName>
			<QueryName name="T1567.002,Exfiltration_to_Cloud_Storage,Privatlab_Cloud_Exfiltration" condition="contains any">privatlab.com</QueryName>
			<QueryName name="T1195,Supply_Chain_Compromise,Solarwinds/FireEye_sunburst_domains" condition="contains any">thedoccloud.com;deftsecurity.com;websitetheme.com;highdatabase.com;incomeupdate.com;zupertech.com;panhardware.com;databasegalore.com;avsvmcloud.com;freescanonline.com</QueryName>
			<QueryName name="Social_Networking" condition="contains any">tiktok;parler.com;gab.com;mewe.com;4chan;8chan;facebook;fbcdn;twitter;instagram;snapchat</QueryName>
			<QueryName name="Internet_Relay_Chat" condition="contains any">efnet;undernet;freenode;ircnet;.rizon;quakenet;oftc.net;dalnet</QueryName>
			<QueryName name="Internet_Chat" condition="contains any">.slack.com;discord.;telegram.;rocketchat.;mattermost.;flock.com</QueryName>
			<QueryName name="T1595,Active_Scanning,Advanced_IP_scanner_Detected" condition="contains any">advanced-ip-scanner.com</QueryName>
			<QueryName name="T1496,Resource_Hijacking,Crypto_Currency_Miner_Detected" condition="contains any">0x1f4b0.com;1q2w3.life;1q2w3.website;31.187.64.216;185.193.38.148;aalbbh84.info;adfreetv.ch;adless.io;adplusplus.fr;adrenali.gq;ajcryptominer.com;ajplugins.com;allfontshere.press;altavista.ovh;amhixwqagiz.ru;appelamule.com;arizona-miner.tk;aster18cdn.nl;aster18prx.nl;avero.xyz;averoconnector.com;bauersagtnein.myeffect.net;bhzejltg.info;blazepool;blockmasters;blockmasterscoins;bmnr.pw;bmst.pw;bohemianpool;carry.myeffect.net;cashbeet.com;cdn-code.host;cfceu.duckdns.org;cfcnet.gdn;cfcnet.top;cfcs1.duckdns.org;chainblock.science;cieh.mx;coin-hive.com;coin-service.com;coin-services.info;coiner.site;coinpirate.cf;coinrail.io;coinwebmining.com;cpu2cash.link;cryptaloot.pro;cryptmonero;crypto-loot.com;crypto-pool;crypto-webminer.com;cryptoloot.pro;d-ns.ga;dataservices.download;directprimal.com;dwarfpool;encoding.ovh;eth-pocket.com;eth-pocket.de;eth-pocket.eu;ethereum-pocket.de;ethereum-pocket.eu;ethtrader.de;eu.nimpool.io;eu.sushipool.com;f1tbit.com;flnqmin.org;freecontent.bid;freecontent.date;freecontent.loan;freecontent.racing;freecontent.stream;freecontent.win;gnrdomimplementation.com;graftpool.ovh;greenindex.dynamic-dns.net;gustaver.ddns.net;hashrefinery;hashvault.pro;herphemiste.com;hide.ovh;hk.rs;hlpidkr.ru;hodlers.party;hodling.faith;hostingcloud.win;hrfziiddxa.ru;ihdvilappuxpgiv.ru;imhvlhaelvvbrq.ru;insdrbot.com;irrrymucwxjl.ru;istlandoll.com;ivuovhsn.ru;iwanttoearn.money;ixvenhgwukn.ru;jqassets.download;jqr-cdn.download;jqrcdn.download;jquerrycdn.download;jqwww.download;jqxrrygqnagn.ru;jscoinminer.com;jwduahujge.ru;ksimdw.ru;l33tsite.info;laferia.cr;ledhenone.com;ltstyov.ru;mepirtedic.com;mine.bz;minercircle.com;minercry.pt;minergate;minero.cc;miners.pro;minescripts.info;mininghub.club;miningpoolhubcoins;minr.pw;mixpools.org;mmc.center;mollnia.com;monerise.com;monero.lindon-pool.win;monero;moriaxmr.com;munero.me;mxcdn1.now.sh;mxcdn2.now.sh;myadstats.com;mypool.online;nablabee.com;nanopool.org;nathetsof.com;nicehash;nimiqpool.com;node.philpool.com;npcdn1.now.sh;nunu-001.now.sh;ogondkskyahxa.ru;ogrid.org;oinkinns.tk;olecintri.com;omine.org;onvid.club;open-hive-server-1.pp.ua;oxwwoeukjispema.ru;pcejuyhjucmkiny.ru;pool.nimiq.watch;pool.nimiqchain.info;pool.porkypool.com;pool.xmr;poolto.be;prohash.net;prohash;proj2018.xyz;pzoifaum.info;ratchetmining.com;realnetwrk.com;reauthenticator.com;rove.cl;ruvuryua.ru;s7ven.com;scaleway.ovh;sentemanactri.com;sickrage.ca/ch;sighash.info;slushpool;soodatmish.com;sparechange.io;statdynamic.com;stati.bid;staticsfs.host;streamplay.to;suprnova.cc;svivqrhrh.ru;sxcdn02.now.sh;sxcdn3.now.sh;sxcdn4.now.sh;sxcdn6.now.sh;synconnector.com;teracycle.net;tercabilis.info;thelifeisbinary.ddns.net;thersprens.com;torrent.pw;ulnawoyyzbljc.ru;unrummaged.com;uoldid.ru;usxmrpool;viaxmr.com;vpzccwpyilvoyg.ru;vzzexalcirfgrf.ru;wbmwss.beetv.net;webmine.cz;webmine.pro;webminepool.tk;webminerpool.com;webwidgetz.duckdns.org;wmemsnhgldd.ru;wmtech.website;wmwmwwfmkvucbln.ru;wrxgandsfcz.ru;xmrm.pw;xmrminingproxy.com;xmrpool;yiimp;yuyyio.com;zavzlen.ru;zergpool;zergpoolcoins;ziykrgc.ru;zlx.com.br;zpool;analytics.blue;estream.to</QueryName>
			<QueryName name="Suspicious_Domain" condition="contains any">kuternull.com;rimrun.com;0ffice36o;asushotfix;infestexe;rahasn.webhop.org;rahasn.akamake.net;rahasn.homewealth.biz;winodwsupdates;israirairlines</QueryName>
			<QueryName name="T1311,Dynamic_DNS,Common_Malware_Hosting_Domain" condition="contains any">tiny-share.com;paste.ee;pastebin.com</QueryName>
			<QueryName name="T1311,Dynamic_DNS,Dynamic_DNS_Query" condition="contains any">afraid.org;duckdns.org;changeip.com;ddns.net;hopto.org;zapto.org;servehttp.com;sytes.net;whoer.net;bravica.net;ip.webmasterhome.cn;whatsmyip.us;myip.kz;ip-addr.es;curlmyip;anysrc.net;anysrc.net;dlinkddns.com;no-ip.com;no-ip.org;no-ip.biz;no-ip.info;noip.com</QueryName>
			<QueryName name="T1188,Multi-hop_Proxy,Tor2Web" condition="contains any">darknet.to;hiddenservice.net;onion.cab;onion.city;onion.direct;onion.nu;onion.pet;onion.plus;onion.rip;onion.sh;onion.si;onion.to;onion.top;onion.ws;tor-gateways.de;tor2net.com;tor2web.blutmagie.de;tor2web.fi;tor2web.info;tor2web.io;tor2web.org</QueryName>
			<QueryName name="T1048,Exfiltration_Over_Alternative_Protocol,DNS_Over_HTTPS_Detected" condition="contains any">adblock.mydns.network;ibksturm.synology.me;jcdns.fun;ibuki.cgnat.net;dns.twnic.tw;commons.host;doh.dnswarden.com;dns-nyc.aaflalo.me;dns.aaflalo.me;doh.appliedprivacy.net;doh.captnemo.in;doh.tiar.app;doh.tiarap.org;doh.defaultroutes.de;doh.dns.sb;dns.oszx.co;2.dnscrypt-cert.oszx.co;dnscrypt;edns.233py.com;hk-dns.233py.com;hk2dns.233py.com;hkdns.233py.com;hkdns.233py.com;ndns.233py.com;sdns.233py.com;wdns.233py.com;pastebin.com;dns.adguard.com;dns-family.adguard.com;security-filter-dns.cleanbrowsing.org;family-filter-dns.cleanbrowsing.org;adult-filter-dns.cleanbrowsing.org;cloudflare-dns.com;mozilla.cloudflare-dns.com;dns.233py.com;dns.aaflalo.me;dns.google;doh.opendns.com;dns.quad9.net;dns9.quad9.net;dns10.quad9.net;dns11.quad9.net;doh.xfinity.com;dns.nextdns.io;dns.dnsoverhttps.net;doh.crypto.sx;doh.powerdns.org;doh-ch.blahdns.com;doh-de.blahdns.com;dns.rubyfish.cn;dns.containerpi.com;doh-2.seby.io;doh.seby.io;rdns.faelix.net;doh.li;doh.armadillodns.net;doh.netweaver.uk;doh.42l.fr;dns.aa.net.uk</QueryName>
			<QueryName name="Download_TLD_DNS_Query" condition="end with">.download</QueryName>
			<QueryName name="North Korea_TLD_DNS_Query" condition="end with">.kp</QueryName>
			<QueryName name="Soviet Union_TLD_DNS_Query" condition="end with">.su</QueryName>
			<QueryName name="Sudan_TLD_DNS_Query" condition="end with">.ss</QueryName>
			<QueryName name="Suspicious_TLD_.xn_DNS_Query" condition="end with">.xn</QueryName>
			<QueryName name="Syria_TLD_DNS_Query" condition="end with">.sy</QueryName>
			<QueryName name="Venezuela_TLD_DNS_Query" condition="end with">.ve</QueryName>
			<QueryName name="XXX_TLD_DNS_Query" condition="end with">.xxx</QueryName>
			<QueryName name="China_TLD_DNS_Query" condition="end with">.cn</QueryName>
			<QueryName name="Click_TLD_DNS_Query" condition="end with">.click</QueryName>
			<QueryName name="Club_TLD_DNS_Query" condition="end with">.club</QueryName>
			<QueryName name="IRAN_TLD_DNS_Query" condition="end with">.ir</QueryName>
			<QueryName name="Russian_TLD_DNS_Query" condition="end with">.ru</QueryName>
			<QueryName name="Suspicious_TLD_.Host_DNS_Query" condition="end with">.host</QueryName>
			<QueryName name="Suspicious_TLD_.ICU_DNS_Query" condition="end with">.icu</QueryName>
			<QueryName name="Suspicious_TLD_.PW_DNS_Query" condition="end with">.pw</QueryName>
			<QueryName name="Suspicious_TLD_.WEBSITE_DNS_Query" condition="end with">.website</QueryName>
			<QueryName name="Suspicious_TLD_.ninja_DNS_Query" condition="end with">.ninja</QueryName>
			<QueryName name="Suspicious_TLD_.rocks_DNS_Query" condition="end with">.rocks</QueryName>
			<QueryName name="Top_TLD_DNS_Query" condition="end with">.top</QueryName>
			<QueryName name="Ukraine_TLD_DNS_Query" condition="end with">.ua</QueryName>
			<QueryName name="XYZ_TLD_DNS_Query" condition="end with">.xyz</QueryName>
			<Rule name="Suspicious_LDAP_Lookup" groupRelation="and"> <!-- Useful for identifying tools like sharphound -->
				<QueryName condition="begin with">_ldap.</QueryName>
				<Image condition="excludes">C:\Windows\</Image>
				<Image condition="excludes">unknown process</Image>
				<Image condition="excludes all">C:\ProgramData\Microsoft\Windows Defender\Platform\;\Windows Defender\MsMpEng.exe;C:\Windows\</Image>
			</Rule>
			<Image name="Uncategorized_Events" condition="contains any">System;svchost.exe;services.exe;unknown process;\;;</Image>
		</DnsQuery>
	</RuleGroup>

	<RuleGroup name="DnsQuery_Exclude_Group" groupRelation="or">
		<DnsQuery onmatch="exclude">
			<!-- Image Exclusions -->
			<Image condition="begin with">C:\Program Files (x86)\Admin Arsenal\</Image>
			<Image condition="begin with">C:\Program Files (x86)\CheckPoint\</Image>
			<Image condition="begin with">C:\Program Files (x86)\Fortinet\</Image>
			<Image condition="begin with">C:\Program Files (x86)\OpenDNS\OpenDNS Connector</Image>
			<Image condition="begin with">C:\Program Files (x86)\Razer\Razer Services\</Image>
			<Image condition="begin with">C:\Program Files (x86)\Trend Micro\</Image>
			<Image condition="begin with">C:\Program Files (x86)\VMware</Image>
			<Image condition="begin with">C:\Program Files (x86)\Veeam\</Image>
			<Image condition="begin with">C:\Program Files\CheckPoint\</Image>
			<Image condition="begin with">C:\Program Files\Trend Micro\</Image>
			<Image condition="image">Slack.exe</Image>
			<Image condition="image">ConnectWise.exe</Image>
			<Image condition="image">git-remote-https.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Enpass\Enpass.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Fiserv\Vision\VisionGUI.NET.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Fortinet\FortiClient\update_task.exe</Image>
			<Image condition="image">C:\Program Files (x86)\Lenovo\System Update\Tvsukernel.exe</Image>
			<Image condition="image">C:\Program Files\VMware\vCenter Server\jre\bin\java.exe</Image>
			<Image condition="image">C:\Program Files\VMware\vCenter Server\python\python.exe</Image>
			<Image condition="image">C:\Windows\SysWOW64\SearchProtocolHost.exe</Image>
			<Image condition="image">C:\Windows\System32\dsregcmd.exe</Image>
			<Image condition="image">C:\Windows\sysmon64.exe</Image>
			<Image condition="image">C:\Windows\sysmon.exe</Image>
			<Image condition="is">C:\Program Files\Windows Defender Advanced Threat Protection\MsSense.exe</Image>
			<Image condition="contains all">C:\Program Files\SentinelOne\Sentinel Agent;\SentinelAgent.exe</Image>
			<Image condition="contains all">C:\Windows\SystemApps\Microsoft.Windows.Search;SearchApp.exe</Image>
			<!--Network noise-->
			<QueryName condition="end with">.arpa.</QueryName> <!--Design decision to not log reverse DNS lookups. You will need to decide.-->
			<QueryName condition="end with">.arpa</QueryName> <!--Design decision to not log reverse DNS lookups. You will need to decide.-->
			<QueryName condition="end with">.msftncsi.com</QueryName> <!--Microsoft proxy detection | Microsoft default exclusion-->
			<QueryName condition="is">..localmachine</QueryName>
			<QueryName condition="is">localhost</QueryName>
			<!--Microsoft-->
			<QueryName condition="end with">-pushp.svc.ms</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.b-msedge.net</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.bing.com</QueryName> <!-- Microsoft | Microsoft default exclusion -->
			<QueryName condition="end with">.hotmail.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.live.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.live.net</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.microsoft.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.microsoftonline.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.microsoftstore.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.ms-acdc.office.com</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.msedge.net</QueryName> <!--Microsoft: Doesn't appear to host customer content or subdomains-->
			<QueryName condition="end with">.msn.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.msocdn.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.s-microsoft.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.skype.com</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.skype.net</QueryName> <!--Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.windows.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.windows.net.nsatc.net</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.windowsupdate.com</QueryName> <!--Microsoft-->
			<QueryName condition="end with">.xboxlive.com</QueryName> <!--Microsoft-->
			<QueryName condition="is">login.windows.net</QueryName> <!--Microsoft-->
			<Image condition="begin with">C:\ProgramData\Microsoft\Windows Defender\Platform\</Image> <!--Microsoft: https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/network-protection -->
			<QueryName condition="is">outlook.office.com</QueryName>
			<QueryName condition="is">statics.teams.cdn.office.net</QueryName>
			<QueryName condition="is">osi.office.net</QueryName>
			<!--Microsoft:Office365/AzureAD-->
			<QueryName condition="end with">.activedirectory.windowsazure.com</QueryName> <!--Microsoft: AzureAD-->
			<QueryName condition="end with">.aria.microsoft.com</QueryName> <!--Microsoft: OneDrive/SharePoint-->
			<QueryName condition="end with">.msauth.net</QueryName>
			<QueryName condition="end with">.msftauth.net</QueryName>
			<QueryName condition="end with">.office.net</QueryName> <!--Microsoft: Office-->
			<QueryName condition="end with">.opinsights.azure.com</QueryName> <!--Microsoft: AzureAD/InTune client event monitoring-->
			<QueryName condition="end with">.office365.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="is">acdc-direct.office.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="is">atm-fp-direct.office.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="is">loki.delve.office.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="is">management.azure.com</QueryName> <!--Microsoft: AzureAD/InTune-->
			<QueryName condition="is">messaging.office.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="is">portal.azure.com</QueryName> <!--Microsoft: AzureAD/InTune-->
			<QueryName condition="is">protection.outlook.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="is">substrate.office.com</QueryName> <!--Microsoft: Office-->
			<QueryName condition="end with">.measure.office.com</QueryName> <!--Microsoft: Office-->
			<!--3rd-party applications-->
			<QueryName condition="end with">.adobe.com</QueryName> <!--Adobe-->
			<QueryName condition="end with">.adobe.io</QueryName> <!--Adobe-->
			<QueryName condition="end with">.mozaws.net</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.mozilla.com</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.mozilla.net</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.mozilla.org</QueryName> <!--Mozilla-->
			<QueryName condition="end with">.spotify.com</QueryName> <!--Spotify-->
			<QueryName condition="end with">.spotify.map.fastly.net</QueryName> <!--Spotify-->
			<QueryName condition="end with">.wbx2.com</QueryName> <!--Webex-->
			<QueryName condition="end with">.webex.com</QueryName> <!--Webex-->
			<QueryName condition="end with">googleapis.com</QueryName> <!--Google-->
			<QueryName condition="is">clients1.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients2.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients3.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients4.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients5.google.com</QueryName> <!--Google-->
			<QueryName condition="is">clients6.google.com</QueryName> <!--Google-->
			<QueryName condition="is">id.google.com</QueryName> <!--Google-->
			<!--Goodlist CDN-->
			<QueryName condition="end with">.akadns.net</QueryName> <!--AkamaiCDN, extensively used by Microsoft | Microsoft default exclusion-->
			<QueryName condition="end with">.netflix.com</QueryName>
			<QueryName condition="end with">aspnetcdn.com</QueryName> <!--Microsoft [ https://docs.microsoft.com/en-us/aspnet/ajax/cdn/overview ]-->
			<QueryName condition="is">cdnjs.cloudflare.com</QueryName> <!--Cloudflare: Hosts popular javascript libraries-->
			<QueryName condition="end with">.typekit.net</QueryName> <!--Adobe fonts-->
			<QueryName condition="is">cdnjs.cloudflare.com</QueryName>
			<QueryName condition="end with">.stackassets.com</QueryName> <!--Stack Overflow-->
			<QueryName condition="end with">.steamcontent.com</QueryName>
			<QueryName condition="is">play.google.com</QueryName>
			<!--Web resources-->
			<QueryName condition="end with">.disqus.com</QueryName> <!--Microsoft default exclusion-->
			<QueryName condition="end with">.fontawesome.com</QueryName>
			<QueryName condition="is">disqus.com</QueryName> <!--Microsoft default exclusion-->
			<!--Ads-->
			<QueryName condition="end with">.1rx.io</QueryName> <!--Ads-->
			<QueryName condition="end with">.2mdn.net</QueryName> <!--Ads: Google | Microsoft default exclusion-->
			<QueryName condition="end with">.3lift.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adadvisor.net</QueryName> <!--Ads: Neustar [ https://better.fyi/trackers/adadvisor.net/ ] -->
			<QueryName condition="end with">.adap.tv</QueryName> <!--Ads:AOL | Microsoft default exclusion [ https://www.crunchbase.com/organization/adap-tv ] -->
			<QueryName condition="end with">.addthis.com</QueryName> <!--Ads:Oracle | Microsoft default exclusion [ https://en.wikipedia.org/wiki/AddThis ] -->
			<QueryName condition="end with">.adform.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.adnxs.com</QueryName> <!--Ads: AppNexus | Microsoft default exclusion-->
			<QueryName condition="end with">.adroll.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adrta.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adsafeprotected.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.adsrvr.org</QueryName> <!--Ads-->
			<QueryName condition="end with">.adsymptotic.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.advertising.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.agkn.com</QueryName> <!--Ads | [ https://www.home.neustar/privacy ] -->
			<QueryName condition="end with">.amazon-adsystem.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.analytics.yahoo.com</QueryName> <!--Ads:Yahoo-->
			<QueryName condition="end with">.aol.com</QueryName> <!--Ads | Microsoft default exclusion -->
			<QueryName condition="end with">.betrad.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.bidswitch.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.casalemedia.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.chartbeat.net</QueryName> <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/chartbeat.com/ ]-->
			<QueryName condition="end with">.cnn.com</QueryName> <!-- Microsoft default exclusion-->
			<QueryName condition="end with">.convertro.com</QueryName> <!--Ads:Verizon-->
			<QueryName condition="end with">.criteo.com</QueryName> <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
			<QueryName condition="end with">.criteo.net</QueryName> <!--Ads [ https://better.fyi/trackers/criteo.com/ ] -->
			<QueryName condition="end with">.crwdcntrl.net</QueryName> <!--Ads: Lotame [ https://better.fyi/trackers/crwdcntrl.net/ ] -->
			<QueryName condition="end with">.demdex.net</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.domdex.com</QueryName> 
			<QueryName condition="end with">.dotomi.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.doubleclick.net</QueryName> <!--Ads:Conversant | Microsoft default exclusion [ https://www.crunchbase.com/organization/dotomi ] -->
			<QueryName condition="end with">.doubleverify.com</QueryName> <!--Ads: Google-->
			<QueryName condition="end with">.emxdgt.com</QueryName> <!--Ads: EMX-->
			<QueryName condition="end with">.everesttech.net</QueryName> <!--Ads | [ https://better.fyi/trackers/everesttech.net/ ] -->
			<QueryName condition="end with">.exelator.com</QueryName> <!--Ads:Nielson Marketing Cloud-->
			<QueryName condition="end with">.google-analytics.com</QueryName> <!--Ads:Google | Microsoft default exclusion-->
			<QueryName condition="end with">.googleadservices.com</QueryName> <!--Google-->
			<QueryName condition="end with">.googlesyndication.com</QueryName> <!--Ads:Google, sometimes called during malicious ads, but not directly responsible | Microsoft default exclusion [ https://www.hackread.com/wp-content/uploads/2018/06/Bitdefender-Whitepaper-Zacinlo.pdf ]-->
			<QueryName condition="end with">.googletagmanager.com</QueryName> <!--Google-->
			<QueryName condition="end with">.googlevideo.com</QueryName> <!--Google | Microsoft default exclusion-->
			<QueryName condition="end with">.gstatic.com</QueryName> <!--Google | Microsoft default exclusion-->
			<QueryName condition="end with">.gvt1.com</QueryName> <!--Google-->
			<QueryName condition="end with">.gvt2.com</QueryName> <!--Google-->
			<QueryName condition="end with">.ib-ibi.com</QueryName> <!--Ads: Offerpath [ https://better.fyi/trackers/ib-ibi.com/ ] -->
			<QueryName condition="end with">.jivox.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.krxd.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.lijit.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.mathtag.com</QueryName> <!--Microsoft default exclusion-->
			<QueryName condition="end with">.moatads.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.moatpixel.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.mookie1.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.myvisualiq.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.netmng.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.nexac.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.openx.net</QueryName> <!--Ads-->
			<QueryName condition="end with">.optimizely.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.outbrain.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.pardot.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.phx.gbl</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.pinterest.com</QueryName> <!--Pinerest-->
			<QueryName condition="end with">.pubmatic.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.quantcount.com</QueryName>
			<QueryName condition="end with">.quantserve.com</QueryName>
			<QueryName condition="end with">.revsci.net</QueryName> <!--Ads:Omniture | Microsoft default exclusion-->
			<QueryName condition="end with">.rfihub.net</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.rlcdn.com</QueryName> <!--Ads: Rapleaf [ https://better.fyi/trackers/rlcdn.com/ ] -->
			<QueryName condition="end with">.rubiconproject.com</QueryName> <!--Ads: Rubicon Project | Microsoft default exclusion [ https://better.fyi/trackers/rubiconproject.com/ ] -->
			<QueryName condition="end with">.scdn.co</QueryName> <!--Spotify-->
			<QueryName condition="end with">.scorecardresearch.com</QueryName> <!--Ads: Comscore | Microsoft default exclusion-->
			<QueryName condition="end with">.serving-sys.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.sharethrough.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.simpli.fi</QueryName>
			<QueryName condition="end with">.sitescout.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.smartadserver.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.snapads.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.spotxchange.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.taboola.com</QueryName> <!--Ads:Taboola-->
			<QueryName condition="end with">.taboola.map.fastly.net</QueryName> <!--Ads:Taboola-->
			<QueryName condition="end with">.tapad.com</QueryName>
			<QueryName condition="end with">.tidaltv.com</QueryName> <!--Ads: Videology [ https://better.fyi/trackers/tidaltv.com/ ] -->
			<QueryName condition="end with">.trafficmanager.net</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.tremorhub.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.tribalfusion.com</QueryName> <!--Ads: Exponential [ https://better.fyi/trackers/tribalfusion.com/ ] -->
			<QueryName condition="end with">.turn.com</QueryName> <!--Ads | Microsoft default exclusion [ https://better.fyi/trackers/turn.com/ ] -->
			<QueryName condition="end with">.twimg.com</QueryName> <!--Ads | Microsoft default exclusion-->
			<QueryName condition="end with">.tynt.com</QueryName> <!--Ads-->
			<QueryName condition="end with">.w55c.net</QueryName> <!--Ads:dataxu-->
			<QueryName condition="end with">.ytimg.com</QueryName> <!--Google-->
			<QueryName condition="end with">.zorosrv.com</QueryName> <!--Ads:Taboola-->
			<QueryName condition="end with">ads.yahoo.com</QueryName> <!--Ads: Yahoo-->
			<QueryName condition="is">1rx.io</QueryName> <!--Ads-->
			<QueryName condition="is">adservice.google.com</QueryName> <!--Google-->
			<QueryName condition="is">ampcid.google.com</QueryName> <!--Google-->
			<QueryName condition="is">d29x207vrinatv.cloudfront.net</QueryName> <!--Amazon-developed applications-->
			<QueryName condition="is">googleadapis.l.google.com</QueryName> <!--Google-->
			<QueryName condition="is">l.google.com</QueryName> <!--Google-->
			<QueryName condition="is">ml314.com</QueryName> <!--Ads-->
			<QueryName condition="is">mtalk.google.com</QueryName> <!--Google-->
			<QueryName condition="is">www.googletagservices.com</QueryName> <!--Google-->
			<!--SocialNet-->
			<QueryName condition="end with">.pscp.tv</QueryName> <!--Twitter:Periscope-->
			<!--OSCP/CRL Common-->
			<QueryName condition="contains">adsniper.ru</QueryName>
			<QueryName condition="contains">cdnvideo.ru</QueryName>
			<QueryName condition="contains">chat.minergate.com</QueryName>
			<QueryName condition="contains">cwsa.minergate.com</QueryName>
			<QueryName condition="contains">forum.minergate.com</QueryName>
			<QueryName condition="contains">leadlab.click</QueryName>
			<QueryName condition="contains">pool.ntp.org</QueryName>
			<QueryName condition="contains">vmg.host</QueryName>
			<QueryName condition="contains">yandex.ru</QueryName>
			<QueryName condition="end with">.autodesk.com</QueryName>
			<QueryName condition="end with">.avast.com</QueryName>
			<QueryName condition="end with">.avcdn.net</QueryName>
			<QueryName condition="end with">.cdn.bitdefender.net</QueryName>
			<QueryName condition="end with">.digicert.com</QueryName>
			<QueryName condition="end with">.eset.com</QueryName>
			<QueryName condition="end with">.globalsign.com</QueryName>
			<QueryName condition="end with">.globalsign.net</QueryName>
			<QueryName condition="end with">.intuit.com</QueryName>
			<QueryName condition="end with">.java.com</QueryName>
			<QueryName condition="end with">.macromedia.com</QueryName>
			<QueryName condition="end with">.oracle.com</QueryName>
			<QueryName condition="end with">.quickbooks.com</QueryName>
			<QueryName condition="end with">.usertrust.com</QueryName>
			<QueryName condition="end with">amazontrust.com</QueryName>
			<QueryName condition="end with">ocsp.identrust.com</QueryName>
			<QueryName condition="end with">pki.goog</QueryName>
			<QueryName condition="is">ads.playground.xyz</QueryName>
			<QueryName condition="is">citrixupdates.cloud.com</QueryName>
			<QueryName condition="is">forticlient.fortinet.net</QueryName>
			<QueryName condition="is">mft10.onbaseonline.com</QueryName>
			<QueryName condition="contains">msocsp.com</QueryName> <!--Microsoft:OCSP-->
			<QueryName condition="end with">.intel.com</QueryName>
			<QueryName condition="end with">.symcb.com</QueryName> <!--Digicert-->
			<QueryName condition="end with">.symcd.com</QueryName> <!--Digicert-->
			<QueryName condition="end with">.thawte.com</QueryName>
			<QueryName condition="end with">.verisign.com</QueryName>
			<QueryName condition="is">ocsp.comodoca.com</QueryName>
			<QueryName condition="is">ocsp.entrust.net</QueryName>
			<QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
			<QueryName condition="is">ocsp.godaddy.com</QueryName>
			<QueryName condition="is">ocsp.cybertrust.ne.jp</QueryName>
			<QueryName condition="is">ocsp.quovadisglobal.com</QueryName>
			<QueryName condition="is">ocsp.quovadisoffshore.com</QueryName>
			<QueryName condition="is">ocsp.starfieldtech.com</QueryName>
			<QueryName condition="is">ocsp.trustwave.com</QueryName>
			<QueryName condition="is">amazontrust.com</QueryName>
			<QueryName condition="is">ocsp.sectigo.com</QueryName>
			<QueryName condition="is">pki-goog.l.google.com</QueryName>
			<QueryName condition="end with">.usertrust.com</QueryName>
			<QueryName condition="is">ocsp.comodoca.com</QueryName>
			<QueryName condition="is">ocsp.entrust.net</QueryName>
			<QueryName condition="end with">.ocsp.identrust.com</QueryName>
			<QueryName condition="is">status.rapidssl.com</QueryName>
			<QueryName condition="is">ocsp.int-x3.letsencrypt.org</QueryName>
			<QueryName condition="is">subca.ocsp-certum.com</QueryName>
			<QueryName condition="is">cscasha2.ocsp-certum.com</QueryName>
			<QueryName condition="is">pki.intel.com</QueryName>
			<QueryName condition="is">scrootca1.ocsp.secomtrust.net</QueryName>
			<QueryName condition="is">scrootca2.ocsp.secomtrust.net</QueryName>
			<QueryName condition="is">stats.anchor.host</QueryName>
			<QueryName condition="is">ts-ocsp.ws.symantec.com</QueryName>
			<QueryName condition="is">upgrade.bitdefender.com</QueryName>
			<!--Others-->
			<Rule groupRelation="and">
				<Image condition="is">C:\ProgramData\LogiShrd\LogiOptions\Software\Current\updater.exe</Image>
				<QueryName condition="end with">.logitech.com</QueryName>
			</Rule>
			<QueryName condition="begin with">brave-sync.s3.dualstack.</QueryName>
			<QueryName condition="end with">.salesforceliveagent.com</QueryName>
			<QueryName condition="is">ads-serve.brave.com</QueryName>
		</DnsQuery>
	</RuleGroup>

	<!--SYSMON EVENT ID 23 : FILE DELETE [FileDelete]-->
	<!--Saves a copy to the archivedir-->
	<!--Note: Under normal operating conditions this directory might grow to an unreasonable size-->
	<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, User, Image, TargetFilename, Hashes, IsExecutable, Archived -->
	<RuleGroup name="FileDelete_Include_Group" groupRelation="or">
		<FileDelete onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</FileDelete>
	</RuleGroup>

	<!--SYSMON EVENT ID 24 : CLIPBOARD EVENT MONITORING [ClipboardChange]-->
	<!--DATA: EventType, UtcTime, ProcessGuid, ProcessId, Image, Session, ClientInfo, Hashes, Archived -->
	<!--Default set to disabled due to privacy implications and potential data you leave for attackers, enable with care!-->
	<RuleGroup name="ClipboardChange_Include_Group" groupRelation="or">
		<ClipboardChange onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</ClipboardChange>
	</RuleGroup>

	<!--SYSMON EVENT ID 25 : PROCESS TAMPERING [ProcessTampering]-->
	<!--DATA: EventType, RuleName, UtcTime, ProcessGuid, ProcessId, Image, Type -->
	<RuleGroup name="ProcessTampering_Include_Group" groupRelation="or">
		<ProcessTampering onmatch="include">
			<Rule name="Process_Tampering_Detected" groupRelation="and">
				<Image condition="contains any">.;&gt;;unknown;anonymous</Image>
				<Image condition="excludes">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
				<Image condition="excludes">C:\Program Files (x86)\Symantec\</Image>
				<Image condition="excludes">C:\Program Files\Google\Chrome\Application\chrome.exe</Image>
				<Image condition="excludes">C:\Program Files\Symantec\</Image>
			</Rule>
		</ProcessTampering>
	</RuleGroup>
	<RuleGroup name="ProcessTampering_Exclude_Group" groupRelation="or">
		<ProcessTampering onmatch="exclude">
			<Rule name="Attack=None,Technique=None,Tactic=None,DS=Network Traffic: Network Traffic Content,Level=0,Desc=exclude common noise" groupRelation="and">
				<Image condition="contains any">\BHO\ie_to_edge_stub.exe;\Microsoft\Teams\;\Vivaldi\Application\;Google\Chrome\;Google\Update;BraveSoftware\Brave-Browser\;Edge\Application\;EdgeUpdate\Install\;Program Files\SmartGit\</Image>
			</Rule>
			<Image condition="is">C:\Program Files\Mozilla Firefox\firefox.exe</Image>
			<Image condition="is">C:\Program Files\Mozilla Firefox\updater.exe</Image>
			<Image condition="is">C:\Program Files\Mozilla Firefox\default-browser-agent.exe</Image>
			<Image condition="is">C:\Program Files\Mozilla Firefox\pingsender.exe</Image>
			<Image condition="is">C:\Program Files\Git\cmd\git.exe</Image>
			<Image condition="is">C:\Program Files\Git\mingw64\bin\git.exe</Image>
			<Image condition="is">C:\Program Files\Git\mingw64\libexec\git-core\git.exe</Image>
			<Image condition="contains">unknown process</Image>
			<Image condition="is">C:\Program Files\Microsoft VS Code\Code.exe</Image>
		</ProcessTampering>
	</RuleGroup>

	<!--SYSMON EVENT ID 26 : FILE DELETE DETECTED [FileDeleteDetected]-->
	<!--Does NOT save the file-->
	<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, User, Image, TargetFilename, Hashes, IsExecutable, Archived -->
	<RuleGroup name="FileDeleteDetected_Include_Group" groupRelation="or">
		<FileDeleteDetected onmatch="include">
			<TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\Shared\ErrorDumps</TargetFilename>
			<TargetFilename condition="contains all">C:\Program Files\Microsoft SQL Server;\DataDumps</TargetFilename>
			<TargetFilename condition="contains all">C:\Program Files (X86)\Microsoft SQL Server\;Shared\ErrorDumps</TargetFilename>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Program Files\Qualys\QualysAgent</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="contains">\Downloads\</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="contains">\Appdata\Local\Temp\</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="contains">\Appdata\Local\Microsoft\Windows\INetCache\Content.Outlook\</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Intel</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Mozilla</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\chocolatey\logs</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\DeviceSync</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\PlayReady</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\User Account Pictures</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Office\Heartbeat</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\ReportQueue</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\ProgramData\Microsoft\Windows\WER\Temp</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Intel</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Mozilla</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\chocolatey\logs</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\DeviceSync</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\PlayReady</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\User Account Pictures</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\DSS\MachineKeys</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\NetFramework\BreadcrumbStore</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Office\Heartbeat</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportArchive</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\ReportQueue</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Users\All Users\Microsoft\Windows\WER\Temp</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\Tasks</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\tracing</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\Registration\CRMLog</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\System32\Tasks</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\System32\spool\drivers\color</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
			<Rule groupRelation="and">
				<TargetFilename condition="begin with">C:\Windows\SysWOW64\Tasks</TargetFilename>
				<TargetFilename condition="contains any">.com;.bat;.exe;.reg;.ps1;.vbs;.vba;.lnk;.doc;.xls;.hta;.bin;.7z;.dll;.xla;.cmd;.sh;.lnk;.pptm;.scr;.msi;.sct</TargetFilename>
			</Rule>
		</FileDeleteDetected>
	</RuleGroup>

	<RuleGroup name="FileDeleteDetected_Exclude_Group" groupRelation="or">
		<FileDeleteDetected onmatch="exclude">
			<Image condition="contains all">\appdata\local\google\chrome\user data\swreporter\;software_reporter_tool.exe</Image>
			<Image condition="is">C:\Program Files (x86)\Google\Chrome\Application\chrome.exe</Image>
			<User condition="contains any">NETWORK SERVICE; LOCAL SERVICE</User>
		</FileDeleteDetected>
	</RuleGroup>

	<!--SYSMON EVENT ID 27 : FILE BLOCK [FileBlockExecutable]-->
	<RuleGroup name="FileBlockExecutable_Include_Group" groupRelation="or">
		<FileBlockExecutable onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</FileBlockExecutable>
	</RuleGroup>

	<!--SYSMON EVENT ID 28 : FILE BLOCK SHREDDING [FileBlockShredding]-->
	<RuleGroup name="FileBlockShredding_Include_Group" groupRelation="or">
		<FileBlockShredding onmatch="include">
			<!--NOTE: Using "include" with no rules means nothing in this section will be logged-->
		</FileBlockShredding>
	</RuleGroup>

	<!--SYSMON EVENT ID 255 : ERROR-->
	<!--"This event is generated when an error occurred within Sysmon. They can happen if the system is under heavy load
		and certain tasked could not be performed or a bug exists in the Sysmon service. You can report any bugs on the
		Sysinternals forum or over Twitter (@markrussinovich)."-->
	<!--Cannot be filtered.-->

	</EventFiltering>
</Sysmon>